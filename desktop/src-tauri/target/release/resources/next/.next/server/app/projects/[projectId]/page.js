(()=>{var a={};a.id=332,a.ids=[332],a.modules={10:(a,b,c)=>{"use strict";let d;c.d(b,{W:()=>f});var e=c(43274);function f(){return(!d||d?.isContextLost())&&(d=e.e.get().createCanvas().getContext("webgl",{})),d}},105:(a,b,c)=>{"use strict";c.d(b,{i:()=>e});var d=c(21507);function e(a,b){return"no-premultiply-alpha"===b.alphaMode&&d.Q[a]||a}},261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},1157:(a,b,c)=>{"use strict";c.d(b,{l:()=>g});var d=c(87818),e=c(86360);class f{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(a){return this._cache.has(a)}get(a){let b=this._cache.get(a);return b||(0,d.R)(`[Assets] Asset id ${a} was not found in the Cache`),b}set(a,b){let c,f=(0,e.z)(a);for(let a=0;a<this.parsers.length;a++){let d=this.parsers[a];if(d.test(b)){c=d.getCacheableAssets(f,b);break}}let g=new Map(Object.entries(c||{}));c||f.forEach(a=>{g.set(a,b)});let h=[...g.keys()],i={cacheKeys:h,keys:f};f.forEach(a=>{this._cacheMap.set(a,i)}),h.forEach(a=>{let e=c?c[a]:b;this._cache.has(a)&&this._cache.get(a)!==e&&(0,d.R)("[Cache] already has key:",a),this._cache.set(a,g.get(a))})}remove(a){if(!this._cacheMap.has(a))return void(0,d.R)(`[Assets] Asset id ${a} was not found in the Cache`);let b=this._cacheMap.get(a);b.cacheKeys.forEach(a=>{this._cache.delete(a)}),b.keys.forEach(a=>{this._cacheMap.delete(a)})}get parsers(){return this._parsers}}let g=new f},1342:(a,b,c)=>{"use strict";c.d(b,{q:()=>g});var d=c(43274),e=c(45753),f=c(93141);class g extends f.v{constructor(a){a.resource||(a.resource=d.e.get().createCanvas()),!a.width&&(a.width=a.resource.width,a.autoDensity||(a.width/=a.resolution)),!a.height&&(a.height=a.resource.height,a.autoDensity||(a.height/=a.resolution)),super(a),this.uploadMethodId="image",this.autoDensity=a.autoDensity,this.resizeCanvas(),this.transparent=!!a.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(a=this.width,b=this.height,c=this._resolution){let d=super.resize(a,b,c);return d&&this.resizeCanvas(),d}static test(a){return globalThis.HTMLCanvasElement&&a instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&a instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}g.extension=e.Ag.TextureSource},2233:(a,b,c)=>{"use strict";c.d(b,{P:()=>f});var d=c(45753),e=c(93141);class f extends e.v{constructor(a){const b=a.resource||new Float32Array(a.width*a.height*4);let c=a.format;c||(b instanceof Float32Array?c="rgba32float":b instanceof Int32Array||b instanceof Uint32Array?c="rgba32uint":b instanceof Int16Array||b instanceof Uint16Array?c="rgba16uint":(Int8Array,c="bgra8unorm")),super({...a,resource:b,format:c}),this.uploadMethodId="buffer"}static test(a){return a instanceof Int8Array||a instanceof Uint8Array||a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array}}f.extension=d.Ag.TextureSource},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5086:(a,b,c)=>{"use strict";c.d(b,{B:()=>k});var d,e=c(71254),f=c(96156);let g={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function h(a){let b=/@group\((\d+)\)/,c=/@binding\((\d+)\)/,d=/var(<[^>]+>)? (\w+)/,e=/:\s*(\w+)/,f=/(\w+)\s*:\s*([\w\<\>]+)/g,g=/struct\s+(\w+)/,h=a.match(/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g)?.map(a=>({group:parseInt(a.match(b)[1],10),binding:parseInt(a.match(c)[1],10),name:a.match(d)[2],isUniform:"<uniform>"===a.match(d)[1],type:a.match(e)[1]}));if(!h)return{groups:[],structs:[]};let i=a.match(/struct\s+(\w+)\s*{([^}]+)}/g)?.map(a=>{let b=a.match(g)[1],c=a.match(f).reduce((a,b)=>{let[c,d]=b.split(":");return a[c.trim()]=d.trim(),a},{});return c?{name:b,members:c}:null}).filter(({name:a})=>h.some(b=>b.type===a))??[];return{groups:h,structs:i}}var i=((d=i||{})[d.VERTEX=1]="VERTEX",d[d.FRAGMENT=2]="FRAGMENT",d[d.COMPUTE=4]="COMPUTE",d);let j=Object.create(null);class k{constructor(a){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:b,vertex:c,layout:d,gpuLayout:e,name:f}=a;if(this.name=f,this.fragment=b,this.vertex=c,b.source===c.source){const a=h(b.source);this.structsAndGroups=a}else{const a=h(c.source),d=h(b.source);this.structsAndGroups=function(a,b){let c=new Set,d=new Set;return{structs:[...a.structs,...b.structs].filter(a=>!c.has(a.name)&&(c.add(a.name),!0)),groups:[...a.groups,...b.groups].filter(a=>{let b=`${a.name}-${a.binding}`;return!d.has(b)&&(d.add(b),!0)})}}(a,d)}this.layout=d??function({groups:a}){let b=[];for(let c=0;c<a.length;c++){let d=a[c];b[d.group]||(b[d.group]={}),b[d.group][d.name]=d.binding}return b}(this.structsAndGroups),this.gpuLayout=e??function({groups:a}){let b=[];for(let c=0;c<a.length;c++){let d=a[c];b[d.group]||(b[d.group]=[]),d.isUniform?b[d.group].push({binding:d.binding,visibility:i.VERTEX|i.FRAGMENT,buffer:{type:"uniform"}}):"sampler"===d.type?b[d.group].push({binding:d.binding,visibility:i.FRAGMENT,sampler:{type:"filtering"}}):"texture_2d"===d.type&&b[d.group].push({binding:d.binding,visibility:i.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return b}(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){let{vertex:a,fragment:b}=this,c=a.source+b.source+a.entryPoint+b.entryPoint;this._layoutKey=(0,e.X)(c,"program")}get attributeData(){return this._attributeData??(this._attributeData=function({source:a,entryPoint:b}){let c={},d=a.indexOf(`fn ${b}`);if(-1!==d){let b=a.indexOf("->",d);if(-1!==b){let e,h=a.substring(d,b),i=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;for(;null!==(e=i.exec(h));){let a=g[e[3]]??"float32";c[e[2]]={location:parseInt(e[1],10),format:a,stride:(0,f.m)(a).stride,offset:0,instance:!1,start:0}}}}return c}(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,j[this._cacheKey]=null}static from(a){let b=`${a.vertex.source}:${a.fragment.source}:${a.fragment.entryPoint}:${a.vertex.entryPoint}`;return j[b]||(j[b]=new k(a),j[b]._cacheKey=b),j[b]}}},6672:(a,b,c)=>{"use strict";c.d(b,{Z:()=>g});var d=c(83401);class e{constructor(a,b){this._pool=[],this._count=0,this._index=0,this._classType=a,b&&this.prepopulate(b)}prepopulate(a){for(let b=0;b<a;b++)this._pool[this._index++]=new this._classType;this._count+=a}get(a){let b;return this._index>0?b=this._pool[--this._index]:(b=new this._classType,this._count++),b.init?.(a),b}return(a){a.reset?.(),this._pool[this._index++]=a}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let a=0;a<this._index;a++)this._pool[a].destroy();this._pool.length=0,this._count=0,this._index=0}}class f{constructor(){this._poolsByClass=new Map}prepopulate(a,b){this.getPool(a).prepopulate(b)}get(a,b){return this.getPool(a).get(b)}return(a){this.getPool(a.constructor).return(a)}getPool(a){return this._poolsByClass.has(a)||this._poolsByClass.set(a,new e(a)),this._poolsByClass.get(a)}stats(){let a={};return this._poolsByClass.forEach(b=>{let c=a[b._classType.name]?b._classType.name+b._classType.ID:b._classType.name;a[c]={free:b.totalFree,used:b.totalUsed,size:b.totalSize}}),a}clear(){this._poolsByClass.forEach(a=>a.clear()),this._poolsByClass.clear()}}let g=new f;d.L.register(g)},7363:(a,b,c)=>{"use strict";c.d(b,{C:()=>d});class d{constructor(a){this.items=[],this._name=a}emit(a,b,c,d,e,f,g,h){let{name:i,items:j}=this;for(let k=0,l=j.length;k<l;k++)j[k][i](a,b,c,d,e,f,g,h);return this}add(a){return a[this._name]&&(this.remove(a),this.items.push(a)),this}remove(a){let b=this.items.indexOf(a);return -1!==b&&this.items.splice(b,1),this}contains(a){return -1!==this.items.indexOf(a)}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}},8542:(a,b,c)=>{"use strict";c.d(b,{o:()=>d});class d{constructor(a,b,c){this._x=b||0,this._y=c||0,this._observer=a}clone(a){return new d(a??this._observer,this._x,this._y)}set(a=0,b=a){return(this._x!==a||this._y!==b)&&(this._x=a,this._y=b,this._observer._onUpdate(this)),this}copyFrom(a){return(this._x!==a.x||this._y!==a.y)&&(this._x=a.x,this._y=a.y,this._observer._onUpdate(this)),this}copyTo(a){return a.set(this._x,this._y),a}equals(a){return a.x===this._x&&a.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(a){this._x!==a&&(this._x=a,this._observer._onUpdate(this))}get y(){return this._y}set y(a){this._y!==a&&(this._y=a,this._observer._onUpdate(this))}}},9848:(a,b,c)=>{"use strict";c.d(b,{G:()=>g});var d=c(48419),e=c(63598);let f=new d.u;class g{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){let a=this.baseColor,b=a>>16|65280&a|(255&a)<<16,c=this.renderable;return c?(0,e.u)(b,c.groupColor)+(this.alpha*c.groupAlpha*255<<24):b+(255*this.alpha<<24)}get transform(){return this.renderable?.groupTransform||f}copyTo(a){a.indexOffset=this.indexOffset,a.indexSize=this.indexSize,a.attributeOffset=this.attributeOffset,a.attributeSize=this.attributeSize,a.baseColor=this.baseColor,a.alpha=this.alpha,a.texture=this.texture,a.geometryData=this.geometryData,a.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11489:(a,b,c)=>{"use strict";c.d(b,{W:()=>e});var d,e=((d=e||{})[d.WEBGL=1]="WEBGL",d[d.WEBGPU=2]="WEBGPU",d[d.BOTH=3]="BOTH",d)},11630:(a,b,c)=>{"use strict";c.d(b,{o:()=>h,u:()=>g});var d=c(48419),e=c(6672),f=c(87790);let g=e.Z.getPool(d.u),h=e.Z.getPool(f.c)},13901:(a,b,c)=>{"use strict";c.d(b,{A:()=>g});var d=c(43274);function e(a){if("string"!=typeof a)throw TypeError(`Path must be a string. Received ${JSON.stringify(a)}`)}function f(a){return a.split("?")[0].split("#")[0]}let g={toPosix:a=>{var b,c;return b=0,c=0,a.replace(RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/")},isUrl(a){return/^https?:/.test(this.toPosix(a))},isDataUrl:a=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(a),isBlobUrl:a=>a.startsWith("blob:"),hasProtocol(a){return/^[^/:]+:/.test(this.toPosix(a))},getProtocol(a){e(a),a=this.toPosix(a);let b=/^file:\/\/\//.exec(a);if(b)return b[0];let c=/^[^/:]+:\/{0,2}/.exec(a);return c?c[0]:""},toAbsolute(a,b,c){if(e(a),this.isDataUrl(a)||this.isBlobUrl(a))return a;let h=f(this.toPosix(b??d.e.get().getBaseUrl())),i=f(this.toPosix(c??this.rootname(h)));return(a=this.toPosix(a)).startsWith("/")?g.join(i,a.slice(1)):this.isAbsolute(a)?a:this.join(h,a)},normalize(a){if(e(a),0===a.length)return".";if(this.isDataUrl(a)||this.isBlobUrl(a))return a;a=this.toPosix(a);let b="",c=a.startsWith("/");this.hasProtocol(a)&&(b=this.rootname(a),a=a.slice(b.length));let d=a.endsWith("/");return((a=function(a,b){let c="",d=0,e=-1,f=0,g=-1;for(let h=0;h<=a.length;++h){if(h<a.length)g=a.charCodeAt(h);else if(47===g)break;else g=47;if(47===g){if(e===h-1||1===f);else if(e!==h-1&&2===f){if(c.length<2||2!==d||46!==c.charCodeAt(c.length-1)||46!==c.charCodeAt(c.length-2)){if(c.length>2){let a=c.lastIndexOf("/");if(a!==c.length-1){-1===a?(c="",d=0):d=(c=c.slice(0,a)).length-1-c.lastIndexOf("/"),e=h,f=0;continue}}else if(2===c.length||1===c.length){c="",d=0,e=h,f=0;continue}}b&&(c.length>0?c+="/..":c="..",d=2)}else c.length>0?c+=`/${a.slice(e+1,h)}`:c=a.slice(e+1,h),d=h-e-1;e=h,f=0}else 46===g&&-1!==f?++f:f=-1}return c}(a,!1)).length>0&&d&&(a+="/"),c)?`/${a}`:b+a},isAbsolute(a){return e(a),a=this.toPosix(a),!!this.hasProtocol(a)||a.startsWith("/")},join(...a){let b;if(0===a.length)return".";for(let c=0;c<a.length;++c){let d=a[c];if(e(d),d.length>0)if(void 0===b)b=d;else{let e=a[c-1]??"";this.joinExtensions.includes(this.extname(e).toLowerCase())?b+=`/../${d}`:b+=`/${d}`}}return void 0===b?".":this.normalize(b)},dirname(a){if(e(a),0===a.length)return".";let b=(a=this.toPosix(a)).charCodeAt(0),c=47===b,d=-1,f=!0,g=this.getProtocol(a),h=a;a=a.slice(g.length);for(let c=a.length-1;c>=1;--c)if(47===(b=a.charCodeAt(c))){if(!f){d=c;break}}else f=!1;return -1===d?c?"/":this.isUrl(h)?g+a:g:c&&1===d?"//":g+a.slice(0,d)},rootname(a){e(a);let b="";if(b=(a=this.toPosix(a)).startsWith("/")?"/":this.getProtocol(a),this.isUrl(a)){let c=a.indexOf("/",b.length);(b=-1!==c?a.slice(0,c):a).endsWith("/")||(b+="/")}return b},basename(a,b){let c;e(a),b&&e(b),a=f(this.toPosix(a));let d=0,g=-1,h=!0;if(void 0!==b&&b.length>0&&b.length<=a.length){if(b.length===a.length&&b===a)return"";let e=b.length-1,f=-1;for(c=a.length-1;c>=0;--c){let i=a.charCodeAt(c);if(47===i){if(!h){d=c+1;break}}else -1===f&&(h=!1,f=c+1),e>=0&&(i===b.charCodeAt(e)?-1==--e&&(g=c):(e=-1,g=f))}return d===g?g=f:-1===g&&(g=a.length),a.slice(d,g)}for(c=a.length-1;c>=0;--c)if(47===a.charCodeAt(c)){if(!h){d=c+1;break}}else -1===g&&(h=!1,g=c+1);return -1===g?"":a.slice(d,g)},extname(a){e(a),a=f(this.toPosix(a));let b=-1,c=0,d=-1,g=!0,h=0;for(let e=a.length-1;e>=0;--e){let f=a.charCodeAt(e);if(47===f){if(!g){c=e+1;break}continue}-1===d&&(g=!1,d=e+1),46===f?-1===b?b=e:1!==h&&(h=1):-1!==b&&(h=-1)}return -1===b||-1===d||0===h||1===h&&b===d-1&&b===c+1?"":a.slice(b,d)},parse(a){let b;e(a);let c={root:"",dir:"",base:"",ext:"",name:""};if(0===a.length)return c;let d=(a=f(this.toPosix(a))).charCodeAt(0),g=this.isAbsolute(a);c.root=this.rootname(a),b=g||this.hasProtocol(a)?1:0;let h=-1,i=0,j=-1,k=!0,l=a.length-1,m=0;for(;l>=b;--l){if(47===(d=a.charCodeAt(l))){if(!k){i=l+1;break}continue}-1===j&&(k=!1,j=l+1),46===d?-1===h?h=l:1!==m&&(m=1):-1!==h&&(m=-1)}return -1===h||-1===j||0===m||1===m&&h===j-1&&h===i+1?-1!==j&&(0===i&&g?c.base=c.name=a.slice(1,j):c.base=c.name=a.slice(i,j)):(0===i&&g?(c.name=a.slice(1,h),c.base=a.slice(1,j)):(c.name=a.slice(i,h),c.base=a.slice(i,j)),c.ext=a.slice(h,j)),c.dir=this.dirname(a),c},sep:"/",delimiter:":",joinExtensions:[".html"]}},13968:(a,b,c)=>{"use strict";let d,e,f,g,h,i,j,k;c.d(b,{ProjectWorkspace:()=>dC});var l,m,n,o,p,q,r,s,t,u=c(48249),v=c(67484),w=c.t(v,2),x=c(19099),y=c(45753);let z={extension:{type:y.Ag.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Promise.all([c.e(767),c.e(599)]).then(c.bind(c,52599))}},A={extension:{type:y.Ag.Environment,name:"webworker",priority:0},test:()=>"undefined"!=typeof self&&void 0!==self.WorkerGlobalScope,load:async()=>{await Promise.all([c.e(767),c.e(452)]).then(c.bind(c,14452))}};c(92175),c(82298);var B=c(43274),C=c(15629);async function D(a={}){return void 0!==e?e:e=await (async()=>{let b=B.e.get().getNavigator().gpu;if(!b)return!1;try{let c=await b.requestAdapter(a);return await c.requestDevice(),!0}catch(a){return!1}})()}let E=["webgl","webgpu","canvas"];async function F(a){let b,e=[];a.preference?(e.push(a.preference),E.forEach(b=>{b!==a.preference&&e.push(b)})):e=E.slice();let f={};for(let g=0;g<e.length;g++){let h=e[g];if("webgpu"===h&&await D()){let{WebGPURenderer:d}=await Promise.all([c.e(697),c.e(531)]).then(c.bind(c,22531));b=d,f={...a,...a.webgpu};break}if("webgl"===h&&function(a){return void 0!==d?d:d=(()=>{let b={stencil:!0,failIfMajorPerformanceCaveat:a??C.k.defaultOptions.failIfMajorPerformanceCaveat};try{if(!B.e.get().getWebGLRenderingContext())return!1;let a=B.e.get().createCanvas().getContext("webgl",b),c=!!a?.getContextAttributes()?.stencil;if(a){let b=a.getExtension("WEBGL_lose_context");b&&b.loseContext()}return a=null,c}catch(a){return!1}})()}(a.failIfMajorPerformanceCaveat??C.k.defaultOptions.failIfMajorPerformanceCaveat)){let{WebGLRenderer:d}=await Promise.all([c.e(697),c.e(413)]).then(c.bind(c,5413));b=d,f={...a,...a.webgl};break}if("canvas"===h)throw f={...a},Error("CanvasRenderer is not yet implemented")}if(delete f.webgpu,delete f.webgl,!b)throw Error("No available renderer for the current environment");let g=new b;return await g.init(f),g}var G=c(64974),H=c(30231),I=c(71568);let J=class a{constructor(...a){this.stage=new G.mc,void 0!==a[0]&&(0,I.t6)(I.lj,"Application constructor options are deprecated, please use Application.init() instead.")}async init(b){b={...b},this.stage||(this.stage=new G.mc),this.renderer=await F(b),a._plugins.forEach(a=>{a.init.call(this,b)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return(0,I.t6)(I.lj,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(b=!1,c=!1){let d=a._plugins.slice(0);d.reverse(),d.forEach(a=>{a.destroy.call(this)}),this.stage.destroy(c),this.stage=null,this.renderer.destroy(b),this.renderer=null}};J._plugins=[],y.XO.handleByList(y.Ag.Application,J._plugins),y.XO.add(H.M);var K=c(84443),L=c(21283),M=c(13901),N=c(54977),O=c(91546),P=c(61487),Q=c(27331),R=c(89949);class S extends Q.v{constructor(a,b){super();const{textures:c,data:d}=a;Object.keys(d.pages).forEach(a=>{let b=c[d.pages[parseInt(a,10)].id];this.pages.push({texture:b})}),Object.keys(d.chars).forEach(a=>{let b=d.chars[a],{frame:e,source:f,rotate:g}=c[b.page],h=N.E.transformRectCoords(b,e,g,new O.M),i=new P.g({frame:h,orig:new O.M(0,0,b.width,b.height),source:f,rotate:g});this.chars[a]={id:a.codePointAt(0),xOffset:b.xOffset,yOffset:b.yOffset,xAdvance:b.xAdvance,kerning:b.kerning??{},texture:i}}),this.baseRenderedFontSize=d.fontSize,this.baseMeasurementFontSize=d.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:d.fontSize},this.baseLineOffset=d.baseLineOffset,this.lineHeight=d.lineHeight,this.fontFamily=d.fontFamily,this.distanceField=d.distanceField??{type:"none",range:0},this.url=b}destroy(){super.destroy();for(let a=0;a<this.pages.length;a++){let{texture:b}=this.pages[a];b.destroy(!0)}this.pages=null}static install(a){R.c.install(a)}static uninstall(a){R.c.uninstall(a)}}let T={test:a=>"string"==typeof a&&a.startsWith("info face="),parse(a){let b=a.match(/^[a-z]+\s+.+$/gm),c={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let a in b){let d=b[a].match(/^[a-z]+/gm)[0],e=b[a].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),f={};for(let a in e){let b=e[a].split("="),c=b[0],d=b[1].replace(/"/gm,""),g=parseFloat(d),h=isNaN(g)?d:g;f[c]=h}c[d].push(f)}let d={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[e]=c.info,[f]=c.common,[g]=c.distanceField??[];g&&(d.distanceField={range:parseInt(g.distanceRange,10),type:g.fieldType}),d.fontSize=parseInt(e.size,10),d.fontFamily=e.face,d.lineHeight=parseInt(f.lineHeight,10);let h=c.page;for(let a=0;a<h.length;a++)d.pages.push({id:parseInt(h[a].id,10)||0,file:h[a].file});let i={};d.baseLineOffset=d.lineHeight-parseInt(f.base,10);let j=c.char;for(let a=0;a<j.length;a++){let b=j[a],c=parseInt(b.id,10),e=b.letter??b.char??String.fromCharCode(c);"space"===e&&(e=" "),i[c]=e,d.chars[e]={id:c,page:parseInt(b.page,10)||0,x:parseInt(b.x,10),y:parseInt(b.y,10),width:parseInt(b.width,10),height:parseInt(b.height,10),xOffset:parseInt(b.xoffset,10),yOffset:parseInt(b.yoffset,10),xAdvance:parseInt(b.xadvance,10),kerning:{}}}let k=c.kerning||[];for(let a=0;a<k.length;a++){let b=parseInt(k[a].first,10),c=parseInt(k[a].second,10),e=parseInt(k[a].amount,10);d.chars[i[c]].kerning[i[b]]=e}return d}},U={test:a=>"string"!=typeof a&&"getElementsByTagName"in a&&a.getElementsByTagName("page").length&&null!==a.getElementsByTagName("info")[0].getAttribute("face"),parse(a){let b={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},c=a.getElementsByTagName("info")[0],d=a.getElementsByTagName("common")[0],e=a.getElementsByTagName("distanceField")[0];e&&(b.distanceField={type:e.getAttribute("fieldType"),range:parseInt(e.getAttribute("distanceRange"),10)});let f=a.getElementsByTagName("page"),g=a.getElementsByTagName("char"),h=a.getElementsByTagName("kerning");b.fontSize=parseInt(c.getAttribute("size"),10),b.fontFamily=c.getAttribute("face"),b.lineHeight=parseInt(d.getAttribute("lineHeight"),10);for(let a=0;a<f.length;a++)b.pages.push({id:parseInt(f[a].getAttribute("id"),10)||0,file:f[a].getAttribute("file")});let i={};b.baseLineOffset=b.lineHeight-parseInt(d.getAttribute("base"),10);for(let a=0;a<g.length;a++){let c=g[a],d=parseInt(c.getAttribute("id"),10),e=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(d);"space"===e&&(e=" "),i[d]=e,b.chars[e]={id:d,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let a=0;a<h.length;a++){let c=parseInt(h[a].getAttribute("first"),10),d=parseInt(h[a].getAttribute("second"),10),e=parseInt(h[a].getAttribute("amount"),10);b.chars[i[d]].kerning[i[c]]=e}return b}},V=a=>!!("string"==typeof a&&a.match(/<font(\s|>)/))&&U.test(B.e.get().parseXML(a)),W=a=>U.parse(B.e.get().parseXML(a)),X=[".xml",".fnt"],Y={extension:{type:y.Ag.CacheParser,name:"cacheBitmapFont"},test:a=>a instanceof S,getCacheableAssets(a,b){let c={};return a.forEach(a=>{c[a]=b,c[`${a}-bitmap`]=b}),c[`${b.fontFamily}-bitmap`]=b,c}},Z={extension:{type:y.Ag.LoadParser,priority:K.T.Normal},name:"loadBitmapFont",id:"bitmap-font",test:a=>X.includes(M.A.extname(a).toLowerCase()),testParse:async a=>T.test(a)||V(a),async parse(a,b,c){let d=T.test(a)?T.parse(a):W(a),{src:e}=b,{pages:f}=d,g=[],h=d.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let a=0;a<f.length;++a){let b=f[a].file,c=M.A.join(M.A.dirname(e),b);c=(0,L.Y)(c,e),g.push({src:c,data:h})}let i=await c.load(g);return new S({data:d,textures:g.map(a=>i[a.src])},e)},async load(a,b){let c=await B.e.get().fetch(a);return await c.text()},async unload(a,b,c){await Promise.all(a.pages.map(a=>c.unload(a.texture.source._sourceOrigin))),a.destroy()}};var $=c(87818);class _{constructor(a,b=!1){this._loader=a,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=b}add(a){a.forEach(a=>{this._assetList.push(a)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let a=[],b=Math.min(this._assetList.length,this._maxConcurrent);for(let c=0;c<b;c++)a.push(this._assetList.pop());await this._loader.load(a),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(a){this._isActive!==a&&(this._isActive=a,a&&!this._isLoading&&this._next())}}var aa=c(1157);let ab={extension:{type:y.Ag.CacheParser,name:"cacheTextureArray"},test:a=>Array.isArray(a)&&a.every(a=>a instanceof P.g),getCacheableAssets:(a,b)=>{let c={};return a.forEach(a=>{b.forEach((b,d)=>{c[a+(0===d?"":d+1)]=b})}),c}};async function ac(a){if("Image"in globalThis)return new Promise(b=>{let c=new Image;c.onload=()=>{b(!0)},c.onerror=()=>{b(!1)},c.src=a});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{let b=await (await fetch(a)).blob();await createImageBitmap(b)}catch(a){return!1}return!0}return!1}let ad={extension:{type:y.Ag.DetectionParser,priority:1},test:async()=>ac("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async a=>[...a,"avif"],remove:async a=>a.filter(a=>"avif"!==a)},ae=["png","jpg","jpeg"],af={extension:{type:y.Ag.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async a=>[...a,...ae],remove:async a=>a.filter(a=>!ae.includes(a))},ag="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function ah(a){return!ag&&""!==document.createElement("video").canPlayType(a)}let ai={extension:{type:y.Ag.DetectionParser,priority:0},test:async()=>ah("video/mp4"),add:async a=>[...a,"mp4","m4v"],remove:async a=>a.filter(a=>"mp4"!==a&&"m4v"!==a)},aj={extension:{type:y.Ag.DetectionParser,priority:0},test:async()=>ah("video/ogg"),add:async a=>[...a,"ogv"],remove:async a=>a.filter(a=>"ogv"!==a)},ak={extension:{type:y.Ag.DetectionParser,priority:0},test:async()=>ah("video/webm"),add:async a=>[...a,"webm"],remove:async a=>a.filter(a=>"webm"!==a)},al={extension:{type:y.Ag.DetectionParser,priority:0},test:async()=>ac("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async a=>[...a,"webp"],remove:async a=>a.filter(a=>"webp"!==a)};var am=c(86360),an=c(22055);let ao=class a{constructor(){this.loadOptions={...a.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(a,b,c)=>(this._parsersValidated=!1,a[b]=c,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(a,b){let c={promise:null,parser:null};return c.promise=(async()=>{let d=null,e=null;if((b.parser||b.loadParser)&&(e=this._parserHash[b.parser||b.loadParser],b.loadParser&&(0,$.R)(`[Assets] "loadParser" is deprecated, use "parser" instead for ${a}`),e||(0,$.R)(`[Assets] specified load parser "${b.parser||b.loadParser}" not found while loading ${a}`)),!e){for(let c=0;c<this.parsers.length;c++){let d=this.parsers[c];if(d.load&&d.test?.(a,b,this)){e=d;break}}if(!e)return(0,$.R)(`[Assets] ${a} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}d=await e.load(a,b,this),c.parser=e;for(let a=0;a<this.parsers.length;a++){let e=this.parsers[a];e.parse&&e.parse&&await e.testParse?.(d,b,this)&&(d=await e.parse(d,b,this)||d,c.parser=e)}return d})(),c}async load(b,c){this._parsersValidated||this._validateParsers();let{onProgress:d,onError:e,strategy:f,retryCount:g,retryDelay:h}="function"==typeof c?{...a.defaultOptions,...this.loadOptions,onProgress:c}:{...a.defaultOptions,...this.loadOptions,...c||{}},i=0,j={},k=(0,an.a)(b),l=(0,am.z)(b,a=>({alias:[a],src:a,data:{}})),m=l.reduce((a,b)=>a+(b.progressSize||1),0),n=l.map(async a=>{let b=M.A.toAbsolute(a.src);!j[a.src]&&(await this._loadAssetWithRetry(b,a,{onProgress:d,onError:e,strategy:f,retryCount:g,retryDelay:h},j),i+=a.progressSize||1,d&&d(i/m))});return await Promise.all(n),k?j[l[0].src]:j}async unload(a){let b=(0,am.z)(a,a=>({alias:[a],src:a})).map(async a=>{let b=M.A.toAbsolute(a.src),c=this.promiseCache[b];if(c){let d=await c.promise;delete this.promiseCache[b],await c.parser?.unload?.(d,a,this)}});await Promise.all(b)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(a=>a.name||a.id).reduce((a,b)=>(b.name||b.id?(a[b.name]||a[b.id])&&(0,$.R)(`[Assets] parser id conflict "${b.id}"`):(0,$.R)("[Assets] parser should have an id"),a[b.name]=b,b.id&&(a[b.id]=b),a),{})}async _loadAssetWithRetry(a,b,c,d){let e=0,{onError:f,strategy:g,retryCount:h,retryDelay:i}=c,j=a=>new Promise(b=>setTimeout(b,a));for(;;)try{this.promiseCache[a]||(this.promiseCache[a]=this._getLoadPromiseAndParser(a,b)),d[b.src]=await this.promiseCache[a].promise;return}catch(k){delete this.promiseCache[a],delete d[b.src],e++;let c="retry"!==g||e>h;if("retry"===g&&!c){f&&f(k,b),await j(i);continue}if("skip"===g){f&&f(k,b);return}throw f&&f(k,b),Error(`[Loader.load] Failed to load ${a}.
${k}`)}}};function ap(a,b){if(Array.isArray(b)){for(let c of b)if(a.startsWith(`data:${c}`))return!0;return!1}return a.startsWith(`data:${b}`)}function aq(a,b){let c=a.split("?")[0],d=M.A.extname(c).toLowerCase();return Array.isArray(b)?b.includes(d):d===b}ao.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let ar={extension:{type:y.Ag.LoadParser,priority:K.T.Low},name:"loadJson",id:"json",test:a=>ap(a,"application/json")||aq(a,".json"),async load(a){let b=await B.e.get().fetch(a);return await b.json()}},as={name:"loadTxt",id:"text",extension:{type:y.Ag.LoadParser,priority:K.T.Low,name:"loadTxt"},test:a=>ap(a,"text/plain")||aq(a,".txt"),async load(a){let b=await B.e.get().fetch(a);return await b.text()}},at=["normal","bold","100","200","300","400","500","600","700","800","900"],au=[".ttf",".otf",".woff",".woff2"],av=["font/ttf","font/otf","font/woff","font/woff2"],aw=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,ax=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/,ay={extension:{type:y.Ag.LoadParser,priority:K.T.Low},name:"loadWebFont",id:"web-font",test:a=>ap(a,av)||aq(a,au),async load(a,b){let c=B.e.get().getFontFaceSet();if(c){let d=[],e=b.data?.family??function(a){let b=M.A.extname(a),c=M.A.basename(a,b).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)),d=c.length>0;for(let a of c)if(!a.match(aw)){d=!1;break}let e=c.join(" ");return d||(e=`"${e.replace(/[\\"]/g,"\\$&")}"`),e}(a),f=b.data?.weights?.filter(a=>at.includes(a))??["normal"],g=b.data??{};for(let b=0;b<f.length;b++){let h=f[b],i=new FontFace(e,`url(${ax.test(a)?a:encodeURI(a)})`,{...g,weight:h});await i.load(),c.add(i),d.push(i)}return aa.l.has(`${e}-and-url`)?aa.l.get(`${e}-and-url`).entries.push({url:a,faces:d}):aa.l.set(`${e}-and-url`,{entries:[{url:a,faces:d}]}),1===d.length?d[0]:d}return(0,$.R)("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(a){let b=Array.isArray(a)?a:[a],c=b[0].family,d=aa.l.get(`${c}-and-url`),e=d.entries.find(a=>a.faces.some(a=>-1!==b.indexOf(a)));e.faces=e.faces.filter(a=>-1===b.indexOf(a)),0===e.faces.length&&(d.entries=d.entries.filter(a=>a!==e)),b.forEach(a=>{B.e.get().getFontFaceSet().delete(a)}),0===d.entries.length&&aa.l.remove(`${c}-and-url`)}};var az=c(16503),aA=c(73866),aB=c(20183);function aC(a,b=1){let c=aB.x.RETINA_PREFIX?.exec(a);return c?parseFloat(c[1]):b}function aD(a,b,c){a.label=c,a._sourceOrigin=c;let d=new P.g({source:a,label:c}),e=()=>{delete b.promiseCache[c],aa.l.has(c)&&aa.l.remove(c)};return d.source.once("destroy",()=>{b.promiseCache[c]&&((0,$.R)("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),e())}),d.once("destroy",()=>{a.destroyed||((0,$.R)("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),e())}),d}let aE={extension:{type:y.Ag.LoadParser,priority:K.T.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test:a=>ap(a,"image/svg+xml")||aq(a,".svg"),async load(a,b,c){return b.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?aG(a):aF(a,b,c,this.config.crossOrigin)},unload(a){a.destroy(!0)}};async function aF(a,b,c,d){let e=await B.e.get().fetch(a),f=B.e.get().createImage();f.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await e.text())}`,f.crossOrigin=d,await f.decode();let g=b.data?.width??f.width,h=b.data?.height??f.height,i=b.data?.resolution||aC(a),j=Math.ceil(g*i),k=Math.ceil(h*i),l=B.e.get().createCanvas(j,k),m=l.getContext("2d");m.imageSmoothingEnabled=!0,m.imageSmoothingQuality="high",m.drawImage(f,0,0,g*i,h*i);let{parseAsGraphicsContext:n,...o}=b.data??{};return aD(new az.b({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:i,...o}),c,a)}async function aG(a){let b=await B.e.get().fetch(a),c=await b.text(),d=new aA.T;return d.svg(c),d}let aH=null;class aI{constructor(){aH||(aH=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n    async function checkImageBitmap() {\n      try {\n        if (typeof createImageBitmap !== "function")\n          return false;\n        const response = await fetch(WHITE_PNG);\n        const imageBlob = await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n        return imageBitmap.width === 1 && imageBitmap.height === 1;\n      } catch (_e) {\n        return false;\n      }\n    }\n    void checkImageBitmap().then((result) => {\n      self.postMessage(result);\n    });\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(aH)}}aI.revokeObjectURL=function(){aH&&(URL.revokeObjectURL(aH),aH=null)};let aJ=null;class aK{constructor(){aJ||(aJ=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    async function loadImageBitmap(url, alphaMode) {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n      }\n      const imageBlob = await response.blob();\n      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);\n    }\n    self.onmessage = async (event) => {\n      try {\n        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);\n        self.postMessage({\n          data: imageBitmap,\n          uuid: event.data.uuid,\n          id: event.data.id\n        }, [imageBitmap]);\n      } catch (e) {\n        self.postMessage({\n          error: e,\n          uuid: event.data.uuid,\n          id: event.data.id\n        });\n      }\n    };\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(aJ)}}aK.revokeObjectURL=function(){aJ&&(URL.revokeObjectURL(aJ),aJ=null)};let aL=0;class aM{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(a=>{let{worker:b}=new aI;b.addEventListener("message",c=>{b.terminate(),aI.revokeObjectURL(),a(c.data)})})),this._isImageBitmapSupported}loadImageBitmap(a,b){return this._run("loadImageBitmap",[a,b?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){void 0===f&&(f=navigator.hardwareConcurrency||4);let a=this._workerPool.pop();return!a&&this._createdWorkers<f&&(this._createdWorkers++,(a=new aK().worker).addEventListener("message",a=>{this._complete(a.data),this._returnWorker(a.target),this._next()})),a}_returnWorker(a){this._workerPool.push(a)}_complete(a){this._resolveHash[a.uuid]&&(void 0!==a.error?this._resolveHash[a.uuid].reject(a.error):this._resolveHash[a.uuid].resolve(a.data),delete this._resolveHash[a.uuid])}async _run(a,b){await this._initWorkers();let c=new Promise((c,d)=>{this._queue.push({id:a,arguments:b,resolve:c,reject:d})});return this._next(),c}_next(){if(!this._queue.length)return;let a=this._getWorker();if(!a)return;let b=this._queue.pop(),c=b.id;this._resolveHash[aL]={resolve:b.resolve,reject:b.reject},a.postMessage({data:b.arguments,uuid:aL++,id:c})}reset(){this._workerPool.forEach(a=>a.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:a})=>{a?.(Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}let aN=new aM,aO=[".jpeg",".jpg",".png",".webp",".avif"],aP=["image/jpeg","image/png","image/webp","image/avif"];async function aQ(a,b){let c=await B.e.get().fetch(a);if(!c.ok)throw Error(`[loadImageBitmap] Failed to fetch ${a}: ${c.status} ${c.statusText}`);let d=await c.blob();return b?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(d,{premultiplyAlpha:"none"}):createImageBitmap(d)}let aR={name:"loadTextures",id:"texture",extension:{type:y.Ag.LoadParser,priority:K.T.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:a=>ap(a,aP)||aq(a,aO),async load(a,b,c){let d=null;return d=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await aN.isImageBitmapSupported()?await aN.loadImageBitmap(a,b):await aQ(a,b):await new Promise((b,c)=>{(d=B.e.get().createImage()).crossOrigin=this.config.crossOrigin,d.src=a,d.complete?b(d):(d.onload=()=>{b(d)},d.onerror=c)}),aD(new az.b({resource:d,alphaMode:"premultiply-alpha-on-upload",resolution:b.data?.resolution||aC(a),...b.data}),c,a)},unload(a){a.destroy(!0)}};var aS=c(25805),aT=c(15996);let aU=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],aV={name:"loadVideo",id:"video",extension:{type:y.Ag.LoadParser,name:"loadVideo"},test(a){if(!g||!h){let{validVideoExtensions:a,validVideoMime:b}=function(){let a=[],b=[];for(let c of aU){let d=aS.$.MIME_TYPES[c.substring(1)]||`video/${c.substring(1)}`;ah(d)&&(a.push(c),b.includes(d)||b.push(d))}return{validVideoExtensions:a,validVideoMime:b}}();g=a,h=b}let b=ap(a,h),c=aq(a,g);return b||c},async load(a,b,c){var d;let e,f={...aS.$.defaultOptions,resolution:b.data?.resolution||aC(a),alphaMode:b.data?.alphaMode||await (0,aT.C)(),...b.data},g=document.createElement("video"),h={preload:!1!==f.autoLoad?"auto":void 0,"webkit-playsinline":!1!==f.playsinline?"":void 0,playsinline:!1!==f.playsinline?"":void 0,muted:!0===f.muted?"":void 0,loop:!0===f.loop?"":void 0,autoplay:!1!==f.autoPlay?"":void 0};Object.keys(h).forEach(a=>{let b=h[a];void 0!==b&&g.setAttribute(a,b)}),!0===f.muted&&(g.muted=!0),void 0!==(d=f.crossorigin)||a.startsWith("data:")?!1!==d&&(g.crossOrigin="string"==typeof d?d:"anonymous"):g.crossOrigin=function(a,b=globalThis.location){if(a.startsWith("data:"))return"";b||(b=globalThis.location);let c=new URL(a,document.baseURI);return c.hostname!==b.hostname||c.port!==b.port||c.protocol!==b.protocol?"anonymous":""}(a);let i=document.createElement("source");if(f.mime)e=f.mime;else if(a.startsWith("data:"))e=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){let b=a.split("?")[0].slice(a.lastIndexOf(".")+1).toLowerCase();e=aS.$.MIME_TYPES[b]||`video/${b}`}return i.src=a,e&&(i.type=e),new Promise(d=>{let e=async()=>{let h=new aS.$({...f,resource:g});g.removeEventListener("canplay",e),b.data.preload&&await new Promise((a,b)=>{function c(){e(),a()}function d(a){e(),b(a)}function e(){g.removeEventListener("canplaythrough",c),g.removeEventListener("error",d)}g.addEventListener("canplaythrough",c),g.addEventListener("error",d),g.load()}),d(aD(h,c,a))};f.preload&&!f.autoPlay&&g.load(),g.addEventListener("canplay",e),g.appendChild(i)})},unload(a){a.destroy(!0)}},aW={extension:{type:y.Ag.ResolveParser,name:"resolveTexture"},test:aR.test,parse:a=>({resolution:parseFloat(aB.x.RETINA_PREFIX.exec(a)?.[1]??"1"),format:a.split(".").pop(),src:a})},aX={extension:{type:y.Ag.ResolveParser,priority:-2,name:"resolveJson"},test:a=>aB.x.RETINA_PREFIX.test(a)&&a.endsWith(".json"),parse:aW.parse};class aY{constructor(){this._detections=[],this._initialized=!1,this.resolver=new aB.x,this.loader=new ao,this.cache=aa.l,this._backgroundLoader=new _(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(a={}){if(this._initialized)return void(0,$.R)("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this._initialized=!0,a.defaultSearchParams&&this.resolver.setDefaultSearchParams(a.defaultSearchParams),a.basePath&&(this.resolver.basePath=a.basePath),a.bundleIdentifier&&this.resolver.setBundleIdentifier(a.bundleIdentifier),a.manifest){let b=a.manifest;"string"==typeof b&&(b=await this.load(b)),this.resolver.addManifest(b)}let b=a.texturePreference?.resolution??1,c=await this._detectFormats({preferredFormats:a.texturePreference?.format,skipDetections:a.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:c,resolution:"number"==typeof b?[b]:b}}),a.preferences&&this.setPreferences(a.preferences),a.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...a.loadOptions})}add(a){this.resolver.add(a)}async load(a,b){this._initialized||await this.init();let c=(0,an.a)(a),d=(0,am.z)(a).map(a=>{if("string"!=typeof a){let b=this.resolver.getAlias(a);return b.some(a=>!this.resolver.hasKey(a))&&this.add(a),Array.isArray(b)?b[0]:b}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),e=this.resolver.resolve(d),f=await this._mapLoadToResolve(e,b);return c?f[d[0]]:f}addBundle(a,b){this.resolver.addBundle(a,b)}async loadBundle(a,b){this._initialized||await this.init();let c=!1;"string"==typeof a&&(c=!0,a=[a]);let d=this.resolver.resolveBundle(a),e={},f=Object.keys(d),g=0,h=[],i=f.map((a,c)=>{let f=d[a],i=[...new Set(Object.values(f).flat())].reduce((a,b)=>a+(b.progressSize||1),0);return h.push(0),g+=i,this._mapLoadToResolve(f,a=>{h[c]=a*i,b?.(h.reduce((a,b)=>a+b,0)/g)}).then(b=>{e[a]=b})});return await Promise.all(i),c?e[a[0]]:e}async backgroundLoad(a){this._initialized||await this.init(),"string"==typeof a&&(a=[a]);let b=this.resolver.resolve(a);this._backgroundLoader.add(Object.values(b))}async backgroundLoadBundle(a){this._initialized||await this.init(),"string"==typeof a&&(a=[a]),Object.values(this.resolver.resolveBundle(a)).forEach(a=>{this._backgroundLoader.add(Object.values(a))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(a){if("string"==typeof a)return aa.l.get(a);let b={};for(let c=0;c<a.length;c++)b[c]=aa.l.get(a[c]);return b}async _mapLoadToResolve(a,b){let c=[...new Set(Object.values(a))];this._backgroundLoader.active=!1;let d=await this.loader.load(c,b);this._backgroundLoader.active=!0;let e={};return c.forEach(a=>{let b=d[a.src],c=[a.src];a.alias&&c.push(...a.alias),c.forEach(a=>{e[a]=b}),aa.l.set(c,b)}),e}async unload(a){this._initialized||await this.init();let b=(0,am.z)(a).map(a=>"string"!=typeof a?a.src:a),c=this.resolver.resolve(b);await this._unloadFromResolved(c)}async unloadBundle(a){this._initialized||await this.init(),a=(0,am.z)(a);let b=this.resolver.resolveBundle(a),c=Object.keys(b).map(a=>this._unloadFromResolved(b[a]));await Promise.all(c)}async _unloadFromResolved(a){let b=Object.values(a);b.forEach(a=>{aa.l.remove(a.src)}),await this.loader.unload(b)}async _detectFormats(a){let b=[];for(let c of(a.preferredFormats&&(b=Array.isArray(a.preferredFormats)?a.preferredFormats:[a.preferredFormats]),a.detections))a.skipDetections||await c.test()?b=await c.add(b):a.skipDetections||(b=await c.remove(b));return b=b.filter((a,c)=>b.indexOf(a)===c)}get detections(){return this._detections}setPreferences(a){this.loader.parsers.forEach(b=>{b.config&&Object.keys(b.config).filter(b=>b in a).forEach(c=>{b.config[c]=a[c]})})}}let aZ=new aY;y.XO.handleByList(y.Ag.LoadParser,aZ.loader.parsers).handleByList(y.Ag.ResolveParser,aZ.resolver.parsers).handleByList(y.Ag.CacheParser,aZ.cache.parsers).handleByList(y.Ag.DetectionParser,aZ.detections),y.XO.add(ab,af,ad,al,ai,aj,ak,ar,as,ay,aE,aR,aV,Z,Y,aW,aX);let a$={loader:y.Ag.LoadParser,resolver:y.Ag.ResolveParser,cache:y.Ag.CacheParser,detection:y.Ag.DetectionParser};y.XO.handle(y.Ag.Asset,a=>{let b=a.ref;Object.entries(a$).filter(([a])=>!!b[a]).forEach(([a,c])=>y.XO.add(Object.assign(b[a],{extension:b[a].extension??c})))},a=>{let b=a.ref;Object.keys(a$).filter(a=>!!b[a]).forEach(a=>y.XO.remove(b[a]))}),c(43984);var a_=c(21783);c(15104),c(87796),c(96609),c(67891),c(81618);var a0=c(30006);function a1(a){if(!a)return[];try{let b=JSON.parse(a),c=b?.boxes;if(!Array.isArray(c))return[];return c.map(a=>({x:Number(a?.x??0),y:Number(a?.y??0),w:Number(a?.w??0),h:Number(a?.h??0)})).filter(a=>Number.isFinite(a.x)&&Number.isFinite(a.y)&&a.w>0&&a.h>0)}catch{return[]}}function a2(a){let{asset:b,projectId:c,onClose:d}=a,e=!!b.mime_type&&b.mime_type.startsWith("video/"),[f,g]=(0,v.useState)(!1),[h,i]=(0,v.useState)(!!a.originRect),j=(0,v.useRef)(!1),k=(0,v.useRef)(null),l=(0,v.useRef)(null),[m,n]=(0,v.useState)(null),[o,p]=(0,v.useState)(null),[q,r]=(0,v.useState)(null),[s,t]=(0,v.useState)("translate(0px,0px) scale(1,1)"),w=(0,v.useRef)(null),x=(0,v.useMemo)(()=>(function(a){if(!a)return[];try{let b=JSON.parse(a);if(!Array.isArray(b))return[];return b.map(a=>String(a)).filter(Boolean)}catch{return[]}})(b.ai_tags_json),[b.ai_tags_json]),y=(0,v.useRef)(null),[z,A]=(0,v.useState)(null),B=(0,v.useMemo)(()=>o?m?.find(a=>a.tag===o)??null:null,[m,o]),C=(0,v.useCallback)(()=>{if(j.current)return;j.current=!0,l.current&&(window.clearTimeout(l.current),l.current=null),g(!1);let b=a.originRect??null;if(!b)return void d();let c=(()=>{let a=document.querySelector("[data-asset-lightbox-target='true']");if(!a)return w.current;let b=a.getBoundingClientRect();return b.width>2&&b.height>2?{left:b.left,top:b.top,width:b.width,height:b.height}:w.current})();if(!c)return void d();i(!0),r({position:"fixed",left:c.left,top:c.top,width:c.width,height:c.height,zIndex:1e4,pointerEvents:"none",transition:"transform 240ms cubic-bezier(0.2, 0.9, 0.2, 1), opacity 140ms ease-out",transformOrigin:"center center",opacity:1}),t("translate(0px, 0px) scale(1, 1)");let e=b.left+b.width/2,f=b.top+b.height/2,h=c.left+c.width/2,m=c.top+c.height/2,n=e-h,o=f-m,p=b.width/c.width,q=b.height/c.height;requestAnimationFrame(()=>{requestAnimationFrame(()=>t(`translate(${n}px, ${o}px) scale(${p}, ${q})`))}),k.current=window.setTimeout(()=>d(),260)},[d,a.originRect]),D=(0,v.useCallback)(()=>{let a=y.current;if(!a)return;let c=a.clientWidth,d=a.clientHeight,e=a.naturalWidth||b.width||0,f=a.naturalHeight||b.height||0;if(!(c>2&&d>2&&e>2&&f>2))return void A(null);let g=Math.min(c/e,d/f),h=e*g,i=f*g;A({offsetX:(c-h)/2,offsetY:(d-i)/2,drawW:h,drawH:i,scale:g})},[b.height,b.width]);return(0,u.jsxs)("div",{className:"fixed inset-0 z-[9999] bg-black transition-opacity duration-200 "+(f?"opacity-100":"opacity-0"),onClick:()=>C(),"aria-modal":"true",role:"dialog",children:[q?(0,u.jsx)("div",{style:{...q,transform:s},children:e?(0,u.jsx)("video",{src:b.storage_url,className:"h-full w-full object-contain",muted:!0,playsInline:!0}):(0,u.jsx)("img",{src:b.storage_url,alt:"",className:"h-full w-full object-contain",draggable:!1})}):null,(0,u.jsxs)("div",{className:"flex h-full w-full flex-col md:flex-row md:gap-0 transition-transform duration-200 ease-out "+(f?"scale-100":"scale-[0.985]"),onClick:a=>a.stopPropagation(),children:[(0,u.jsx)("div",{className:"flex min-h-0 flex-1 items-center justify-center p-4 md:p-8",children:(0,u.jsxs)("div",{className:"relative h-full w-full max-w-[min(1100px,100%)]",children:[e?(0,u.jsx)("video",{"data-asset-lightbox-target":"true",src:b.storage_url,controls:!0,playsInline:!0,className:"h-full w-full object-contain "+(h?"opacity-0":"opacity-100")}):(0,u.jsx)("img",{"data-asset-lightbox-target":"true",ref:y,src:b.storage_url,alt:b.original_name||"asset",className:"h-full w-full object-contain "+(h?"opacity-0":"opacity-100"),draggable:!1,onLoad:()=>D()}),!h&&B&&z?(0,u.jsxs)("div",{className:"pointer-events-none absolute inset-0",children:[B.svg&&B.svg.trim().startsWith("<svg")?(0,u.jsx)("img",{alt:"",draggable:!1,src:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(B.svg)}`,style:{position:"absolute",left:z.offsetX,top:z.offsetY,width:z.drawW,height:z.drawH,opacity:.22,mixBlendMode:"screen",filter:"drop-shadow(0px 0px 10px rgba(124, 58, 237, 0.65))"}}):null,a1(B.bboxJson).map((a,b)=>{let c=a.x>=0&&a.y>=0&&a.x<=1.5&&a.y<=1.5&&a.w>0&&a.h>0&&a.w<=1.5&&a.h<=1.5,d=c?a.x*z.drawW:a.x*z.scale,e=c?a.y*z.drawH:a.y*z.scale,f=c?a.w*z.drawW:a.w*z.scale,g=c?a.h*z.drawH:a.h*z.scale;return(0,u.jsx)("div",{style:{position:"absolute",left:z.offsetX+d,top:z.offsetY+e,width:f,height:g},className:"rounded-sm border-2 border-violet-400/90 bg-violet-500/10 shadow-[0_0_18px_rgba(124,58,237,0.55)]"},`${B.tag}-${b}`)})]}):null]})}),(0,u.jsxs)("aside",{className:"w-full shrink-0 border-t border-white/10 bg-zinc-950/60 backdrop-blur md:w-[420px] md:border-l md:border-t-0",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between gap-3 border-b border-white/10 p-4",children:[(0,u.jsxs)("div",{className:"min-w-0",children:[(0,u.jsx)("div",{className:"truncate text-sm font-medium text-zinc-100",children:b.original_name}),(0,u.jsxs)("div",{className:"truncate text-xs text-zinc-400",children:[b.width&&b.height?`${b.width}\xd7${b.height}`:"",b.mime_type?b.width&&b.height?` \xb7 ${b.mime_type}`:b.mime_type:"",Number.isFinite(b.byte_size)?` \xb7 ${function(a){if(!Number.isFinite(a)||a<=0)return"0 B";let b=["B","KB","MB","GB","TB"],c=Math.min(b.length-1,Math.floor(Math.log(a)/Math.log(1024))),d=a/Math.pow(1024,c);return`${d.toFixed(d>=10||0===c?0:1)} ${b[c]}`}(b.byte_size)}`:""]})]}),(0,u.jsx)("button",{onClick:()=>C(),className:"inline-flex h-10 w-10 shrink-0 items-center justify-center rounded-full border border-white/10 bg-black/30 text-zinc-200 hover:bg-black/50 focus:outline-none focus:ring-2 focus:ring-violet-400/50","aria-label":"Close",children:(0,u.jsx)("span",{"aria-hidden":"true",className:"text-lg leading-none",children:"\xd7"})})]}),(0,u.jsx)("div",{className:"max-h-[45vh] overflow-auto p-4 md:max-h-none md:h-[calc(100%-57px)]",children:(0,u.jsxs)("div",{className:"space-y-5",children:[(0,u.jsx)("section",{children:(0,u.jsxs)("div",{className:"mt-2 space-y-2 text-sm text-zinc-100",children:[b.ai_caption?(0,u.jsx)("div",{className:"rounded-lg border border-white/10 bg-black/20 p-3 text-sm text-zinc-100",children:b.ai_caption}):null,x.length?(0,u.jsx)("div",{className:"flex flex-wrap gap-2",children:x.slice(0,64).map(a=>(0,u.jsx)("div",{className:"rounded-full border border-white/10 bg-black/20 px-2 py-1 text-xs text-zinc-200",children:a},a))}):null]})}),(0,u.jsxs)("section",{children:[(0,u.jsx)("div",{className:"text-xs font-medium text-zinc-300",children:"Segments"}),(0,u.jsx)("div",{className:"mt-2",children:null===m?(0,u.jsx)("div",{className:"text-xs text-zinc-500",children:"Loading"}):m.length?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-2",children:[(0,u.jsx)("div",{className:"text-xs text-zinc-500",children:"Click a tag to highlight it on the image."}),o?(0,u.jsx)("button",{onClick:()=>p(null),className:"rounded-md border border-white/10 bg-black/30 px-2 py-1 text-[11px] text-zinc-200 hover:bg-black/50",children:"Clear"}):null]}),(0,u.jsx)("div",{className:"flex flex-wrap gap-2",children:m.slice(0,80).map(a=>{let b=a.tag===o;return(0,u.jsx)("button",{type:"button",onClick:()=>p(b=>b===a.tag?null:a.tag),className:"rounded-full border px-2 py-1 text-xs "+(b?"border-violet-400/60 bg-violet-500/15 text-zinc-100":"border-white/10 bg-black/20 text-zinc-200 hover:bg-black/30"),title:a.updatedAt,children:a.tag},a.tag)})}),!o||B?.svg||a1(B?.bboxJson??null).length?null:(0,u.jsxs)("div",{className:"mt-2 text-xs text-zinc-500",children:["No overlay data cached for ",(0,u.jsx)("span",{className:"text-zinc-300",children:o}),"."]})]}):(0,u.jsx)("div",{className:"text-xs text-zinc-500",children:"No cached segments."})})]}),(0,u.jsxs)("section",{children:[(0,u.jsx)("div",{className:"text-xs font-medium text-zinc-300",children:"File"}),(0,u.jsxs)("div",{className:"mt-2 space-y-2 text-xs text-zinc-300",children:[(0,u.jsxs)("div",{className:"break-all",children:[(0,u.jsx)("span",{className:"text-zinc-500",children:"Created:"})," ",b.created_at]}),b.ai_updated_at?(0,u.jsxs)("div",{className:"break-all",children:[(0,u.jsx)("span",{className:"text-zinc-500",children:"AI Updated:"})," ",b.ai_updated_at]}):null]})]})]})})]})]})]})}c(57680),y.XO.add(z,A);let a3="projectDrafts",a4=new Map,a5=null;async function a6(a){a4.set(a.projectId,a);let b=(await (a5||(a5=new Promise((a,b)=>{let c=indexedDB.open("moondream",1);c.onupgradeneeded=()=>{let a=c.result;a.objectStoreNames.contains(a3)||a.createObjectStore(a3,{keyPath:"projectId"})},c.onsuccess=()=>a(c.result),c.onerror=()=>{let a=c.error??Error("indexedDB.open failed");a5=null,b(a)}})))).transaction(a3,"readwrite");b.objectStore(a3).put(a),await new Promise((a,c)=>{b.oncomplete=()=>a(),b.onerror=()=>c(b.error??Error("IDB transaction failed")),b.onabort=()=>c(b.error??Error("IDB transaction aborted"))})}let a7=new Map,a8=globalThis.requestIdleCallback??((a,b)=>globalThis.setTimeout(()=>a({didTimeout:!0,timeRemaining:()=>0}),Math.max(0,b?.timeout??200)));async function a9(a){let b=a7.get(a);if(b&&!b.inFlight){b.inFlight=!0;try{let c=b.next;if(await a6(c),b.inFlight=!1,b.next===c){b.resolve(c),a7.delete(a);return}b.scheduled||(b.scheduled=!0,a8(()=>{let b=a7.get(a);b&&(b.scheduled=!1,a9(a))},{timeout:b.timeoutMs}))}catch(c){b.inFlight=!1,b.reject(c),a7.delete(a)}}}async function ba(a,b){return await function(a,b,c){let d={...a4.get(a)??{projectId:a,updatedAt:0,canvas:null,view:null,dirtyCanvas:!1,dirtyView:!1},...b,projectId:a,updatedAt:b.updatedAt??Date.now()};a4.set(a,d);let e=a7.get(a);if(e)e.next=d,e.timeoutMs=c?.timeoutMs??e.timeoutMs;else{let b,f,g=new Promise((a,c)=>{b=a,f=c});e={next:d,timeoutMs:c?.timeoutMs??300,scheduled:!1,inFlight:!1,promise:g,resolve:b,reject:f},a7.set(a,e)}return e.scheduled||e.inFlight||(e.scheduled=!0,a8(()=>{(e=a7.get(a))&&(e.scheduled=!1),a9(a)},{timeout:e.timeoutMs})),e.promise}(a,b,{timeoutMs:300})}let bb={bgHex:592139,bgAlpha:.88,strokeHex:0xffffff,strokeAlpha:.1,shadeAlpha:.28};function bc(a){let b=a.projectId,c=a.initialObjects;a.initialView;let d=a.onObjectsChange,e=(0,v.useRef)(null),f=(0,v.useRef)(null),g=(0,v.useRef)(null);(0,v.useRef)(null);let h=(0,v.useRef)(new Map);(0,v.useRef)(new Map),(0,v.useRef)(new Map),(0,v.useRef)(new Map),(0,v.useRef)(new Map),(0,v.useRef)(new Set),(0,v.useRef)(new Map),(0,v.useRef)(null),(0,v.useRef)(!1),(0,v.useRef)(null),(0,v.useRef)(new Map),(0,v.useRef)([]),(0,v.useRef)(new Map),(0,v.useRef)(new Map),(0,v.useRef)(new Set),(0,v.useRef)(null),(0,v.useRef)(new a_.b(.5,.5));let i=(0,v.useRef)(null),j=(0,v.useRef)(null);(0,v.useRef)(null),(0,v.useRef)(null),(0,v.useRef)({}),(0,v.useRef)(null),(0,v.useRef)(null),(0,v.useRef)(null),(0,v.useRef)(null),(0,v.useRef)(null);let[k,l]=(0,v.useState)(c),[m,n]=(0,v.useState)(a.initialAssets),[o,p]=(0,v.useState)([]),[q,r]=(0,v.useState)(null),[s,t]=(0,v.useState)(null);(0,v.useRef)(null);let[w,x]=(0,v.useState)(!0),[y,z]=(0,v.useState)(!1),[A,B]=(0,v.useState)(()=>({online:!0,dirtyCanvas:!1,dirtyView:!1,syncing:!1})),C=(0,v.useRef)({canvas:!1,view:!1});(0,v.useRef)(null);let D=(0,v.useRef)(null);(0,v.useRef)(null);let[E,F]=(0,v.useState)(null);(0,v.useRef)(c),(0,v.useRef)(bb),(0,v.useRef)(bb.shadeAlpha);let G=a=>{C.current.canvas!==a&&(C.current.canvas=a,B(b=>({...b,dirtyCanvas:a})))},H=(0,v.useRef)(null);(0,v.useRef)(null);let I=(0,v.useRef)(null),J=(0,v.useRef)(null),K=(0,v.useRef)(null),L=(0,v.useMemo)(()=>{let a=new Map;for(let b of m)a.set(b.id,b);return a},[m]);(0,v.useMemo)(()=>new Set(o),[o]),1===o.length&&o[0];let M=async c=>{let e;c.preventDefault(),r(null);let k=f.current,m=g.current;if(!k||!m)return;let o=Array.from(c.dataTransfer.files||[]);if(0===o.length)return;let p=k.canvas.getBoundingClientRect(),q=(c.clientX-p.left)*k.renderer.width/p.width,s=(c.clientY-p.top)*k.renderer.height/p.height,t=28*k.renderer.width/p.width,u=28*k.renderer.height/p.height,v=40*k.renderer.width/p.width,w=40*k.renderer.height/p.height,x=new FormData;for(let a of o)x.append("files",a,a.name);try{e=await fetch(`/api/projects/${a.projectId}/assets/upload`,{method:"POST",body:x})}catch(a){console.error("upload_failed(fetch)",a),r("Upload failed (network). If you restarted dev server, refresh the page.");return}if(!e.ok){let a=await e.text().catch(()=>"");console.error("upload_failed(response)",e.status,a),r(`Upload failed (${e.status}).`);return}let y=(await e.json()).assets||[];n(a=>{let b=[...y,...a],c=new Set;return b.filter(a=>!c.has(a.id)&&(c.add(a.id),!0))});let z=y.map(()=>globalThis.crypto?.randomUUID?.()??`${Date.now()}-${Math.random()}`);z.length>0&&(i.current={objectId:z[0],rx:q,ry:s,fired:!1});let A=new Date().toISOString();l(c=>{let e=[...c],g=c.reduce((a,b)=>Math.max(a,b.z_index),0)+1;for(let b=0;b<y.length;b++){let c=y[b],d=b%12,f=Math.floor(b/12),h=m.toLocal(new a_.b(q+d*t+f*v,s+d*u+f*w));e.push({id:z[b],project_id:a.projectId,type:"image",asset_id:c.id,x:h.x,y:h.y,scale_x:1,scale_y:1,rotation:0,width:c.width??null,height:c.height??null,z_index:g++,props_json:null,created_at:A,updated_at:A})}return!d||(K.current=e,J.current||(J.current=window.setTimeout(()=>{J.current=null;let a=K.current;K.current=null,a&&d?.(a)},0))),D.current&&window.clearTimeout(D.current),D.current=window.setTimeout(()=>{ba(b,{canvas:e,dirtyCanvas:!0}).catch(()=>{})},40),G(!0),H.current&&window.clearTimeout(H.current),H.current=window.setTimeout(async()=>{try{let c=await fetch(`/api/projects/${a.projectId}/canvas`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({objects:e})});if(!c.ok)throw Error(`canvas_save_failed:${c.status}`);ba(b,{canvas:e,dirtyCanvas:!1}).catch(()=>{}),G(!1)}catch{G(!0)}},250),I.current&&window.clearTimeout(I.current),I.current=window.setTimeout(async()=>{let b=f.current,c=j.current;if(!b||!c)return;let d=c.content,e=c.spriteById,g=1/0,i=1/0,k=-1/0,l=-1/0;for(let a of h.current.values()){let b=a.texture?.orig?.width??0,c=a.texture?.orig?.height??0;if(b<=0||c<=0)continue;let d=b/2*a.scale.x,e=c/2*a.scale.y;g=Math.min(g,a.position.x-d),k=Math.max(k,a.position.x+d),i=Math.min(i,a.position.y-e),l=Math.max(l,a.position.y+e)}if(!Number.isFinite(g)||!Number.isFinite(i)||!Number.isFinite(k)||!Number.isFinite(l))return;let m=Math.max(Math.max(1,k-g),Math.max(1,l-i)),n=Math.max(24,.08*m),o=(g+k)/2,p=(i+l)/2,q=new Set;for(let a of h.current.values()){let b=a.__objectId;if(!b)continue;let c=a.texture,f=c?.orig?.width??0,g=c?.orig?.height??0;if(f<=0||g<=0)continue;q.add(b);let h=e.get(b);h?h.texture!==c&&(h.texture=c):((h=new a0.k(c)).anchor.set(.5),h.eventMode="none",d.addChild(h),e.set(b,h)),h.position.copyFrom(a.position),h.scale.copyFrom(a.scale),h.rotation=a.rotation,h.alpha=1}for(let[a,b]of e.entries())q.has(a)||(b.destroy({children:!0,texture:!1}),e.delete(a));let r=256/(m+2*n);d.scale.set(r),d.position.set(128-o*r,128-p*r),b.renderer.render({container:c.root,target:c.rt,clear:!0,clearColor:657930});let s=b.renderer.extract.canvas({target:c.rt}),t=null;if(s?.convertToBlob?(t=await s.convertToBlob({type:"image/webp",quality:.75}).catch(()=>null))||(t=await s.convertToBlob({type:"image/png"}).catch(()=>null)):s?.toBlob&&(t=await new Promise(a=>s.toBlob(a,"image/webp",.75))??await new Promise(a=>s.toBlob(a,"image/png"))),!t)return;let u=await t.arrayBuffer();await fetch(`/api/projects/${a.projectId}/preview`,{method:"PUT",headers:{"Content-Type":t.type||"image/webp"},body:u}).catch(()=>{})},1200),e})};return(0,u.jsxs)("div",{onDragOver:a=>a.preventDefault(),onDrop:M,className:"relative h-full w-full",children:[(0,u.jsx)("div",{ref:e,className:"absolute inset-0 "+(w?"opacity-0 pointer-events-none":"opacity-100")}),y?(0,u.jsx)("div",{className:"pointer-events-none absolute inset-0 z-40 grid place-items-center",children:(0,u.jsx)("div",{className:"rounded-xl border border-white/10 bg-black/60 px-4 py-3 text-sm text-zinc-200 backdrop-blur",children:"Loading"})}):null,A.online?null:(0,u.jsx)("div",{className:"pointer-events-none absolute right-4 top-4 z-50",children:(0,u.jsx)("div",{className:"rounded-full border px-3 py-1 text-[11px] font-medium "+(A.online?"border-amber-900/40 bg-amber-950/35 text-amber-200":"border-red-900/50 bg-red-950/50 text-red-200"),children:"Offline"})}),q?(0,u.jsx)("div",{className:"pointer-events-none absolute left-1/2 top-10 -translate-x-1/2 rounded-lg border border-red-900/50 bg-red-950/60 px-3 py-2 text-xs text-red-200",children:q}):null,s&&L.get(s)?(0,u.jsx)(a2,{projectId:a.projectId,asset:L.get(s),originRect:E,onClose:()=>t(null)}):null]})}var bd=/[\\\/_+.#"@\[\(\{&]/,be=/[\\\/_+.#"@\[\(\{&]/g,bf=/[\s-]/,bg=/[\s-]/g;function bh(a){return a.toLowerCase().replace(bg," ")}function bi(a,b,{checkForDefaultPrevented:c=!0}={}){return function(d){if(a?.(d),!1===c||!d.defaultPrevented)return b?.(d)}}function bj(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}function bk(...a){return b=>{let c=!1,d=a.map(a=>{let d=bj(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():bj(a[b],null)}}}}function bl(...a){return v.useCallback(bk(...a),a)}"undefined"!=typeof window&&window.document&&window.document.createElement;var bm=globalThis?.document?v.useLayoutEffect:()=>{},bn=w[" useId ".trim().toString()]||(()=>void 0),bo=0;function bp(a){let[b,c]=v.useState(bn());return bm(()=>{a||c(a=>a??String(bo++))},[a]),a||(b?`radix-${b}`:"")}var bq=w[" useInsertionEffect ".trim().toString()]||bm;Symbol("RADIX:SYNC_STATE");var br=c(74429);function bs(a){var b;let c,d=(b=a,(c=v.forwardRef((a,b)=>{let{children:c,...d}=a;if(v.isValidElement(c)){var e;let a,f,g=(e=c,(f=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(f=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref),h=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==v.Fragment&&(h.ref=b?bk(b,g):g),v.cloneElement(c,h)}return v.Children.count(c)>1?v.Children.only(null):null})).displayName=`${b}.SlotClone`,c),e=v.forwardRef((a,b)=>{let{children:c,...e}=a,f=v.Children.toArray(c),g=f.find(bu);if(g){let a=g.props.children,c=f.map(b=>b!==g?b:v.Children.count(a)>1?v.Children.only(null):v.isValidElement(a)?a.props.children:null);return(0,u.jsx)(d,{...e,ref:b,children:v.isValidElement(a)?v.cloneElement(a,void 0,c):null})}return(0,u.jsx)(d,{...e,ref:b,children:c})});return e.displayName=`${a}.Slot`,e}var bt=Symbol("radix.slottable");function bu(a){return v.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===bt}var bv=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{let c=bs(`Primitive.${b}`),d=v.forwardRef((a,d)=>{let{asChild:e,...f}=a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,u.jsx)(e?c:b,{...f,ref:d})});return d.displayName=`Primitive.${b}`,{...a,[b]:d}},{});function bw(a){let b=v.useRef(a);return v.useEffect(()=>{b.current=a}),v.useMemo(()=>(...a)=>b.current?.(...a),[])}var bx="dismissableLayer.update",by=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),bz=v.forwardRef((a,b)=>{let{disableOutsidePointerEvents:c=!1,onEscapeKeyDown:d,onPointerDownOutside:e,onFocusOutside:f,onInteractOutside:g,onDismiss:h,...i}=a,j=v.useContext(by),[k,l]=v.useState(null),m=k?.ownerDocument??globalThis?.document,[,n]=v.useState({}),o=bl(b,a=>l(a)),p=Array.from(j.layers),[q]=[...j.layersWithOutsidePointerEventsDisabled].slice(-1),r=p.indexOf(q),t=k?p.indexOf(k):-1,w=j.layersWithOutsidePointerEventsDisabled.size>0,x=t>=r,y=function(a,b=globalThis?.document){let c=bw(a),d=v.useRef(!1),e=v.useRef(()=>{});return v.useEffect(()=>{let a=a=>{if(a.target&&!d.current){let d=function(){bB("dismissableLayer.pointerDownOutside",c,f,{discrete:!0})},f={originalEvent:a};"touch"===a.pointerType?(b.removeEventListener("click",e.current),e.current=d,b.addEventListener("click",e.current,{once:!0})):d()}else b.removeEventListener("click",e.current);d.current=!1},f=window.setTimeout(()=>{b.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(f),b.removeEventListener("pointerdown",a),b.removeEventListener("click",e.current)}},[b,c]),{onPointerDownCapture:()=>d.current=!0}}(a=>{let b=a.target,c=[...j.branches].some(a=>a.contains(b));x&&!c&&(e?.(a),g?.(a),a.defaultPrevented||h?.())},m),z=function(a,b=globalThis?.document){let c=bw(a),d=v.useRef(!1);return v.useEffect(()=>{let a=a=>{a.target&&!d.current&&bB("dismissableLayer.focusOutside",c,{originalEvent:a},{discrete:!1})};return b.addEventListener("focusin",a),()=>b.removeEventListener("focusin",a)},[b,c]),{onFocusCapture:()=>d.current=!0,onBlurCapture:()=>d.current=!1}}(a=>{let b=a.target;![...j.branches].some(a=>a.contains(b))&&(f?.(a),g?.(a),a.defaultPrevented||h?.())},m);return!function(a,b=globalThis?.document){let c=bw(a);v.useEffect(()=>{let a=a=>{"Escape"===a.key&&c(a)};return b.addEventListener("keydown",a,{capture:!0}),()=>b.removeEventListener("keydown",a,{capture:!0})},[c,b])}(a=>{t===j.layers.size-1&&(d?.(a),!a.defaultPrevented&&h&&(a.preventDefault(),h()))},m),v.useEffect(()=>{if(k)return c&&(0===j.layersWithOutsidePointerEventsDisabled.size&&(s=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),j.layersWithOutsidePointerEventsDisabled.add(k)),j.layers.add(k),bA(),()=>{c&&1===j.layersWithOutsidePointerEventsDisabled.size&&(m.body.style.pointerEvents=s)}},[k,m,c,j]),v.useEffect(()=>()=>{k&&(j.layers.delete(k),j.layersWithOutsidePointerEventsDisabled.delete(k),bA())},[k,j]),v.useEffect(()=>{let a=()=>n({});return document.addEventListener(bx,a),()=>document.removeEventListener(bx,a)},[]),(0,u.jsx)(bv.div,{...i,ref:o,style:{pointerEvents:w?x?"auto":"none":void 0,...a.style},onFocusCapture:bi(a.onFocusCapture,z.onFocusCapture),onBlurCapture:bi(a.onBlurCapture,z.onBlurCapture),onPointerDownCapture:bi(a.onPointerDownCapture,y.onPointerDownCapture)})});function bA(){let a=new CustomEvent(bx);document.dispatchEvent(a)}function bB(a,b,c,{discrete:d}){let e=c.originalEvent.target,f=new CustomEvent(a,{bubbles:!1,cancelable:!0,detail:c});if(b&&e.addEventListener(a,b,{once:!0}),d)e&&br.flushSync(()=>e.dispatchEvent(f));else e.dispatchEvent(f)}bz.displayName="DismissableLayer",v.forwardRef((a,b)=>{let c=v.useContext(by),d=v.useRef(null),e=bl(b,d);return v.useEffect(()=>{let a=d.current;if(a)return c.branches.add(a),()=>{c.branches.delete(a)}},[c.branches]),(0,u.jsx)(bv.div,{...a,ref:e})}).displayName="DismissableLayerBranch";var bC=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{let c=bs(`Primitive.${b}`),d=v.forwardRef((a,d)=>{let{asChild:e,...f}=a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,u.jsx)(e?c:b,{...f,ref:d})});return d.displayName=`Primitive.${b}`,{...a,[b]:d}},{}),bD="focusScope.autoFocusOnMount",bE="focusScope.autoFocusOnUnmount",bF={bubbles:!1,cancelable:!0},bG=v.forwardRef((a,b)=>{let{loop:c=!1,trapped:d=!1,onMountAutoFocus:e,onUnmountAutoFocus:f,...g}=a,[h,i]=v.useState(null),j=bw(e),k=bw(f),l=v.useRef(null),m=bl(b,a=>i(a)),n=v.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;v.useEffect(()=>{if(d){let a=function(a){if(n.paused||!h)return;let b=a.target;h.contains(b)?l.current=b:bJ(l.current,{select:!0})},b=function(a){if(n.paused||!h)return;let b=a.relatedTarget;null!==b&&(h.contains(b)||bJ(l.current,{select:!0}))};document.addEventListener("focusin",a),document.addEventListener("focusout",b);let c=new MutationObserver(function(a){if(document.activeElement===document.body)for(let b of a)b.removedNodes.length>0&&bJ(h)});return h&&c.observe(h,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",a),document.removeEventListener("focusout",b),c.disconnect()}}},[d,h,n.paused]),v.useEffect(()=>{if(h){bK.add(n);let a=document.activeElement;if(!h.contains(a)){let b=new CustomEvent(bD,bF);h.addEventListener(bD,j),h.dispatchEvent(b),b.defaultPrevented||(function(a,{select:b=!1}={}){let c=document.activeElement;for(let d of a)if(bJ(d,{select:b}),document.activeElement!==c)return}(bH(h).filter(a=>"A"!==a.tagName),{select:!0}),document.activeElement===a&&bJ(h))}return()=>{h.removeEventListener(bD,j),setTimeout(()=>{let b=new CustomEvent(bE,bF);h.addEventListener(bE,k),h.dispatchEvent(b),b.defaultPrevented||bJ(a??document.body,{select:!0}),h.removeEventListener(bE,k),bK.remove(n)},0)}}},[h,j,k,n]);let o=v.useCallback(a=>{if(!c&&!d||n.paused)return;let b="Tab"===a.key&&!a.altKey&&!a.ctrlKey&&!a.metaKey,e=document.activeElement;if(b&&e){var f;let b,d=a.currentTarget,[g,h]=[bI(b=bH(f=d),f),bI(b.reverse(),f)];g&&h?a.shiftKey||e!==h?a.shiftKey&&e===g&&(a.preventDefault(),c&&bJ(h,{select:!0})):(a.preventDefault(),c&&bJ(g,{select:!0})):e===d&&a.preventDefault()}},[c,d,n.paused]);return(0,u.jsx)(bC.div,{tabIndex:-1,...g,ref:m,onKeyDown:o})});function bH(a){let b=[],c=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{let b="INPUT"===a.tagName&&"hidden"===a.type;return a.disabled||a.hidden||b?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;c.nextNode();)b.push(c.currentNode);return b}function bI(a,b){for(let c of a)if(!function(a,{upTo:b}){if("hidden"===getComputedStyle(a).visibility)return!0;for(;a&&(void 0===b||a!==b);){if("none"===getComputedStyle(a).display)return!0;a=a.parentElement}return!1}(c,{upTo:b}))return c}function bJ(a,{select:b=!1}={}){if(a&&a.focus){var c;let d=document.activeElement;a.focus({preventScroll:!0}),a!==d&&(c=a)instanceof HTMLInputElement&&"select"in c&&b&&a.select()}}bG.displayName="FocusScope";var bK=(k=[],{add(a){let b=k[0];a!==b&&b?.pause(),(k=bL(k,a)).unshift(a)},remove(a){k=bL(k,a),k[0]?.resume()}});function bL(a,b){let c=[...a],d=c.indexOf(b);return -1!==d&&c.splice(d,1),c}var bM=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{let c=bs(`Primitive.${b}`),d=v.forwardRef((a,d)=>{let{asChild:e,...f}=a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,u.jsx)(e?c:b,{...f,ref:d})});return d.displayName=`Primitive.${b}`,{...a,[b]:d}},{}),bN=v.forwardRef((a,b)=>{let{container:c,...d}=a,[e,f]=v.useState(!1);bm(()=>f(!0),[]);let g=c||e&&globalThis?.document?.body;return g?br.createPortal((0,u.jsx)(bM.div,{...d,ref:b}),g):null});bN.displayName="Portal";var bO=a=>{var b;let c,d,{present:e,children:f}=a,g=function(a){var b,c;let[d,e]=v.useState(),f=v.useRef(null),g=v.useRef(a),h=v.useRef("none"),[i,j]=(b=a?"mounted":"unmounted",c={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},v.useReducer((a,b)=>c[a][b]??a,b));return v.useEffect(()=>{let a=bP(f.current);h.current="mounted"===i?a:"none"},[i]),bm(()=>{let b=f.current,c=g.current;if(c!==a){let d=h.current,e=bP(b);a?j("MOUNT"):"none"===e||b?.display==="none"?j("UNMOUNT"):c&&d!==e?j("ANIMATION_OUT"):j("UNMOUNT"),g.current=a}},[a,j]),bm(()=>{if(d){let a,b=d.ownerDocument.defaultView??window,c=c=>{let e=bP(f.current).includes(CSS.escape(c.animationName));if(c.target===d&&e&&(j("ANIMATION_END"),!g.current)){let c=d.style.animationFillMode;d.style.animationFillMode="forwards",a=b.setTimeout(()=>{"forwards"===d.style.animationFillMode&&(d.style.animationFillMode=c)})}},e=a=>{a.target===d&&(h.current=bP(f.current))};return d.addEventListener("animationstart",e),d.addEventListener("animationcancel",c),d.addEventListener("animationend",c),()=>{b.clearTimeout(a),d.removeEventListener("animationstart",e),d.removeEventListener("animationcancel",c),d.removeEventListener("animationend",c)}}j("ANIMATION_END")},[d,j]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:v.useCallback(a=>{f.current=a?getComputedStyle(a):null,e(a)},[])}}(e),h="function"==typeof f?f({present:g.isPresent}):v.Children.only(f),i=bl(g.ref,(b=h,(d=(c=Object.getOwnPropertyDescriptor(b.props,"ref")?.get)&&"isReactWarning"in c&&c.isReactWarning)?b.ref:(d=(c=Object.getOwnPropertyDescriptor(b,"ref")?.get)&&"isReactWarning"in c&&c.isReactWarning)?b.props.ref:b.props.ref||b.ref));return"function"==typeof f||g.isPresent?v.cloneElement(h,{ref:i}):null};function bP(a){return a?.animationName||"none"}bO.displayName="Presence";var bQ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{let c=bs(`Primitive.${b}`),d=v.forwardRef((a,d)=>{let{asChild:e,...f}=a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,u.jsx)(e?c:b,{...f,ref:d})});return d.displayName=`Primitive.${b}`,{...a,[b]:d}},{}),bR=0;function bS(){let a=document.createElement("span");return a.setAttribute("data-radix-focus-guard",""),a.tabIndex=0,a.style.outline="none",a.style.opacity="0",a.style.position="fixed",a.style.pointerEvents="none",a}var bT=function(){return(bT=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function bU(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}var bV=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),bW="width-before-scroll-bar";function bX(a,b){return"function"==typeof a?a(b):a&&(a.current=b),a}var bY="undefined"!=typeof window?v.useLayoutEffect:v.useEffect,bZ=new WeakMap,b$=(void 0===l&&(l={}),(void 0===m&&(m=function(a){return a}),n=[],o=!1,p={read:function(){if(o)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:null},useMedium:function(a){var b=m(a,o);return n.push(b),function(){n=n.filter(function(a){return a!==b})}},assignSyncMedium:function(a){for(o=!0;n.length;){var b=n;n=[],b.forEach(a)}n={push:function(b){return a(b)},filter:function(){return n}}},assignMedium:function(a){o=!0;var b=[];if(n.length){var c=n;n=[],c.forEach(a),b=n}var d=function(){var c=b;b=[],c.forEach(a)},e=function(){return Promise.resolve().then(d)};e(),n={push:function(a){b.push(a),e()},filter:function(a){return b=b.filter(a),n}}}}).options=bT({async:!0,ssr:!1},l),p),b_=function(){},b0=v.forwardRef(function(a,b){var c,d,e,f,g=v.useRef(null),h=v.useState({onScrollCapture:b_,onWheelCapture:b_,onTouchMoveCapture:b_}),i=h[0],j=h[1],k=a.forwardProps,l=a.children,m=a.className,n=a.removeScrollBar,o=a.enabled,p=a.shards,q=a.sideCar,r=a.noRelative,s=a.noIsolation,t=a.inert,u=a.allowPinchZoom,w=a.as,x=a.gapMode,y=bU(a,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),z=(c=[g,b],d=function(a){return c.forEach(function(b){return bX(b,a)})},(e=(0,v.useState)(function(){return{value:null,callback:d,facade:{get current(){return e.value},set current(value){var a=e.value;a!==value&&(e.value=value,e.callback(value,a))}}}})[0]).callback=d,f=e.facade,bY(function(){var a=bZ.get(f);if(a){var b=new Set(a),d=new Set(c),e=f.current;b.forEach(function(a){d.has(a)||bX(a,null)}),d.forEach(function(a){b.has(a)||bX(a,e)})}bZ.set(f,c)},[c]),f),A=bT(bT({},y),i);return v.createElement(v.Fragment,null,o&&v.createElement(q,{sideCar:b$,removeScrollBar:n,shards:p,noRelative:r,noIsolation:s,inert:t,setCallbacks:j,allowPinchZoom:!!u,lockRef:g,gapMode:x}),k?v.cloneElement(v.Children.only(l),bT(bT({},A),{ref:z})):v.createElement(void 0===w?"div":w,bT({},A,{className:m,ref:z}),l))});b0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},b0.classNames={fullWidth:bW,zeroRight:bV};var b1=function(a){var b=a.sideCar,c=bU(a,["sideCar"]);if(!b)throw Error("Sidecar: please provide `sideCar` property to import the right car");var d=b.read();if(!d)throw Error("Sidecar medium not found");return v.createElement(d,bT({},c))};b1.isSideCarExport=!0;var b2=function(){var a=0,b=null;return{add:function(d){if(0==a&&(b=function(){if(!document)return null;var a=document.createElement("style");a.type="text/css";var b=t||c.nc;return b&&a.setAttribute("nonce",b),a}())){var e,f;(e=b).styleSheet?e.styleSheet.cssText=d:e.appendChild(document.createTextNode(d)),f=b,(document.head||document.getElementsByTagName("head")[0]).appendChild(f)}a++},remove:function(){--a||!b||(b.parentNode&&b.parentNode.removeChild(b),b=null)}}},b3=function(){var a=b2();return function(b,c){v.useEffect(function(){return a.add(b),function(){a.remove()}},[b&&c])}},b4=function(){var a=b3();return function(b){return a(b.styles,b.dynamic),null}},b5={left:0,top:0,right:0,gap:0},b6=function(a){return parseInt(a||"",10)||0},b7=function(a){var b=window.getComputedStyle(document.body),c=b["padding"===a?"paddingLeft":"marginLeft"],d=b["padding"===a?"paddingTop":"marginTop"],e=b["padding"===a?"paddingRight":"marginRight"];return[b6(c),b6(d),b6(e)]},b8=function(a){if(void 0===a&&(a="margin"),"undefined"==typeof window)return b5;var b=b7(a),c=document.documentElement.clientWidth,d=window.innerWidth;return{left:b[0],top:b[1],right:b[2],gap:Math.max(0,d-c+b[2]-b[0])}},b9=b4(),ca="data-scroll-locked",cb=function(a,b,c,d){var e=a.left,f=a.top,g=a.right,h=a.gap;return void 0===c&&(c="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(d,";\n   padding-right: ").concat(h,"px ").concat(d,";\n  }\n  body[").concat(ca,"] {\n    overflow: hidden ").concat(d,";\n    overscroll-behavior: contain;\n    ").concat([b&&"position: relative ".concat(d,";"),"margin"===c&&"\n    padding-left: ".concat(e,"px;\n    padding-top: ").concat(f,"px;\n    padding-right: ").concat(g,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(h,"px ").concat(d,";\n    "),"padding"===c&&"padding-right: ".concat(h,"px ").concat(d,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(bV," {\n    right: ").concat(h,"px ").concat(d,";\n  }\n  \n  .").concat(bW," {\n    margin-right: ").concat(h,"px ").concat(d,";\n  }\n  \n  .").concat(bV," .").concat(bV," {\n    right: 0 ").concat(d,";\n  }\n  \n  .").concat(bW," .").concat(bW," {\n    margin-right: 0 ").concat(d,";\n  }\n  \n  body[").concat(ca,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(h,"px;\n  }\n")},cc=function(){var a=parseInt(document.body.getAttribute(ca)||"0",10);return isFinite(a)?a:0},cd=function(){v.useEffect(function(){return document.body.setAttribute(ca,(cc()+1).toString()),function(){var a=cc()-1;a<=0?document.body.removeAttribute(ca):document.body.setAttribute(ca,a.toString())}},[])},ce=function(a){var b=a.noRelative,c=a.noImportant,d=a.gapMode,e=void 0===d?"margin":d;cd();var f=v.useMemo(function(){return b8(e)},[e]);return v.createElement(b9,{styles:cb(f,!b,e,c?"":"!important")})},cf=!1;if("undefined"!=typeof window)try{var cg=Object.defineProperty({},"passive",{get:function(){return cf=!0,!0}});window.addEventListener("test",cg,cg),window.removeEventListener("test",cg,cg)}catch(a){cf=!1}var ch=!!cf&&{passive:!1},ci=function(a,b){if(!(a instanceof Element))return!1;var c=window.getComputedStyle(a);return"hidden"!==c[b]&&(c.overflowY!==c.overflowX||"TEXTAREA"===a.tagName||"visible"!==c[b])},cj=function(a,b){var c=b.ownerDocument,d=b;do{if("undefined"!=typeof ShadowRoot&&d instanceof ShadowRoot&&(d=d.host),ck(a,d)){var e=cl(a,d);if(e[1]>e[2])return!0}d=d.parentNode}while(d&&d!==c.body);return!1},ck=function(a,b){return"v"===a?ci(b,"overflowY"):ci(b,"overflowX")},cl=function(a,b){return"v"===a?[b.scrollTop,b.scrollHeight,b.clientHeight]:[b.scrollLeft,b.scrollWidth,b.clientWidth]},cm=function(a,b,c,d,e){var f,g=(f=window.getComputedStyle(b).direction,"h"===a&&"rtl"===f?-1:1),h=g*d,i=c.target,j=b.contains(i),k=!1,l=h>0,m=0,n=0;do{if(!i)break;var o=cl(a,i),p=o[0],q=o[1]-o[2]-g*p;(p||q)&&ck(a,i)&&(m+=q,n+=p);var r=i.parentNode;i=r&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.host:r}while(!j&&i!==document.body||j&&(b.contains(i)||b===i));return l&&(e&&1>Math.abs(m)||!e&&h>m)?k=!0:!l&&(e&&1>Math.abs(n)||!e&&-h>n)&&(k=!0),k},cn=function(a){return"changedTouches"in a?[a.changedTouches[0].clientX,a.changedTouches[0].clientY]:[0,0]},co=function(a){return[a.deltaX,a.deltaY]},cp=function(a){return a&&"current"in a?a.current:a},cq=0,cr=[];let cs=(q=function(a){var b=v.useRef([]),c=v.useRef([0,0]),d=v.useRef(),e=v.useState(cq++)[0],f=v.useState(b4)[0],g=v.useRef(a);v.useEffect(function(){g.current=a},[a]),v.useEffect(function(){if(a.inert){document.body.classList.add("block-interactivity-".concat(e));var b=(function(a,b,c){if(c||2==arguments.length)for(var d,e=0,f=b.length;e<f;e++)!d&&e in b||(d||(d=Array.prototype.slice.call(b,0,e)),d[e]=b[e]);return a.concat(d||Array.prototype.slice.call(b))})([a.lockRef.current],(a.shards||[]).map(cp),!0).filter(Boolean);return b.forEach(function(a){return a.classList.add("allow-interactivity-".concat(e))}),function(){document.body.classList.remove("block-interactivity-".concat(e)),b.forEach(function(a){return a.classList.remove("allow-interactivity-".concat(e))})}}},[a.inert,a.lockRef.current,a.shards]);var h=v.useCallback(function(a,b){if("touches"in a&&2===a.touches.length||"wheel"===a.type&&a.ctrlKey)return!g.current.allowPinchZoom;var e,f=cn(a),h=c.current,i="deltaX"in a?a.deltaX:h[0]-f[0],j="deltaY"in a?a.deltaY:h[1]-f[1],k=a.target,l=Math.abs(i)>Math.abs(j)?"h":"v";if("touches"in a&&"h"===l&&"range"===k.type)return!1;var m=window.getSelection(),n=m&&m.anchorNode;if(n&&(n===k||n.contains(k)))return!1;var o=cj(l,k);if(!o)return!0;if(o?e=l:(e="v"===l?"h":"v",o=cj(l,k)),!o)return!1;if(!d.current&&"changedTouches"in a&&(i||j)&&(d.current=e),!e)return!0;var p=d.current||e;return cm(p,b,a,"h"===p?i:j,!0)},[]),i=v.useCallback(function(a){if(cr.length&&cr[cr.length-1]===f){var c="deltaY"in a?co(a):cn(a),d=b.current.filter(function(b){var d;return b.name===a.type&&(b.target===a.target||a.target===b.shadowParent)&&(d=b.delta,d[0]===c[0]&&d[1]===c[1])})[0];if(d&&d.should){a.cancelable&&a.preventDefault();return}if(!d){var e=(g.current.shards||[]).map(cp).filter(Boolean).filter(function(b){return b.contains(a.target)});(e.length>0?h(a,e[0]):!g.current.noIsolation)&&a.cancelable&&a.preventDefault()}}},[]),j=v.useCallback(function(a,c,d,e){var f={name:a,delta:c,target:d,should:e,shadowParent:function(a){for(var b=null;null!==a;)a instanceof ShadowRoot&&(b=a.host,a=a.host),a=a.parentNode;return b}(d)};b.current.push(f),setTimeout(function(){b.current=b.current.filter(function(a){return a!==f})},1)},[]),k=v.useCallback(function(a){c.current=cn(a),d.current=void 0},[]),l=v.useCallback(function(b){j(b.type,co(b),b.target,h(b,a.lockRef.current))},[]),m=v.useCallback(function(b){j(b.type,cn(b),b.target,h(b,a.lockRef.current))},[]);v.useEffect(function(){return cr.push(f),a.setCallbacks({onScrollCapture:l,onWheelCapture:l,onTouchMoveCapture:m}),document.addEventListener("wheel",i,ch),document.addEventListener("touchmove",i,ch),document.addEventListener("touchstart",k,ch),function(){cr=cr.filter(function(a){return a!==f}),document.removeEventListener("wheel",i,ch),document.removeEventListener("touchmove",i,ch),document.removeEventListener("touchstart",k,ch)}},[]);var n=a.removeScrollBar,o=a.inert;return v.createElement(v.Fragment,null,o?v.createElement(f,{styles:"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")}):null,n?v.createElement(ce,{noRelative:a.noRelative,gapMode:a.gapMode}):null)},b$.useMedium(q),b1);var ct=v.forwardRef(function(a,b){return v.createElement(b0,bT({},a,{ref:b,sideCar:cs}))});ct.classNames=b0.classNames;var cu=new WeakMap,cv=new WeakMap,cw={},cx=0,cy=function(a){return a&&(a.host||cy(a.parentNode))},cz=function(a,b,c,d){var e=(Array.isArray(a)?a:[a]).map(function(a){if(b.contains(a))return a;var c=cy(a);return c&&b.contains(c)?c:(console.error("aria-hidden",a,"in not contained inside",b,". Doing nothing"),null)}).filter(function(a){return!!a});cw[c]||(cw[c]=new WeakMap);var f=cw[c],g=[],h=new Set,i=new Set(e),j=function(a){!a||h.has(a)||(h.add(a),j(a.parentNode))};e.forEach(j);var k=function(a){!a||i.has(a)||Array.prototype.forEach.call(a.children,function(a){if(h.has(a))k(a);else try{var b=a.getAttribute(d),e=null!==b&&"false"!==b,i=(cu.get(a)||0)+1,j=(f.get(a)||0)+1;cu.set(a,i),f.set(a,j),g.push(a),1===i&&e&&cv.set(a,!0),1===j&&a.setAttribute(c,"true"),e||a.setAttribute(d,"true")}catch(b){console.error("aria-hidden: cannot operate on ",a,b)}})};return k(b),h.clear(),cx++,function(){g.forEach(function(a){var b=cu.get(a)-1,e=f.get(a)-1;cu.set(a,b),f.set(a,e),b||(cv.has(a)||a.removeAttribute(d),cv.delete(a)),e||a.removeAttribute(c)}),--cx||(cu=new WeakMap,cu=new WeakMap,cv=new WeakMap,cw={})}},cA=function(a,b,c){void 0===c&&(c="data-aria-hidden");var d=Array.from(Array.isArray(a)?a:[a]),e=b||("undefined"==typeof document?null:(Array.isArray(a)?a[0]:a).ownerDocument.body);return e?(d.push.apply(d,Array.from(e.querySelectorAll("[aria-live], script"))),cz(d,e,c,"aria-hidden")):function(){return null}},cB="Dialog",[cC,cD]=function(a,b=[]){let c=[],d=()=>{let b=c.map(a=>v.createContext(a));return function(c){let d=c?.[a]||b;return v.useMemo(()=>({[`__scope${a}`]:{...c,[a]:d}}),[c,d])}};return d.scopeName=a,[function(b,d){let e=v.createContext(d),f=c.length;c=[...c,d];let g=b=>{let{scope:c,children:d,...g}=b,h=c?.[a]?.[f]||e,i=v.useMemo(()=>g,Object.values(g));return(0,u.jsx)(h.Provider,{value:i,children:d})};return g.displayName=b+"Provider",[g,function(c,g){let h=g?.[a]?.[f]||e,i=v.useContext(h);if(i)return i;if(void 0!==d)return d;throw Error(`\`${c}\` must be used within \`${b}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let c=()=>{let c=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let d=c.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return v.useMemo(()=>({[`__scope${b.scopeName}`]:d}),[d])}};return c.scopeName=b.scopeName,c}(d,...b)]}(cB),[cE,cF]=cC(cB),cG=a=>{let{__scopeDialog:b,children:c,open:d,defaultOpen:e,onOpenChange:f,modal:g=!0}=a,h=v.useRef(null),i=v.useRef(null),[j,k]=function({prop:a,defaultProp:b,onChange:c=()=>{},caller:d}){let[e,f,g]=function({defaultProp:a,onChange:b}){let[c,d]=v.useState(a),e=v.useRef(c),f=v.useRef(b);return bq(()=>{f.current=b},[b]),v.useEffect(()=>{e.current!==c&&(f.current?.(c),e.current=c)},[c,e]),[c,d,f]}({defaultProp:b,onChange:c}),h=void 0!==a,i=h?a:e;{let b=v.useRef(void 0!==a);v.useEffect(()=>{let a=b.current;if(a!==h){let b=h?"controlled":"uncontrolled";console.warn(`${d} is changing from ${a?"controlled":"uncontrolled"} to ${b}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}b.current=h},[h,d])}return[i,v.useCallback(b=>{if(h){let c="function"==typeof b?b(a):b;c!==a&&g.current?.(c)}else f(b)},[h,a,f,g])]}({prop:d,defaultProp:e??!1,onChange:f,caller:cB});return(0,u.jsx)(cE,{scope:b,triggerRef:h,contentRef:i,contentId:bp(),titleId:bp(),descriptionId:bp(),open:j,onOpenChange:k,onOpenToggle:v.useCallback(()=>k(a=>!a),[k]),modal:g,children:c})};cG.displayName=cB;var cH="DialogTrigger";v.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=cF(cH,c),f=bl(b,e.triggerRef);return(0,u.jsx)(bQ.button,{type:"button","aria-haspopup":"dialog","aria-expanded":e.open,"aria-controls":e.contentId,"data-state":cY(e.open),...d,ref:f,onClick:bi(a.onClick,e.onOpenToggle)})}).displayName=cH;var cI="DialogPortal",[cJ,cK]=cC(cI,{forceMount:void 0}),cL=a=>{let{__scopeDialog:b,forceMount:c,children:d,container:e}=a,f=cF(cI,b);return(0,u.jsx)(cJ,{scope:b,forceMount:c,children:v.Children.map(d,a=>(0,u.jsx)(bO,{present:c||f.open,children:(0,u.jsx)(bN,{asChild:!0,container:e,children:a})}))})};cL.displayName=cI;var cM="DialogOverlay",cN=v.forwardRef((a,b)=>{let c=cK(cM,a.__scopeDialog),{forceMount:d=c.forceMount,...e}=a,f=cF(cM,a.__scopeDialog);return f.modal?(0,u.jsx)(bO,{present:d||f.open,children:(0,u.jsx)(cP,{...e,ref:b})}):null});cN.displayName=cM;var cO=bs("DialogOverlay.RemoveScroll"),cP=v.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=cF(cM,c);return(0,u.jsx)(ct,{as:cO,allowPinchZoom:!0,shards:[e.contentRef],children:(0,u.jsx)(bQ.div,{"data-state":cY(e.open),...d,ref:b,style:{pointerEvents:"auto",...d.style}})})}),cQ="DialogContent",cR=v.forwardRef((a,b)=>{let c=cK(cQ,a.__scopeDialog),{forceMount:d=c.forceMount,...e}=a,f=cF(cQ,a.__scopeDialog);return(0,u.jsx)(bO,{present:d||f.open,children:f.modal?(0,u.jsx)(cS,{...e,ref:b}):(0,u.jsx)(cT,{...e,ref:b})})});cR.displayName=cQ;var cS=v.forwardRef((a,b)=>{let c=cF(cQ,a.__scopeDialog),d=v.useRef(null),e=bl(b,c.contentRef,d);return v.useEffect(()=>{let a=d.current;if(a)return cA(a)},[]),(0,u.jsx)(cU,{...a,ref:e,trapFocus:c.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:bi(a.onCloseAutoFocus,a=>{a.preventDefault(),c.triggerRef.current?.focus()}),onPointerDownOutside:bi(a.onPointerDownOutside,a=>{let b=a.detail.originalEvent,c=0===b.button&&!0===b.ctrlKey;(2===b.button||c)&&a.preventDefault()}),onFocusOutside:bi(a.onFocusOutside,a=>a.preventDefault())})}),cT=v.forwardRef((a,b)=>{let c=cF(cQ,a.__scopeDialog),d=v.useRef(!1),e=v.useRef(!1);return(0,u.jsx)(cU,{...a,ref:b,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:b=>{a.onCloseAutoFocus?.(b),b.defaultPrevented||(d.current||c.triggerRef.current?.focus(),b.preventDefault()),d.current=!1,e.current=!1},onInteractOutside:b=>{a.onInteractOutside?.(b),b.defaultPrevented||(d.current=!0,"pointerdown"===b.detail.originalEvent.type&&(e.current=!0));let f=b.target;c.triggerRef.current?.contains(f)&&b.preventDefault(),"focusin"===b.detail.originalEvent.type&&e.current&&b.preventDefault()}})}),cU=v.forwardRef((a,b)=>{let{__scopeDialog:c,trapFocus:d,onOpenAutoFocus:e,onCloseAutoFocus:f,...g}=a,h=cF(cQ,c),i=v.useRef(null),j=bl(b,i);return v.useEffect(()=>{let a=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",a[0]??bS()),document.body.insertAdjacentElement("beforeend",a[1]??bS()),bR++,()=>{1===bR&&document.querySelectorAll("[data-radix-focus-guard]").forEach(a=>a.remove()),bR--}},[]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(bG,{asChild:!0,loop:!0,trapped:d,onMountAutoFocus:e,onUnmountAutoFocus:f,children:(0,u.jsx)(bz,{role:"dialog",id:h.contentId,"aria-describedby":h.descriptionId,"aria-labelledby":h.titleId,"data-state":cY(h.open),...g,ref:j,onDismiss:()=>h.onOpenChange(!1)})}),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c0,{titleId:h.titleId}),(0,u.jsx)(c1,{contentRef:i,descriptionId:h.descriptionId})]})]})}),cV="DialogTitle";v.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=cF(cV,c);return(0,u.jsx)(bQ.h2,{id:e.titleId,...d,ref:b})}).displayName=cV;var cW="DialogDescription";v.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=cF(cW,c);return(0,u.jsx)(bQ.p,{id:e.descriptionId,...d,ref:b})}).displayName=cW;var cX="DialogClose";function cY(a){return a?"open":"closed"}v.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=cF(cX,c);return(0,u.jsx)(bQ.button,{type:"button",...d,ref:b,onClick:bi(a.onClick,()=>e.onOpenChange(!1))})}).displayName=cX;var cZ="DialogTitleWarning",[c$,c_]=(r={contentName:cQ,titleName:cV,docsSlug:"dialog"},i=v.createContext(r),(j=a=>{let{children:b,...c}=a,d=v.useMemo(()=>c,Object.values(c));return(0,u.jsx)(i.Provider,{value:d,children:b})}).displayName=cZ+"Provider",[j,function(a){let b=v.useContext(i);if(b)return b;if(void 0!==r)return r;throw Error(`\`${a}\` must be used within \`${cZ}\``)}]),c0=({titleId:a})=>{let b=c_(cZ),c=`\`${b.contentName}\` requires a \`${b.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${b.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${b.docsSlug}`;return v.useEffect(()=>{a&&(document.getElementById(a)||console.error(c))},[c,a]),null},c1=({contentRef:a,descriptionId:b})=>{let c=c_("DialogDescriptionWarning"),d=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${c.contentName}}.`;return v.useEffect(()=>{let c=a.current?.getAttribute("aria-describedby");b&&c&&(document.getElementById(b)||console.warn(d))},[d,a,b]),null},c2=Symbol.for("react.lazy"),c3=w[" use ".trim().toString()];function c4(a){var b;return null!=a&&"object"==typeof a&&"$$typeof"in a&&a.$$typeof===c2&&"_payload"in a&&"object"==typeof(b=a._payload)&&null!==b&&"then"in b}var c5=Symbol("radix.slottable");function c6(a){return v.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===c5}var c7=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{var c,d;let e,f,g,h=(d=c=`Primitive.${b}`,(e=v.forwardRef((a,b)=>{let{children:c,...d}=a;if(c4(c)&&"function"==typeof c3&&(c=c3(c._payload)),v.isValidElement(c)){var e;let a,f,g=(e=c,(f=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(f=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref),h=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==v.Fragment&&(h.ref=b?bk(b,g):g),v.cloneElement(c,h)}return v.Children.count(c)>1?v.Children.only(null):null})).displayName=`${d}.SlotClone`,f=e,(g=v.forwardRef((a,b)=>{let{children:c,...d}=a;c4(c)&&"function"==typeof c3&&(c=c3(c._payload));let e=v.Children.toArray(c),g=e.find(c6);if(g){let a=g.props.children,c=e.map(b=>b!==g?b:v.Children.count(a)>1?v.Children.only(null):v.isValidElement(a)?a.props.children:null);return(0,u.jsx)(f,{...d,ref:b,children:v.isValidElement(a)?v.cloneElement(a,void 0,c):null})}return(0,u.jsx)(f,{...d,ref:b,children:c})})).displayName=`${c}.Slot`,g),i=v.forwardRef((a,c)=>{let{asChild:d,...e}=a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,u.jsx)(d?h:b,{...e,ref:c})});return i.displayName=`Primitive.${b}`,{...a,[b]:i}},{}),c8='[cmdk-group=""]',c9='[cmdk-group-items=""]',da='[cmdk-item=""]',db=`${da}:not([aria-disabled="true"])`,dc="cmdk-item-select",dd="data-value",de=(a,b,c)=>{var d;return d=a,function a(b,c,d,e,f,g,h){if(g===c.length)return f===b.length?1:.99;var i=`${f},${g}`;if(void 0!==h[i])return h[i];for(var j,k,l,m,n=e.charAt(g),o=d.indexOf(n,f),p=0;o>=0;)(j=a(b,c,d,e,o+1,g+1,h))>p&&(o===f?j*=1:bd.test(b.charAt(o-1))?(j*=.8,(l=b.slice(f,o-1).match(be))&&f>0&&(j*=Math.pow(.999,l.length))):bf.test(b.charAt(o-1))?(j*=.9,(m=b.slice(f,o-1).match(bg))&&f>0&&(j*=Math.pow(.999,m.length))):(j*=.17,f>0&&(j*=Math.pow(.999,o-f))),b.charAt(o)!==c.charAt(g)&&(j*=.9999)),(j<.1&&d.charAt(o-1)===e.charAt(g+1)||e.charAt(g+1)===e.charAt(g)&&d.charAt(o-1)!==e.charAt(g))&&.1*(k=a(b,c,d,e,o+1,g+2,h))>j&&(j=.1*k),j>p&&(p=j),o=d.indexOf(n,o+1);return h[i]=p,p}(d=c&&c.length>0?`${d+" "+c.join(" ")}`:d,b,bh(d),bh(b),0,0,{})},df=v.createContext(void 0),dg=v.createContext(void 0),dh=v.createContext(void 0),di=v.forwardRef((a,b)=>{let c=dt(()=>{var b,c;return{search:"",value:null!=(c=null!=(b=a.value)?b:a.defaultValue)?c:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),d=dt(()=>new Set),e=dt(()=>new Map),f=dt(()=>new Map),g=dt(()=>new Set),h=dr(a),{label:i,children:j,value:k,onValueChange:l,filter:m,shouldFilter:n,loop:o,disablePointerSelection:p=!1,vimBindings:q=!0,...r}=a,s=bp(),t=bp(),u=bp(),w=v.useRef(null),x=dw();ds(()=>{if(void 0!==k){let a=k.trim();c.current.value=a,y.emit()}},[k]),ds(()=>{x(6,E)},[]);let y=v.useMemo(()=>({subscribe:a=>(g.current.add(a),()=>g.current.delete(a)),snapshot:()=>c.current,setState:(a,b,d)=>{var e,f,g,i;if(!Object.is(c.current[a],b)){if(c.current[a]=b,"search"===a)D(),B(),x(1,C);else if("value"===a){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let a=document.getElementById(u);a?a.focus():null==(e=document.getElementById(s))||e.focus()}if(x(7,()=>{var a;c.current.selectedItemId=null==(a=F())?void 0:a.id,y.emit()}),d||x(5,E),(null==(f=h.current)?void 0:f.value)!==void 0){null==(i=(g=h.current).onValueChange)||i.call(g,null!=b?b:"");return}}y.emit()}},emit:()=>{g.current.forEach(a=>a())}}),[]),z=v.useMemo(()=>({value:(a,b,d)=>{var e;b!==(null==(e=f.current.get(a))?void 0:e.value)&&(f.current.set(a,{value:b,keywords:d}),c.current.filtered.items.set(a,A(b,d)),x(2,()=>{B(),y.emit()}))},item:(a,b)=>(d.current.add(a),b&&(e.current.has(b)?e.current.get(b).add(a):e.current.set(b,new Set([a]))),x(3,()=>{D(),B(),c.current.value||C(),y.emit()}),()=>{f.current.delete(a),d.current.delete(a),c.current.filtered.items.delete(a);let b=F();x(4,()=>{D(),(null==b?void 0:b.getAttribute("id"))===a&&C(),y.emit()})}),group:a=>(e.current.has(a)||e.current.set(a,new Set),()=>{f.current.delete(a),e.current.delete(a)}),filter:()=>h.current.shouldFilter,label:i||a["aria-label"],getDisablePointerSelection:()=>h.current.disablePointerSelection,listId:s,inputId:u,labelId:t,listInnerRef:w}),[]);function A(a,b){var d,e;let f=null!=(e=null==(d=h.current)?void 0:d.filter)?e:de;return a?f(a,c.current.search,b):0}function B(){if(!c.current.search||!1===h.current.shouldFilter)return;let a=c.current.filtered.items,b=[];c.current.filtered.groups.forEach(c=>{let d=e.current.get(c),f=0;d.forEach(b=>{f=Math.max(a.get(b),f)}),b.push([c,f])});let d=w.current;G().sort((b,c)=>{var d,e;let f=b.getAttribute("id"),g=c.getAttribute("id");return(null!=(d=a.get(g))?d:0)-(null!=(e=a.get(f))?e:0)}).forEach(a=>{let b=a.closest(c9);b?b.appendChild(a.parentElement===b?a:a.closest(`${c9} > *`)):d.appendChild(a.parentElement===d?a:a.closest(`${c9} > *`))}),b.sort((a,b)=>b[1]-a[1]).forEach(a=>{var b;let c=null==(b=w.current)?void 0:b.querySelector(`${c8}[${dd}="${encodeURIComponent(a[0])}"]`);null==c||c.parentElement.appendChild(c)})}function C(){let a=G().find(a=>"true"!==a.getAttribute("aria-disabled")),b=null==a?void 0:a.getAttribute(dd);y.setState("value",b||void 0)}function D(){var a,b,g,i;if(!c.current.search||!1===h.current.shouldFilter){c.current.filtered.count=d.current.size;return}c.current.filtered.groups=new Set;let j=0;for(let e of d.current){let d=A(null!=(b=null==(a=f.current.get(e))?void 0:a.value)?b:"",null!=(i=null==(g=f.current.get(e))?void 0:g.keywords)?i:[]);c.current.filtered.items.set(e,d),d>0&&j++}for(let[a,b]of e.current)for(let d of b)if(c.current.filtered.items.get(d)>0){c.current.filtered.groups.add(a);break}c.current.filtered.count=j}function E(){var a,b,c;let d=F();d&&((null==(a=d.parentElement)?void 0:a.firstChild)===d&&(null==(c=null==(b=d.closest(c8))?void 0:b.querySelector('[cmdk-group-heading=""]'))||c.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function F(){var a;return null==(a=w.current)?void 0:a.querySelector(`${da}[aria-selected="true"]`)}function G(){var a;return Array.from((null==(a=w.current)?void 0:a.querySelectorAll(db))||[])}function H(a){let b=G()[a];b&&y.setState("value",b.getAttribute(dd))}function I(a){var b;let c=F(),d=G(),e=d.findIndex(a=>a===c),f=d[e+a];null!=(b=h.current)&&b.loop&&(f=e+a<0?d[d.length-1]:e+a===d.length?d[0]:d[e+a]),f&&y.setState("value",f.getAttribute(dd))}function J(a){let b=F(),c=null==b?void 0:b.closest(c8),d;for(;c&&!d;)d=null==(c=a>0?function(a,b){let c=a.nextElementSibling;for(;c;){if(c.matches(b))return c;c=c.nextElementSibling}}(c,c8):function(a,b){let c=a.previousElementSibling;for(;c;){if(c.matches(b))return c;c=c.previousElementSibling}}(c,c8))?void 0:c.querySelector(db);d?y.setState("value",d.getAttribute(dd)):I(a)}let K=()=>H(G().length-1),L=a=>{a.preventDefault(),a.metaKey?K():a.altKey?J(1):I(1)},M=a=>{a.preventDefault(),a.metaKey?H(0):a.altKey?J(-1):I(-1)};return v.createElement(c7.div,{ref:b,tabIndex:-1,...r,"cmdk-root":"",onKeyDown:a=>{var b;null==(b=r.onKeyDown)||b.call(r,a);let c=a.nativeEvent.isComposing||229===a.keyCode;if(!(a.defaultPrevented||c))switch(a.key){case"n":case"j":q&&a.ctrlKey&&L(a);break;case"ArrowDown":L(a);break;case"p":case"k":q&&a.ctrlKey&&M(a);break;case"ArrowUp":M(a);break;case"Home":a.preventDefault(),H(0);break;case"End":a.preventDefault(),K();break;case"Enter":{a.preventDefault();let b=F();if(b){let a=new Event(dc);b.dispatchEvent(a)}}}}},v.createElement("label",{"cmdk-label":"",htmlFor:z.inputId,id:z.labelId,style:dy},i),dx(a,a=>v.createElement(dg.Provider,{value:y},v.createElement(df.Provider,{value:z},a))))}),dj=v.forwardRef((a,b)=>{var c,d;let e=bp(),f=v.useRef(null),g=v.useContext(dh),h=v.useContext(df),i=dr(a),j=null!=(d=null==(c=i.current)?void 0:c.forceMount)?d:null==g?void 0:g.forceMount;ds(()=>{if(!j)return h.item(e,null==g?void 0:g.id)},[j]);let k=dv(e,f,[a.value,a.children,f],a.keywords),l=v.useContext(dg),m=du(a=>a.value&&a.value===k.current),n=du(a=>!!j||!1===h.filter()||!a.search||a.filtered.items.get(e)>0);function o(){var a,b;p(),null==(b=(a=i.current).onSelect)||b.call(a,k.current)}function p(){l.setState("value",k.current,!0)}if(v.useEffect(()=>{let b=f.current;if(!(!b||a.disabled))return b.addEventListener(dc,o),()=>b.removeEventListener(dc,o)},[n,a.onSelect,a.disabled]),!n)return null;let{disabled:q,value:r,onSelect:s,forceMount:t,keywords:u,...w}=a;return v.createElement(c7.div,{ref:bk(f,b),...w,id:e,"cmdk-item":"",role:"option","aria-disabled":!!q,"aria-selected":!!m,"data-disabled":!!q,"data-selected":!!m,onPointerMove:q||h.getDisablePointerSelection()?void 0:p,onClick:q?void 0:o},a.children)}),dk=v.forwardRef((a,b)=>{let{heading:c,children:d,forceMount:e,...f}=a,g=bp(),h=v.useRef(null),i=v.useRef(null),j=bp(),k=v.useContext(df),l=du(a=>!!e||!1===k.filter()||!a.search||a.filtered.groups.has(g));ds(()=>k.group(g),[]),dv(g,h,[a.value,a.heading,i]);let m=v.useMemo(()=>({id:g,forceMount:e}),[e]);return v.createElement(c7.div,{ref:bk(h,b),...f,"cmdk-group":"",role:"presentation",hidden:!l||void 0},c&&v.createElement("div",{ref:i,"cmdk-group-heading":"","aria-hidden":!0,id:j},c),dx(a,a=>v.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":c?j:void 0},v.createElement(dh.Provider,{value:m},a))))}),dl=v.forwardRef((a,b)=>{let{alwaysRender:c,...d}=a,e=v.useRef(null),f=du(a=>!a.search);return c||f?v.createElement(c7.div,{ref:bk(e,b),...d,"cmdk-separator":"",role:"separator"}):null}),dm=v.forwardRef((a,b)=>{let{onValueChange:c,...d}=a,e=null!=a.value,f=v.useContext(dg),g=du(a=>a.search),h=du(a=>a.selectedItemId),i=v.useContext(df);return v.useEffect(()=>{null!=a.value&&f.setState("search",a.value)},[a.value]),v.createElement(c7.input,{ref:b,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":i.listId,"aria-labelledby":i.labelId,"aria-activedescendant":h,id:i.inputId,type:"text",value:e?a.value:g,onChange:a=>{e||f.setState("search",a.target.value),null==c||c(a.target.value)}})}),dn=v.forwardRef((a,b)=>{let{children:c,label:d="Suggestions",...e}=a,f=v.useRef(null),g=v.useRef(null),h=du(a=>a.selectedItemId),i=v.useContext(df);return v.useEffect(()=>{if(g.current&&f.current){let a=g.current,b=f.current,c,d=new ResizeObserver(()=>{c=requestAnimationFrame(()=>{let c=a.offsetHeight;b.style.setProperty("--cmdk-list-height",c.toFixed(1)+"px")})});return d.observe(a),()=>{cancelAnimationFrame(c),d.unobserve(a)}}},[]),v.createElement(c7.div,{ref:bk(f,b),...e,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":h,"aria-label":d,id:i.listId},dx(a,a=>v.createElement("div",{ref:bk(g,i.listInnerRef),"cmdk-list-sizer":""},a)))}),dp=v.forwardRef((a,b)=>{let{open:c,onOpenChange:d,overlayClassName:e,contentClassName:f,container:g,...h}=a;return v.createElement(cG,{open:c,onOpenChange:d},v.createElement(cL,{container:g},v.createElement(cN,{"cmdk-overlay":"",className:e}),v.createElement(cR,{"aria-label":a.label,"cmdk-dialog":"",className:f},v.createElement(di,{ref:b,...h}))))}),dq=Object.assign(di,{List:dn,Item:dj,Input:dm,Group:dk,Separator:dl,Dialog:dp,Empty:v.forwardRef((a,b)=>du(a=>0===a.filtered.count)?v.createElement(c7.div,{ref:b,...a,"cmdk-empty":"",role:"presentation"}):null),Loading:v.forwardRef((a,b)=>{let{progress:c,children:d,label:e="Loading...",...f}=a;return v.createElement(c7.div,{ref:b,...f,"cmdk-loading":"",role:"progressbar","aria-valuenow":c,"aria-valuemin":0,"aria-valuemax":100,"aria-label":e},dx(a,a=>v.createElement("div",{"aria-hidden":!0},a)))})});function dr(a){let b=v.useRef(a);return ds(()=>{b.current=a}),b}var ds=v.useEffect;function dt(a){let b=v.useRef();return void 0===b.current&&(b.current=a()),b}function du(a){let b=v.useContext(dg),c=()=>a(b.snapshot());return v.useSyncExternalStore(b.subscribe,c,c)}function dv(a,b,c,d=[]){let e=v.useRef(),f=v.useContext(df);return ds(()=>{var g;let h=(()=>{var a;for(let b of c){if("string"==typeof b)return b.trim();if("object"==typeof b&&"current"in b)return b.current?null==(a=b.current.textContent)?void 0:a.trim():e.current}})(),i=d.map(a=>a.trim());f.value(a,h,i),null==(g=b.current)||g.setAttribute(dd,h),e.current=h}),e}var dw=()=>{let[a,b]=v.useState(),c=dt(()=>new Map);return ds(()=>{c.current.forEach(a=>a()),c.current=new Map},[a]),(a,d)=>{c.current.set(a,d),b({})}};function dx({asChild:a,children:b},c){let d;return a&&v.isValidElement(b)?v.cloneElement("function"==typeof(d=b.type)?d(b.props):"render"in d?d.render(b.props):b,{ref:b.ref},c(b.props.children)):c(b)}var dy={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function dz(a){let[b,c]=(0,v.useState)(!1),[d,e]=(0,v.useState)(""),[f,g]=(0,v.useState)([]),h=(0,v.useRef)(null),i=(0,v.useMemo)(()=>{let b=new Map;for(let c of a.objects)"image"===c.type&&c.asset_id&&b.set(c.asset_id,c.id);return b},[a.objects]);return(0,u.jsxs)(u.Fragment,{children:[b?(0,u.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40",onClick:()=>c(!1)}):null,(0,u.jsx)("div",{className:b?"fixed left-1/2 top-16 z-50 w-[720px] max-w-[calc(100vw-2rem)] -translate-x-1/2 rounded-xl border border-zinc-800 bg-zinc-950 shadow-2xl":"hidden",children:(0,u.jsxs)(dq,{className:"flex flex-col overflow-hidden",children:[(0,u.jsx)("div",{className:"border-b border-zinc-900 p-3",children:(0,u.jsx)(dq.Input,{ref:h,autoFocus:!0,value:d,onValueChange:e,placeholder:"Search assets",className:"w-full bg-transparent text-sm outline-none placeholder:text-zinc-600"})}),(0,u.jsxs)(dq.List,{className:"max-h-[420px] overflow-auto p-2",children:[(0,u.jsx)(dq.Empty,{className:"p-3 text-sm text-zinc-500",children:"No results."}),(b?f:[]).map(b=>{let e=i.get(b.id),f="done"===b.ai_status?b.ai_caption:b.ai_status?b.ai_status:"";return(0,u.jsxs)(dq.Item,{value:`${b.original_name} ${b.ai_caption??""}`,onSelect:()=>{c(!1),e?a.onFocusObjectId(e):a.onPlaceAssetAtViewportCenter(b.id);let f=d.trim().split(/\s+/g).filter(Boolean)[0]?.toLowerCase();!f||a.onHighlightAsset&&fetch(`/api/projects/${a.projectId}/assets/${b.id}/segments?term=${encodeURIComponent(f)}`).then(a=>a.ok?a.json():null).then(c=>{c&&a.onHighlightAsset?.({assetId:b.id,term:f,svg:c.svg??null,bboxJson:c.bboxJson??null})}).catch(()=>{})},className:"flex items-center gap-3 rounded-lg px-3 py-2 text-sm text-zinc-200 aria-selected:bg-zinc-900",children:[(0,u.jsx)("div",{className:"h-10 w-10 shrink-0 rounded bg-zinc-900 overflow-hidden",children:b.thumb_url?(0,u.jsx)("img",{src:b.thumb_url,alt:"",className:"h-full w-full object-contain"}):null}),(0,u.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,u.jsx)("div",{className:"truncate",children:b.original_name}),f?(0,u.jsx)("div",{className:"truncate text-xs text-zinc-500",children:f}):null]})]},b.id)})]}),(0,u.jsx)("div",{className:"border-t border-zinc-900 p-2 text-xs text-zinc-500"})]})})]})}function dA(a){return"undefined"==typeof document?null:(0,br.createPortal)(a.children,document.body)}function dB(a){let b,c=(0,x.useRouter)(),[d,e]=(0,v.useState)(!1),[f,g]=(0,v.useState)([]),[h,i]=(0,v.useState)(null),[j,k]=(0,v.useState)(null),[l,m]=(0,v.useState)(null),[n,o]=(0,v.useState)(null),p=(0,v.useRef)(null),q=(0,v.useRef)(null),[r,s]=(0,v.useState)(null),t=(0,v.useMemo)(()=>f.find(b=>b.id===a.currentProjectId)??null,[f,a.currentProjectId]),w=async()=>{let a=await fetch("/api/projects");a.ok&&g((await a.json()).projects??[])},y=async()=>{if(!r||"new"!==r.type)return;let a=r.name.trim();if(a){i("new");try{let b=await fetch("/api/projects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a})});if(!b.ok)return;let d=await b.json();await w(),e(!1),k(null),s(null),c.push(`/projects/${d.project.id}`)}finally{i(null)}}},z=async a=>{if(!r||"rename"!==r.type||r.project.id!==a.id)return;let b=r.name.trim();if(b){i(a.id);try{if(!(await fetch(`/api/projects/${a.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:b})})).ok)return;await w(),k(null),s(null)}finally{i(null)}}},A=async b=>{if(r&&"delete"===r.type&&r.project.id===b.id){i(b.id);try{if(!(await fetch(`/api/projects/${b.id}`,{method:"DELETE"})).ok)return;await w(),e(!1),k(null),s(null),b.id===a.currentProjectId&&c.push("/")}finally{i(null)}}};return(0,u.jsxs)("div",{className:"relative",children:[(0,u.jsxs)("button",{ref:p,onClick:()=>{e(a=>!a),k(null)},className:"text"===a.variant?"inline-flex items-center gap-2 px-2 py-1 text-sm font-medium text-zinc-200 hover:text-zinc-50":"inline-flex items-center gap-2 rounded-lg border border-zinc-800 bg-zinc-950 px-3 py-2 text-sm text-zinc-200 hover:bg-zinc-900",children:[(0,u.jsx)("span",{className:"max-w-[220px] truncate",children:t?.name??"Select project"}),(0,u.jsx)("span",{className:"text-zinc-500",children:""})]}),(0,u.jsxs)(dA,{children:[d&&l?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"fixed inset-0 z-[9998]",onMouseDown:()=>{e(!1),k(null)}}),(0,u.jsxs)("div",{className:"fixed z-[9999] w-[340px] rounded-xl border border-zinc-800 bg-zinc-950 shadow-2xl",style:{left:Math.max(8,Math.min(window.innerWidth-340-8,"center"===(b=a.align??"right")?l.left+l.width/2-170:"left"===b?l.left:l.left+l.width-340)),top:l.top+l.height+8},children:[(0,u.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-900 px-3 py-2",children:[(0,u.jsx)("div",{className:"text-xs uppercase tracking-wide text-zinc-500",children:"Projects"}),(0,u.jsx)("button",{onClick:()=>s({type:"new",name:"New project"}),disabled:"new"===h,className:"rounded-md bg-zinc-50 px-2 py-1 text-xs font-medium text-zinc-950 disabled:opacity-60",children:"New"})]}),(0,u.jsx)("div",{className:"max-h-[360px] overflow-auto",children:f.map(b=>{let d=b.id===a.currentProjectId,f=h===b.id;return(0,u.jsxs)("div",{className:`flex items-center gap-2 px-3 py-2 text-sm ${d?"bg-zinc-900/60":"hover:bg-zinc-900"}`,children:[(0,u.jsxs)("button",{disabled:f,onClick:()=>{e(!1),k(null),c.push(`/projects/${b.id}`)},className:"min-w-0 flex-1 text-left flex items-center gap-3",children:[(0,u.jsx)("div",{className:"h-12 w-12 shrink-0 overflow-hidden rounded-lg border border-white/10 bg-zinc-900",children:(0,u.jsx)("img",{src:`/files/projects/${b.id}/preview`,alt:"",className:"h-full w-full object-cover",onError:a=>{a.currentTarget.style.display="none"}})}),(0,u.jsx)("div",{className:"min-w-0 flex-1",children:(0,u.jsx)("div",{className:"truncate text-zinc-200",children:b.name})})]}),(0,u.jsx)("button",{ref:j?.id===b.id?q:null,disabled:f,onClick:a=>{a.stopPropagation(),k(a=>a?.id===b.id?null:b)},className:"rounded-md px-2 py-1 text-zinc-400 hover:bg-zinc-800 hover:text-zinc-200",title:"Project actions",children:""})]},b.id)})})]})]}):null,j&&n?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"fixed inset-0 z-[9999]",onMouseDown:()=>k(null)}),(0,u.jsxs)("div",{className:"fixed z-[10000] w-40 rounded-lg border border-zinc-800 bg-zinc-950 shadow-xl overflow-hidden",style:{left:Math.min(window.innerWidth-168,n.left+n.width-160),top:n.top+n.height+6},children:[(0,u.jsx)("button",{onClick:()=>s({type:"rename",project:j,name:j.name}),className:"block w-full px-3 py-2 text-left text-sm text-zinc-200 hover:bg-zinc-900",children:"Rename"}),(0,u.jsx)("button",{onClick:()=>s({type:"delete",project:j}),className:"block w-full px-3 py-2 text-left text-sm text-red-300 hover:bg-zinc-900",children:"Delete"})]})]}):null,r?(0,u.jsxs)("div",{className:"fixed inset-0 z-[10001]",children:[(0,u.jsx)("div",{className:"absolute inset-0 bg-black/50",onMouseDown:()=>s(null)}),(0,u.jsx)("div",{className:"absolute left-1/2 top-28 w-[420px] max-w-[calc(100vw-2rem)] -translate-x-1/2 rounded-xl border border-zinc-800 bg-zinc-950 p-4 shadow-2xl",children:"delete"===r.type?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"text-sm text-zinc-200",children:"Delete project?"}),(0,u.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:r.project.name}),(0,u.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,u.jsx)("button",{onClick:()=>s(null),className:"rounded-md border border-zinc-800 bg-zinc-950 px-3 py-2 text-sm text-zinc-200",children:"Cancel"}),(0,u.jsx)("button",{onClick:()=>A(r.project),disabled:h===r.project.id,className:"rounded-md bg-red-500 px-3 py-2 text-sm font-medium text-white disabled:opacity-60",children:"Delete"})]})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"text-sm text-zinc-200",children:"new"===r.type?"New project":"Rename project"}),(0,u.jsx)("input",{autoFocus:!0,value:r.name,onChange:a=>{let b=a.target.value;s(a=>a&&("new"===a.type||"rename"===a.type)?{...a,name:b}:a)},className:"mt-3 w-full rounded-lg border border-zinc-800 bg-zinc-950 px-3 py-2 text-sm text-zinc-200 outline-none focus:border-zinc-600",placeholder:"Project name"}),(0,u.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,u.jsx)("button",{onClick:()=>s(null),className:"rounded-md border border-zinc-800 bg-zinc-950 px-3 py-2 text-sm text-zinc-200",children:"Cancel"}),(0,u.jsx)("button",{onClick:()=>{"new"===r.type&&y(),"rename"===r.type&&z(r.project)},disabled:"new"===h||"rename"===r.type&&h===r.project.id,className:"rounded-md bg-zinc-50 px-3 py-2 text-sm font-medium text-zinc-950 disabled:opacity-60",children:"Save"})]})]})})]}):null]})]})}function dC(a){let{project:b}=a,c=(0,x.useRouter)(),[d,e]=(0,v.useState)(a.initialObjects),[f,g]=(0,v.useState)(null),[h,i]=(0,v.useState)(null),[j,k]=(0,v.useState)(null);return(0,u.jsxs)("div",{className:"h-screen w-screen bg-zinc-950 text-zinc-50 overflow-hidden",children:[(0,u.jsx)(bc,{projectId:b.id,initialAssets:a.initialAssets,initialObjects:d,initialView:a.initialView,highlightOverlay:f,onObjectsChange:e,onFocusRequest:a=>i(()=>a),onViewportCenterRequest:a=>k(()=>a)}),(0,u.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 z-40 h-14 bg-gradient-to-b from-black/50 to-transparent"}),(0,u.jsx)("div",{className:"absolute left-3 top-3 z-50",children:(0,u.jsx)(dB,{currentProjectId:b.id,variant:"text",align:"left"})}),(0,u.jsx)("div",{className:"absolute right-3 top-3 z-50",children:(0,u.jsx)("button",{onClick:()=>c.push(`/settings?projectId=${encodeURIComponent(b.id)}`),className:"rounded-md border border-zinc-800 bg-zinc-950 px-2 py-1 text-xs text-zinc-300 hover:bg-zinc-900",children:"Settings"})}),(0,u.jsx)(dz,{projectId:b.id,objects:d,onFocusObjectId:a=>h?.(a),onPlaceAssetAtViewportCenter:async a=>{let c=j?.()??{x:0,y:0},f=[...d,{id:globalThis.crypto?.randomUUID?.()??`${Date.now()}-${Math.random()}`,project_id:b.id,type:"image",asset_id:a,x:c.x,y:c.y,scale_x:1,scale_y:1,rotation:0,width:null,height:null,z_index:d.reduce((a,b)=>Math.max(a,b.z_index),0)+1,props_json:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}];e(f),await fetch(`/api/projects/${b.id}/canvas`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({objects:f})})},onHighlightAsset:a=>g(a)})]})}},14690:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,95547,23))},15104:(a,b,c)=>{"use strict";let d;c.d(b,{M:()=>l});var e=c(71254),f=c(10);let g={},h={},i={stripVersion:function(a,b){return b?a.replace("#version 300 es",""):a},ensurePrecision:function(a,b,c){let d=c?b.maxSupportedFragmentPrecision:b.maxSupportedVertexPrecision;if("precision"!==a.substring(0,9)){let e=c?b.requestedFragmentPrecision:b.requestedVertexPrecision;return"highp"===e&&"highp"!==d&&(e="mediump"),`precision ${e} float;
${a}`}return"highp"!==d&&"precision highp"===a.substring(0,15)?a.replace("precision highp","precision mediump"):a},addProgramDefines:function(a,b,c){return b?a:c?(a=a.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${a}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${a}
        `},setProgramName:function(a,{name:b="pixi-program"},c=!0){b=b.replace(/\s+/g,"-")+(c?"-fragment":"-vertex");let d=c?g:h;if(d[b]?(d[b]++,b+=`-${d[b]}`):d[b]=1,-1!==a.indexOf("#define SHADER_NAME"))return a;let e=`#define SHADER_NAME ${b}`;return`${e}
${a}`},insertVersion:function(a,b){return b?`#version 300 es
${a}`:a}},j=Object.create(null),k=class a{constructor(b){const c=-1!==(b={...a.defaultOptions,...b}).fragment.indexOf("#version 300 es"),g={stripVersion:c,ensurePrecision:{requestedFragmentPrecision:b.preferredFragmentPrecision,requestedVertexPrecision:b.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:function(){if(!d){d="mediump";let a=(0,f.W)();a&&a.getShaderPrecisionFormat&&(d=a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision?"highp":"mediump")}return d}()},setProgramName:{name:b.name},addProgramDefines:c,insertVersion:c};let h=b.fragment,j=b.vertex;Object.keys(i).forEach(a=>{let b=g[a];h=i[a](h,b,!0),j=i[a](j,b,!1)}),this.fragment=h,this.vertex=j,this.transformFeedbackVaryings=b.transformFeedbackVaryings,this._key=(0,e.X)(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,j[this._cacheKey]=null}static from(b){let c=`${b.vertex}:${b.fragment}`;return j[c]||(j[c]=new a(b),j[c]._cacheKey=c),j[c]}};k.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let l=k},15629:(a,b,c)=>{"use strict";c.d(b,{k:()=>r});var d=c(66242),e=c(45753);let f=[];async function g(a){if(!a)for(let a=0;a<f.length;a++){let b=f[a];if(b.value.test())return void await b.value.load()}}e.XO.handleByNamedList(e.Ag.Environment,f);var h=c(64974),i=c(92431),j=c(42115),k=c(71568),l=c(83401),m=c(69043),n=c(7363),o=c(57680);let p=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],q=class a extends o.A{constructor(a){super(),this.uid=(0,j.L)("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=a.type,this.name=a.name,this.config=a;const b=[...p,...this.config.runners??[]];this._addRunners(...b),this._unsafeEvalCheck()}async init(b={}){let c=!0===b.skipExtensionImports||!1===b.manageImports;for(let a in await g(c),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors),this._systemsHash)b={...this._systemsHash[a].constructor.defaultOptions,...b};b={...a.defaultOptions,...b},this._roundPixels=+!!b.roundPixels;for(let a=0;a<this.runners.init.items.length;a++)await this.runners.init.items[a].init(b);this._initOptions=b}render(a,b){let c=a;if(c instanceof h.mc&&(c={container:c},b&&((0,k.t6)(k.lj,"passing a second argument is deprecated, please use render options instead"),c.target=b.renderTexture)),c.target||(c.target=this.view.renderTarget),c.target===this.view.renderTarget&&(this._lastObjectRendered=c.container,c.clearColor??(c.clearColor=this.background.colorRgba),c.clear??(c.clear=this.background.clearBeforeRender)),c.clearColor){let a=Array.isArray(c.clearColor)&&4===c.clearColor.length;c.clearColor=a?c.clearColor:d.Q.shared.setValue(c.clearColor).toArray()}c.transform||(c.container.updateLocalTransform(),c.transform=c.container.localTransform),c.container.visible&&(c.container.enableRenderGroup(),this.runners.prerender.emit(c),this.runners.renderStart.emit(c),this.runners.render.emit(c),this.runners.renderEnd.emit(c),this.runners.postrender.emit(c))}resize(a,b,c){let d=this.view.resolution;this.view.resize(a,b,c),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),void 0!==c&&c!==d&&this.runners.resolutionChange.emit(c)}clear(a={}){a.target||(a.target=this.renderTarget.renderTarget),a.clearColor||(a.clearColor=this.background.colorRgba),a.clear??(a.clear=m.u.ALL);let{clear:b,clearColor:c,target:e}=a;d.Q.shared.setValue(c??this.background.colorRgba),this.renderTarget.clear(e,b,d.Q.shared.toArray())}get resolution(){return this.view.resolution}set resolution(a){this.view.resolution=a,this.runners.resolutionChange.emit(a)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...a){a.forEach(a=>{this.runners[a]=new n.C(a)})}_addSystems(a){let b;for(b in a){let c=a[b];this._addSystem(c.value,c.name)}}_addSystem(a,b){let c=new a(this);if(this[b])throw Error(`Whoops! The name "${b}" is already in use`);for(let a in this[b]=c,this._systemsHash[b]=c,this.runners)this.runners[a].add(c);return this}_addPipes(a,b){let c=b.reduce((a,b)=>(a[b.name]=b.value,a),{});a.forEach(a=>{let b=a.value,d=a.name,e=c[d];this.renderPipes[d]=new b(this,e?new e:null),this.runners.destroy.add(this.renderPipes[d])})}destroy(a=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(a),(!0===a||"object"==typeof a&&a.releaseGlobalResources)&&l.L.release(),Object.values(this.runners).forEach(a=>{a.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(a){return this.textureGenerator.generateTexture(a)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!(0,i.f)())throw Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};q.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let r=q},15996:(a,b,c)=>{"use strict";let d;c.d(b,{C:()=>f});var e=c(43274);async function f(){return d??(d=(async()=>{let a=e.e.get().createCanvas(1,1).getContext("webgl");if(!a)return"premultiply-alpha-on-upload";let b=await new Promise(a=>{let b=document.createElement("video");b.onloadeddata=()=>a(b),b.onerror=()=>a(null),b.autoplay=!1,b.crossOrigin="anonymous",b.preload="auto",b.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",b.load()});if(!b)return"premultiply-alpha-on-upload";let c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c);let d=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,d),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.NONE),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b);let f=new Uint8Array(4);return a.readPixels(0,0,1,1,a.RGBA,a.UNSIGNED_BYTE,f),a.deleteFramebuffer(d),a.deleteTexture(c),a.getExtension("WEBGL_lose_context")?.loseContext(),f[0]<=f[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),d}},16183:(a,b,c)=>{"use strict";c.d(b,{h:()=>g});var d=c(57680),e=c(42115),f=c(43362);class g extends d.A{constructor(a){let{data:b,size:c}=a;const{usage:d,label:f,shrinkToFit:g}=a;super(),this.uid=(0,e.L)("buffer"),this._resourceType="buffer",this._resourceId=(0,e.L)("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,b instanceof Array&&(b=new Float32Array(b)),this._data=b,c??(c=b?.byteLength);const h=!!b;this.descriptor={size:c,usage:d,mappedAtCreation:h,label:f},this.shrinkToFit=g??!0}get data(){return this._data}set data(a){this.setDataWithSize(a,a.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&f.S.STATIC)}set static(a){a?this.descriptor.usage|=f.S.STATIC:this.descriptor.usage&=~f.S.STATIC}setDataWithSize(a,b,c){if(this._updateID++,this._updateSize=b*a.BYTES_PER_ELEMENT,this._data===a){c&&this.emit("update",this);return}let d=this._data;(this._data=a,this._dataInt32=null,d&&d.length===a.length)?c&&this.emit("update",this):!this.shrinkToFit&&d&&a.byteLength<d.byteLength?c&&this.emit("update",this):(this.descriptor.size=a.byteLength,this._resourceId=(0,e.L)("resource"),this.emit("change",this))}update(a){this._updateSize=a??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}},16503:(a,b,c)=>{"use strict";c.d(b,{b:()=>f});var d=c(45753),e=c(93141);class f extends e.v{constructor(a){super(a),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(a){return globalThis.HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap||globalThis.VideoFrame&&a instanceof VideoFrame}}f.extension=d.Ag.TextureSource},19099:(a,b,c)=>{"use strict";var d=c(54839);c.o(d,"useRouter")&&c.d(b,{useRouter:function(){return d.useRouter}}),c.o(d,"useSearchParams")&&c.d(b,{useSearchParams:function(){return d.useSearchParams}})},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19748:(a,b,c)=>{"use strict";function d(a){let b={};for(let c in a)void 0!==a[c]&&(b[c]=a[c]);return b}c.d(b,{S:()=>d})},19979:(a,b,c)=>{"use strict";c.d(b,{T:()=>d});class d{constructor(a){this.resources=Object.create(null),this._dirty=!0;let b=0;for(const c in a){const d=a[c];this.setResource(d,b++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;let a=[],b=0;for(let c in this.resources)a[b++]=this.resources[c]._resourceId;this._key=a.join("|")}setResource(a,b){let c=this.resources[b];a!==c&&(c&&a.off?.("change",this.onResourceChange,this),a.on?.("change",this.onResourceChange,this),this.resources[b]=a,this._dirty=!0)}getResource(a){return this.resources[a]}_touch(a){let b=this.resources;for(let c in b)b[c]._touched=a}destroy(){let a=this.resources;for(let b in a){let c=a[b];c?.off?.("change",this.onResourceChange,this)}this.resources=null}onResourceChange(a){if(this._dirty=!0,a.destroyed){let b=this.resources;for(let c in b)b[c]===a&&(b[c]=null)}else this._updateKey()}}},20183:(a,b,c)=>{"use strict";c.d(b,{x:()=>h});var d=c(87818),e=c(13901),f=c(86360),g=c(22055);class h{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(a,b)=>`${a}${this._bundleIdConnector}${b}`,extractAssetIdFromBundle:(a,b)=>b.replace(`${a}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(a){if(this._bundleIdConnector=a.connector??this._bundleIdConnector,this._createBundleAssetId=a.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=a.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...a){a.forEach(a=>{this._preferredOrder.push(a),a.priority||(a.priority=Object.keys(a.params))}),this._resolverHash={}}set basePath(a){this._basePath=a}get basePath(){return this._basePath}set rootPath(a){this._rootPath=a}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(a){"string"==typeof a?this._defaultSearchParams=a:this._defaultSearchParams=Object.keys(a).map(b=>`${encodeURIComponent(b)}=${encodeURIComponent(a[b])}`).join("&")}getAlias(a){let{alias:b,src:c}=a;return(0,f.z)(b||c,a=>"string"==typeof a?a:Array.isArray(a)?a.map(a=>a?.src??a):a?.src?a.src:a,!0)}addManifest(a){this._manifest&&(0,d.R)("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=a,a.bundles.forEach(a=>{this.addBundle(a.name,a.assets)})}addBundle(a,b){let c=[],d=b;Array.isArray(b)||(d=Object.entries(b).map(([a,b])=>"string"==typeof b||Array.isArray(b)?{alias:a,src:b}:{alias:a,...b})),d.forEach(b=>{let d,e=b.src,f=b.alias;if("string"==typeof f){let b=this._createBundleAssetId(a,f);c.push(b),d=[f,b]}else{let b=f.map(b=>this._createBundleAssetId(a,b));c.push(...b),d=[...f,...b]}this.add({...b,alias:d,src:e})}),this._bundles[a]=c}add(a){let b,c=[];Array.isArray(a)?c.push(...a):c.push(a),b=a=>{this.hasKey(a)&&(0,d.R)(`[Resolver] already has key: ${a} overwriting`)},(0,f.z)(c).forEach(a=>{let{src:c}=a,{data:d,format:e,loadParser:g,parser:h}=a,i=(0,f.z)(c).map(a=>{if("string"==typeof a){let b=a.match(/\{(.*?)\}/g),c=[];if(b){let d=[];b.forEach(a=>{let b=a.substring(1,a.length-1).split(",");d.push(b)}),function a(b,c,d,e,f){let g=c[d];for(let h=0;h<g.length;h++){let i=g[h];d<c.length-1?a(b.replace(e[d],i),c,d+1,e,f):f.push(b.replace(e[d],i))}}(a,d,0,b,c)}else c.push(a);return c}return Array.isArray(a)?a:[a]}),j=this.getAlias(a);Array.isArray(j)?j.forEach(b):b(j);let k=[],l=a=>{let b=this._parsers.find(b=>b.test(a));return{...b?.parse(a),src:a}};i.forEach(b=>{b.forEach(b=>{let c={};if("object"!=typeof b?c=l(b):(d=b.data??d,e=b.format??e,(b.loadParser||b.parser)&&(g=b.loadParser??g,h=b.parser??h),c={...l(b.src),...b}),!j)throw Error(`[Resolver] alias is undefined for this asset: ${c.src}`);c=this._buildResolvedAsset(c,{aliases:j,data:d,format:e,loadParser:g,parser:h,progressSize:a.progressSize}),k.push(c)})}),j.forEach(a=>{this._assetMap[a]=k})})}resolveBundle(a){let b=(0,g.a)(a);a=(0,f.z)(a);let c={};return a.forEach(a=>{let b=this._bundles[a];if(b){let d=this.resolve(b),e={};for(let b in d){let c=d[b];e[this._extractAssetIdFromBundle(a,b)]=c}c[a]=e}}),b?c[a[0]]:c}resolveUrl(a){let b=this.resolve(a);if("string"!=typeof a){let a={};for(let c in b)a[c]=b[c].src;return a}return b.src}resolve(a){let b=(0,g.a)(a);a=(0,f.z)(a);let c={};return a.forEach(a=>{if(!this._resolverHash[a])if(this._assetMap[a]){let b=this._assetMap[a],c=this._getPreferredOrder(b);c?.priority.forEach(a=>{c.params[a].forEach(c=>{let d=b.filter(b=>!!b[a]&&b[a]===c);d.length&&(b=d)})}),this._resolverHash[a]=b[0]}else this._resolverHash[a]=this._buildResolvedAsset({alias:[a],src:a},{});c[a]=this._resolverHash[a]}),b?c[a[0]]:c}hasKey(a){return!!this._assetMap[a]}hasBundle(a){return!!this._bundles[a]}_getPreferredOrder(a){for(let b=0;b<a.length;b++){let c=a[b],d=this._preferredOrder.find(a=>a.params.format.includes(c.format));if(d)return d}return this._preferredOrder[0]}_appendDefaultSearchParams(a){if(!this._defaultSearchParams)return a;let b=/\?/.test(a)?"&":"?";return`${a}${b}${this._defaultSearchParams}`}_buildResolvedAsset(a,b){let{aliases:c,data:d,loadParser:f,parser:g,format:h,progressSize:i}=b;return(this._basePath||this._rootPath)&&(a.src=e.A.toAbsolute(a.src,this._basePath,this._rootPath)),a.alias=c??a.alias??[a.src],a.src=this._appendDefaultSearchParams(a.src),a.data={...d||{},...a.data},a.loadParser=f??a.loadParser,a.parser=g??a.parser,a.format=h??a.format??a.src.split(".").pop().split("?").shift().split("#").shift(),void 0!==i&&(a.progressSize=i),a}}h.RETINA_PREFIX=/@([0-9\.]+)x/},20402:(a,b,c)=>{"use strict";c.d(b,{L:()=>e});var d=c(42115);class e{constructor(){this.uid=(0,d.L)("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(a){this.instructions[this.instructionSize++]=a}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}},21283:(a,b,c)=>{"use strict";c.d(b,{Y:()=>d});let d=(a,b)=>{let c=b.split("?")[1];return c&&(a+=`?${c}`),a}},21310:(a,b,c)=>{"use strict";function d(a,b){if(0===a)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let c=b.createShader(b.FRAGMENT_SHADER);try{for(;;){let d="precision mediump float;\nvoid main(void){\nfloat test = 0.1;\n%forloop%\ngl_FragColor = vec4(0.0);\n}".replace(/%forloop%/gi,function(a){let b="";for(let c=0;c<a;++c)c>0&&(b+="\nelse "),c<a-1&&(b+=`if(test == ${c}.0){}`);return b}(a));if(b.shaderSource(c,d),b.compileShader(c),b.getShaderParameter(c,b.COMPILE_STATUS))break;a=a/2|0}}finally{b.deleteShader(c)}return a}c.d(b,{u:()=>d})},21507:(a,b,c)=>{"use strict";c.d(b,{K:()=>f,Q:()=>d});let d={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var e,f=((e=f||{})[e.DISABLED=0]="DISABLED",e[e.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",e[e.MASK_ACTIVE=2]="MASK_ACTIVE",e[e.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",e[e.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",e[e.NONE=5]="NONE",e)},21579:(a,b,c)=>{"use strict";c.d(b,{w:()=>g});var d=c(19979),e=c(61487);let f={};function g(a,b,c){let g=0x811c9dc5;for(let c=0;c<b;c++)g^=a[c].uid,g=Math.imul(g,0x1000193)>>>0;return f[g]||function(a,b,c,g){let h={},i=0;for(let c=0;c<g;c++){let d=c<b?a[c]:e.g.EMPTY.source;h[i++]=d.source,h[i++]=d.style}let j=new d.T(h);return f[c]=j,j}(a,b,g,c)}},21783:(a,b,c)=>{"use strict";c.d(b,{b:()=>d});class d{constructor(a=0,b=0){this.x=0,this.y=0,this.x=a,this.y=b}clone(){return new d(this.x,this.y)}copyFrom(a){return this.set(a.x,a.y),this}copyTo(a){return a.set(this.x,this.y),a}equals(a){return a.x===this.x&&a.y===this.y}set(a=0,b=a){return this.x=a,this.y=b,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return e.x=0,e.y=0,e}}let e=new d},22055:(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=a=>!Array.isArray(a)},25500:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81921,23)),Promise.resolve().then(c.t.bind(c,60440,23)),Promise.resolve().then(c.t.bind(c,84342,23)),Promise.resolve().then(c.t.bind(c,82265,23)),Promise.resolve().then(c.t.bind(c,35421,23)),Promise.resolve().then(c.t.bind(c,61335,23)),Promise.resolve().then(c.t.bind(c,70664,23)),Promise.resolve().then(c.bind(c,74661))},25805:(a,b,c)=>{"use strict";c.d(b,{$:()=>i});var d=c(45753),e=c(26632),f=c(15996),g=c(93141);let h=class a extends g.v{constructor(b){super(b),this.isReady=!1,this.uploadMethodId="video",b={...a.defaultOptions,...b},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=b.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==b.autoPlay,this.alphaMode=b.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==b.autoLoad&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){let a=e.R.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-a)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;let a=this.resource,b=this.options;return(a.readyState===a.HAVE_ENOUGH_DATA||a.readyState===a.HAVE_FUTURE_DATA)&&a.width&&a.height&&(a.complete=!0),a.addEventListener("play",this._onPlayStart),a.addEventListener("pause",this._onPlayStop),a.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(b.preload||a.addEventListener("canplay",this._onCanPlay),a.addEventListener("canplaythrough",this._onCanPlayThrough),a.addEventListener("error",this._onError,!0)),this.alphaMode=await (0,f.C)(),this._load=new Promise((c,d)=>{this.isValid?c(this):(this._resolve=c,this._reject=d,void 0!==b.preloadTimeoutMs&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${b.preloadTimeoutMs}ms`))})),a.load())}),this._load}_onError(a){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",a),this._reject&&(this._reject(a),this._reject=null,this._resolve=null)}_isSourcePlaying(){let a=this.resource;return!a.paused&&!a.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){let a=this.resource;this.isValid&&(this.isReady=!0,this.resize(a.videoWidth,a.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();let a=this.resource;a&&(a.removeEventListener("play",this._onPlayStart),a.removeEventListener("pause",this._onPlayStop),a.removeEventListener("seeked",this._onSeeked),a.removeEventListener("canplay",this._onCanPlay),a.removeEventListener("canplaythrough",this._onCanPlayThrough),a.removeEventListener("error",this._onError,!0),a.pause(),a.src="",a.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(a){a!==this._autoUpdate&&(this._autoUpdate=a,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(a){a!==this._updateFPS&&(this._updateFPS=a,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(e.R.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(e.R.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(e.R.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(a){return globalThis.HTMLVideoElement&&a instanceof HTMLVideoElement}};h.extension=d.Ag.TextureSource,h.defaultOptions={...g.v.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1},h.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let i=h},26632:(a,b,c)=>{"use strict";c.d(b,{R:()=>g});var d=c(61328);class e{constructor(a,b=null,c=0,d=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=a,this._context=b,this.priority=c,this._once=d}match(a,b=null){return this._fn===a&&this._context===b}emit(a){this._fn&&(this._context?this._fn.call(this._context,a):this._fn(a));let b=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),b}connect(a){this.previous=a,a.next&&(a.next.previous=this),this.next=a.next,a.next=this}destroy(a=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let b=this.next;return this.next=a?null:b,this.previous=null,b}}let f=class a{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new e(null,null,1/0),this.deltaMS=1/a.targetFPMS,this.elapsedMS=1/a.targetFPMS,this._tick=a=>{this._requestId=null,this.started&&(this.update(a),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(a,b,c=d.d.NORMAL){return this._addListener(new e(a,b,c))}addOnce(a,b,c=d.d.NORMAL){return this._addListener(new e(a,b,c,!0))}_addListener(a){let b=this._head.next,c=this._head;if(b){for(;b;){if(a.priority>b.priority){a.connect(c);break}c=b,b=b.next}a.previous||a.connect(c)}else a.connect(c);return this._startIfPossible(),this}remove(a,b){let c=this._head.next;for(;c;)c=c.match(a,b)?c.destroy():c.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let a=0,b=this._head;for(;b=b.next;)a++;return a}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let a=this._head.next;for(;a;)a=a.destroy(!0);this._head.destroy(),this._head=null}}update(b=performance.now()){let c;if(b>this.lastTime){if((c=this.elapsedMS=b-this.lastTime)>this._maxElapsedMS&&(c=this._maxElapsedMS),c*=this.speed,this._minElapsedMS){let a=b-this._lastFrame|0;if(a<this._minElapsedMS)return;this._lastFrame=b-a%this._minElapsedMS}this.deltaMS=c,this.deltaTime=this.deltaMS*a.targetFPMS;let d=this._head,e=d.next;for(;e;)e=e.emit(this);d.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=b}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(b){let c=Math.min(Math.max(0,Math.min(this.maxFPS,b))/1e3,a.targetFPMS);this._maxElapsedMS=1/c}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(a){if(0===a)this._minElapsedMS=0;else{let b=Math.max(this.minFPS,a);this._minElapsedMS=1/(b/1e3)}}static get shared(){if(!a._shared){let b=a._shared=new a;b.autoStart=!0,b._protected=!0}return a._shared}static get system(){if(!a._system){let b=a._system=new a;b.autoStart=!0,b._protected=!0}return a._system}};f.targetFPMS=.06;let g=f},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27331:(a,b,c)=>{"use strict";c.d(b,{v:()=>f});var d=c(57680),e=c(71568);class f extends d.A{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return(0,e.t6)(e.lj,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return(0,e.t6)(e.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return(0,e.t6)(e.lj,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return(0,e.t6)(e.lj,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return(0,e.t6)(e.lj,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(a=!1){for(let a in this.emit("destroy",this),this.removeAllListeners(),this.chars)this.chars[a].texture?.destroy();this.chars=null,a&&(this.pages.forEach(a=>a.texture.destroy(!0)),this.pages=null)}}},28354:a=>{"use strict";a.exports=require("util")},28383:(a,b,c)=>{"use strict";c.d(b,{j:()=>e});var d=c(63598);function e(a,b){return 0xffffff===a?b:0xffffff===b?a:(0,d.u)(a,b)}},28514:(a,b,c)=>{"use strict";c.d(b,{TO:()=>d,Td:()=>f,bO:()=>e});let d=2*Math.PI,e=180/Math.PI,f=Math.PI/180},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29508:a=>{a.exports=function(a){var e=[];return a.replace(c,function(a,c,f){var g,h=c.toLowerCase();for(f=(g=f.match(d))?g.map(Number):[],"m"==h&&f.length>2&&(e.push([c].concat(f.splice(0,2))),h="l",c="m"==c?"l":"L");;){if(f.length==b[h])return f.unshift(c),e.push(f);if(f.length<b[h])throw Error("malformed path data");e.push([c].concat(f.splice(0,b[h])))}}),e};var b={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},c=/([astvzqmhlc])([^astvzqmhlc]*)/ig,d=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig},29695:(a,b,c)=>{"use strict";c.d(b,{W:()=>k});var d=c(92149),e=c(83401),f=c(93141),g=c(61487),h=c(80424);let i=0;class j{constructor(a){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=a||{},this.enableFullScreen=!1,this.textureStyle=new h.n(this.textureOptions)}createTexture(a,b,c){let d=new f.v({...this.textureOptions,width:a,height:b,resolution:1,antialias:c,autoGarbageCollect:!1});return new g.g({source:d,label:`texturePool_${i++}`})}getOptimalTexture(a,b,c=1,e){let f=Math.ceil(a*c-1e-6),g=Math.ceil(b*c-1e-6),h=((f=(0,d.U5)(f))<<17)+((g=(0,d.U5)(g))<<1)+ +!!e;this._texturePool[h]||(this._texturePool[h]=[]);let i=this._texturePool[h].pop();return i||(i=this.createTexture(f,g,e)),i.source._resolution=c,i.source.width=f/c,i.source.height=g/c,i.source.pixelWidth=f,i.source.pixelHeight=g,i.frame.x=0,i.frame.y=0,i.frame.width=a,i.frame.height=b,i.updateUvs(),this._poolKeyHash[i.uid]=h,i}getSameSizeTexture(a,b=!1){let c=a.source;return this.getOptimalTexture(a.width,a.height,c._resolution,b)}returnTexture(a,b=!1){let c=this._poolKeyHash[a.uid];b&&(a.source.style=this.textureStyle),this._texturePool[c].push(a)}clear(a){if(a=!1!==a)for(let a in this._texturePool){let b=this._texturePool[a];if(b)for(let a=0;a<b.length;a++)b[a].destroy(!0)}this._texturePool={}}}let k=new j;e.L.register(k)},30006:(a,b,c)=>{"use strict";c.d(b,{k:()=>i});var d=c(8542),e=c(61487),f=c(40786),g=c(71568),h=c(77219);class i extends h.l{constructor(a=e.g.EMPTY){a instanceof e.g&&(a={texture:a});const{texture:b=e.g.EMPTY,anchor:c,roundPixels:f,width:g,height:h,...i}=a;super({label:"Sprite",...i}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new d.o({_onUpdate:()=>{this.onViewUpdate()}}),c?this.anchor=c:b.defaultAnchor&&(this.anchor=b.defaultAnchor),this.texture=b,this.allowChildren=!1,this.roundPixels=f??!1,void 0!==g&&(this.width=g),void 0!==h&&(this.height=h)}static from(a,b=!1){return new i(a instanceof e.g?a:e.g.from(a,b))}set texture(a){a||(a=e.g.EMPTY);let b=this._texture;b!==a&&(b&&b.dynamic&&b.off("update",this.onViewUpdate,this),a.dynamic&&a.on("update",this.onViewUpdate,this),this._texture=a,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return(0,f.y)(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return(0,g.t6)("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){let a=this._anchor,b=this._texture,c=this._bounds,{width:d,height:e}=b.orig;c.minX=-a._x*d,c.maxX=c.minX+d,c.minY=-a._y*e,c.maxY=c.minY+e}destroy(a=!1){if(super.destroy(a),"boolean"==typeof a?a:a?.texture){let b="boolean"==typeof a?a:a?.textureSource;this._texture.destroy(b)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(a){"number"==typeof a?this._anchor.set(a):this._anchor.copyFrom(a)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(a){this._setWidth(a,this._texture.orig.width),this._width=a}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(a){this._setHeight(a,this._texture.orig.height),this._height=a}getSize(a){return a||(a={}),a.width=Math.abs(this.scale.x)*this._texture.orig.width,a.height=Math.abs(this.scale.y)*this._texture.orig.height,a}setSize(a,b){"object"==typeof a?(b=a.height??a.width,a=a.width):b??(b=a),void 0!==a&&this._setWidth(a,this._texture.orig.width),void 0!==b&&this._setHeight(b,this._texture.orig.height)}}},30231:(a,b,c)=>{"use strict";c.d(b,{M:()=>f,d:()=>g});var d=c(45753),e=c(74885);class f{static init(){globalThis.__PIXI_APP_INIT__?.(this,e.xv)}static destroy(){}}f.extension=d.Ag.Application;class g{constructor(a){this._renderer=a}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,e.xv)}destroy(){this._renderer=null}}g.extension={type:[d.Ag.WebGLSystem,d.Ag.WebGPUSystem],name:"initHook",priority:-10}},33349:(a,b,c)=>{"use strict";c.d(b,{E:()=>g,f:()=>f});var d=c(48419),e=c(11630);function f(a,b,c){let f,h;return c.clear(),f=a.parent?b?a.parent.worldTransform:g(a,h=e.u.get().identity()):d.u.IDENTITY,function a(b,c,f,g){let h;if(!b.visible||!b.measurable)return;g?h=b.worldTransform:(b.updateLocalTransform(),(h=e.u.get()).appendFrom(b.localTransform,f));let i=c,j=!!b.effects.length;if(j&&(c=e.o.get().clear()),b.boundsArea)c.addRect(b.boundsArea,h);else{let d=b.bounds;d&&!d.isEmpty()&&(c.matrix=h,c.addBounds(d));for(let d=0;d<b.children.length;d++)a(b.children[d],c,h,g)}if(j){for(let a=0;a<b.effects.length;a++)b.effects[a].addBounds?.(c);i.addBounds(c,d.u.IDENTITY),e.o.return(c)}g||e.u.return(h)}(a,c,f,b),h&&e.u.return(h),c.isValid||c.set(0,0,0,0),c}function g(a,b){let c=a.parent;return c&&(g(c,b),c.updateLocalTransform(),b.append(c.localTransform)),b}},33386:(a,b,c)=>{"use strict";c.d(b,{RQ:()=>f,Zg:()=>g,rR:()=>e,wI:()=>h});var d=c(92913);function e(a){return(0,d.L)().prepare(`SELECT * FROM canvas_objects
       WHERE project_id = ?
       ORDER BY z_index ASC, created_at ASC`).all(a)}function f(a){let b=(0,d.L)(),c=new Date().toISOString(),e=b.prepare("DELETE FROM canvas_objects WHERE project_id = ?"),f=b.prepare(`INSERT INTO canvas_objects (
      id, project_id, type, asset_id, x, y, scale_x, scale_y, rotation,
      width, height, z_index, props_json, created_at, updated_at
    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`);b.transaction(()=>{for(let b of(e.run(a.projectId),a.objects))f.run(b.id,a.projectId,b.type,b.asset_id??null,b.x,b.y,b.scale_x,b.scale_y,b.rotation,b.width??null,b.height??null,b.z_index,b.props_json??null,c,c)})()}function g(a){return(0,d.L)().prepare("SELECT * FROM project_view WHERE project_id = ?").get(a)??null}function h(a){let b=(0,d.L)(),c=new Date().toISOString();b.prepare(`INSERT INTO project_view (project_id, world_x, world_y, zoom, updated_at)
     VALUES (?, ?, ?, ?, ?)
     ON CONFLICT(project_id) DO UPDATE SET
       world_x=excluded.world_x,
       world_y=excluded.world_y,
       zoom=excluded.zoom,
       updated_at=excluded.updated_at`).run(a.projectId,a.world_x,a.world_y,a.zoom,c)}},33873:a=>{"use strict";a.exports=require("path")},33999:(a,b,c)=>{Promise.resolve().then(c.bind(c,71064))},34298:(a,b,c)=>{"use strict";c.d(b,{n:()=>f});var d=c(87796);let e={};function f(a){let b=e[a];if(b)return b;let c=new Int32Array(a);for(let b=0;b<a;b++)c[b]=b;return e[a]=new d.k({uTextures:{value:c,type:"i32",size:a}},{isStatic:!0})}},35563:(a,b,c)=>{"use strict";c.d(b,{b:()=>d,m:()=>e});let d={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},e={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}}},36519:(a,b,c)=>{"use strict";c.d(b,{J:()=>K});var d=c(45753),e=c(42115),f=c(67834),g=c(71568),h=c(83401),i=c(41090),j=c(105),k=c(10),l=c(21310);let m=null;class n{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let a=0;a<this.count;a++){let b=this.textures[a];this.textures[a]=null,this.ids[b.uid]=null}this.count=0}}class o{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new n,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}let p=[],q=0;function r(){return q>0?p[--q]:new o}h.L.register({clear:()=>{if(p.length>0)for(let a of p)a&&a.destroy();p.length=0,q=0}});let s=0,t=class a{constructor(b){this.uid=(0,e.L)("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],(b={...a.defaultOptions,...b}).maxTextures||((0,g.t6)("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),b.maxTextures=function(){if(m)return m;let a=(0,k.W)();return m=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),m=(0,l.u)(m,a),a.getExtension("WEBGL_lose_context")?.loseContext(),m}());const{maxTextures:c,attributesInitialSize:d,indicesInitialSize:h}=b;this.attributeBuffer=new f.u(4*d),this.indexBuffer=new Uint16Array(h),this.maxTextures=c}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let b=0;b<this.batchIndex;b++){var a;a=this.batches[b],p[q++]=a}this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(a){this._elements[this.elementSize++]=a,a._indexStart=this.indexSize,a._attributeStart=this.attributeSize,a._batcher=this,this.indexSize+=a.indexSize,this.attributeSize+=a.attributeSize*this.vertexSize}checkAndUpdateTexture(a,b){let c=a._batch.textures.ids[b._source.uid];return(!!c||0===c)&&(a._textureId=c,a.texture=b,!0)}updateElement(a){this.dirty=!0;let b=this.attributeBuffer;a.packAsQuad?this.packQuadAttributes(a,b.float32View,b.uint32View,a._attributeStart,a._textureId):this.packAttributes(a,b.float32View,b.uint32View,a._attributeStart,a._textureId)}break(a){let b=this._elements;if(!b[this.elementStart])return;let c=r(),d=c.textures;d.clear();let e=b[this.elementStart],f=(0,j.i)(e.blendMode,e.texture._source),g=e.topology;4*this.attributeSize>this.attributeBuffer.size&&this._resizeAttributeBuffer(4*this.attributeSize),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);let h=this.attributeBuffer.float32View,i=this.attributeBuffer.uint32View,k=this.indexBuffer,l=this._batchIndexSize,m=this._batchIndexStart,n="startBatch",o=this.maxTextures;for(let e=this.elementStart;e<this.elementSize;++e){let p=b[e];b[e]=null;let q=p.texture._source,t=(0,j.i)(p.blendMode,q),u=f!==t||g!==p.topology;if(q._batchTick===s&&!u){p._textureId=q._textureBindLocation,l+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,h,i,p._attributeStart,p._textureId),this.packQuadIndex(k,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,h,i,p._attributeStart,p._textureId),this.packIndex(p,k,p._indexStart,p._attributeStart/this.vertexSize)),p._batch=c;continue}q._batchTick=s,(d.count>=o||u)&&(this._finishBatch(c,m,l-m,d,f,g,a,n),n="renderBatch",m=l,f=t,g=p.topology,(d=(c=r()).textures).clear(),++s),p._textureId=q._textureBindLocation=d.count,d.ids[q.uid]=d.count,d.textures[d.count++]=q,p._batch=c,l+=p.indexSize,p.packAsQuad?(this.packQuadAttributes(p,h,i,p._attributeStart,p._textureId),this.packQuadIndex(k,p._indexStart,p._attributeStart/this.vertexSize)):(this.packAttributes(p,h,i,p._attributeStart,p._textureId),this.packIndex(p,k,p._indexStart,p._attributeStart/this.vertexSize))}d.count>0&&(this._finishBatch(c,m,l-m,d,f,g,a,n),m=l,++s),this.elementStart=this.elementSize,this._batchIndexStart=m,this._batchIndexSize=l}_finishBatch(a,b,c,d,e,f,g,h){a.gpuBindGroup=null,a.bindGroup=null,a.action=h,a.batcher=this,a.textures=d,a.blendMode=e,a.topology=f,a.start=b,a.size=c,++s,this.batches[this.batchIndex++]=a,g.add(a)}finish(a){this.break(a)}ensureAttributeBuffer(a){4*a<=this.attributeBuffer.size||this._resizeAttributeBuffer(4*a)}ensureIndexBuffer(a){a<=this.indexBuffer.length||this._resizeIndexBuffer(a)}_resizeAttributeBuffer(a){let b=Math.max(a,2*this.attributeBuffer.size),c=new f.u(b);(0,i.W)(this.attributeBuffer.rawBinaryData,c.rawBinaryData),this.attributeBuffer=c}_resizeIndexBuffer(a){let b=this.indexBuffer,c=Math.max(a,1.5*b.length);c+=c%2;let d=c>65535?new Uint32Array(c):new Uint16Array(c);if(d.BYTES_PER_ELEMENT!==b.BYTES_PER_ELEMENT)for(let a=0;a<b.length;a++)d[a]=b[a];else(0,i.W)(b.buffer,d.buffer);this.indexBuffer=d}packQuadIndex(a,b,c){a[b]=c+0,a[b+1]=c+1,a[b+2]=c+2,a[b+3]=c+0,a[b+4]=c+2,a[b+5]=c+3}packIndex(a,b,c,d){let e=a.indices,f=a.indexSize,g=a.indexOffset,h=a.attributeOffset;for(let a=0;a<f;a++)b[c++]=d+e[a+g]-h}destroy(a={}){if(null!==this.batches){for(let a=0;a<this.batches.length;a++){var b;b=this.batches[a],p[q++]=b}this.batches=null,this.geometry.destroy(!0),this.geometry=null,a.shader&&(this.shader?.destroy(),this.shader=null);for(let a=0;a<this._elements.length;a++)this._elements[a]&&(this._elements[a]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};t.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let u=t;var v=c(16183),w=c(43362),x=c(94741);let y=new Float32Array(1),z=new Uint32Array(1);class A extends x.V{constructor(){const a=new v.h({data:y,label:"attribute-batch-buffer",usage:w.S.VERTEX|w.S.COPY_DST,shrinkToFit:!1});super({attributes:{aPosition:{buffer:a,format:"float32x2",stride:24,offset:0},aUV:{buffer:a,format:"float32x2",stride:24,offset:8},aColor:{buffer:a,format:"unorm8x4",stride:24,offset:16},aTextureIdAndRound:{buffer:a,format:"uint16x2",stride:24,offset:20}},indexBuffer:new v.h({data:z,label:"index-batch-buffer",usage:w.S.INDEX|w.S.COPY_DST,shrinkToFit:!1})})}}var B=c(95420),C=c(80225),D=c(79862),E=c(35563),F=c(34298),G=c(86233);class H extends G.M{constructor(a){super({glProgram:(0,B.I)({name:"batch",bits:[C.a,(0,D.P)(a),E.m]}),gpuProgram:(0,B.v)({name:"batch",bits:[C.F,(0,D._)(a),E.b]}),resources:{batchSamplers:(0,F.n)(a)}}),this.maxTextures=a}}let I=null,J=class a extends u{constructor(b){super(b),this.geometry=new A,this.name=a.extension.name,this.vertexSize=6,I??(I=new H(b.maxTextures)),this.shader=I}packAttributes(a,b,c,d,e){let f=e<<16|65535&a.roundPixels,g=a.transform,h=g.a,i=g.b,j=g.c,k=g.d,l=g.tx,m=g.ty,{positions:n,uvs:o}=a,p=a.color,q=a.attributeOffset,r=q+a.attributeSize;for(let a=q;a<r;a++){let e=2*a,g=n[e],q=n[e+1];b[d++]=h*g+j*q+l,b[d++]=k*q+i*g+m,b[d++]=o[e],b[d++]=o[e+1],c[d++]=p,c[d++]=f}}packQuadAttributes(a,b,c,d,e){let f=a.texture,g=a.transform,h=g.a,i=g.b,j=g.c,k=g.d,l=g.tx,m=g.ty,n=a.bounds,o=n.maxX,p=n.minX,q=n.maxY,r=n.minY,s=f.uvs,t=a.color,u=e<<16|65535&a.roundPixels;b[d+0]=h*p+j*r+l,b[d+1]=k*r+i*p+m,b[d+2]=s.x0,b[d+3]=s.y0,c[d+4]=t,c[d+5]=u,b[d+6]=h*o+j*r+l,b[d+7]=k*r+i*o+m,b[d+8]=s.x1,b[d+9]=s.y1,c[d+10]=t,c[d+11]=u,b[d+12]=h*o+j*q+l,b[d+13]=k*q+i*o+m,b[d+14]=s.x2,b[d+15]=s.y2,c[d+16]=t,c[d+17]=u,b[d+18]=h*p+j*q+l,b[d+19]=k*q+i*p+m,b[d+20]=s.x3,b[d+21]=s.y3,c[d+22]=t,c[d+23]=u}_updateMaxTextures(a){this.shader.maxTextures!==a&&(I=new H(a),this.shader=I)}destroy(){this.shader=null,super.destroy()}};J.extension={type:[d.Ag.Batcher],name:"default"};let K=J},37195:(a,b,c)=>{"use strict";c.d(b,{ServiceWorkerRegister:()=>d});let d=(0,c(77943).registerClientReference)(function(){throw Error("Attempted to call ServiceWorkerRegister() from the server but ServiceWorkerRegister is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/dannyruchtie/Documents/moondream/web/src/components/pwa/ServiceWorkerRegister.tsx","ServiceWorkerRegister")},37753:(a,b,c)=>{"use strict";function d(a,b,c){let d,e=a.length;if(b>=e||0===c)return;c=b+c>e?e-b:c;let f=e-c;for(d=b;d<f;++d)a[d]=a[d+c];a.length=f}c.d(b,{d:()=>d})},39068:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,95547,23)),Promise.resolve().then(c.t.bind(c,15098,23)),Promise.resolve().then(c.t.bind(c,47644,23)),Promise.resolve().then(c.t.bind(c,33859,23)),Promise.resolve().then(c.t.bind(c,98099,23)),Promise.resolve().then(c.t.bind(c,16237,23)),Promise.resolve().then(c.t.bind(c,98562,23)),Promise.resolve().then(c.t.bind(c,36675,23))},40207:(a,b,c)=>{"use strict";c.d(b,{g:()=>e});class d{constructor(a=0,b=0,c=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=a,this.resetTtl=c,this.size=0,this.ttl=b}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(a){if(this.has(a)){let b=this.items[a];delete this.items[a],this.size--,null!==b.prev&&(b.prev.next=b.next),null!==b.next&&(b.next.prev=b.prev),this.first===b&&(this.first=b.next),this.last===b&&(this.last=b.prev)}return this}entries(a=this.keys()){return a.map(a=>[a,this.get(a)])}evict(a=!1){if(a||this.size>0){let a=this.first;delete this.items[a.key],0==--this.size?(this.first=null,this.last=null):(this.first=a.next,this.first.prev=null)}return this}expiresAt(a){let b;return this.has(a)&&(b=this.items[a].expiry),b}get(a){let b=this.items[a];if(void 0!==b)return this.ttl>0&&b.expiry<=Date.now()?void this.delete(a):(this.moveToEnd(b),b.value)}has(a){return a in this.items}moveToEnd(a){this.last!==a&&(null!==a.prev&&(a.prev.next=a.next),null!==a.next&&(a.next.prev=a.prev),this.first===a&&(this.first=a.next),a.prev=this.last,a.next=null,null!==this.last&&(this.last.next=a),this.last=a,null===this.first&&(this.first=a))}keys(){let a=[],b=this.first;for(;null!==b;)a.push(b.key),b=b.next;return a}setWithEvicted(a,b,c=this.resetTtl){let d=null;if(this.has(a))this.set(a,b,!0,c);else{this.max>0&&this.size===this.max&&(d={...this.first},this.evict(!0));let c=this.items[a]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:a,prev:this.last,next:null,value:b};1==++this.size?this.first=c:this.last.next=c,this.last=c}return d}set(a,b,c=!1,d=this.resetTtl){let e=this.items[a];return c||void 0!==e?(e.value=b,!1===c&&d&&(e.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(e)):(this.max>0&&this.size===this.max&&this.evict(!0),e=this.items[a]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:a,prev:this.last,next:null,value:b},1==++this.size?this.first=e:this.last.next=e,this.last=e),this}values(a=this.keys()){return a.map(a=>this.get(a))}}function e(a=1e3,b=0,c=!1){if(isNaN(a)||a<0)throw TypeError("Invalid max value");if(isNaN(b)||b<0)throw TypeError("Invalid ttl value");if("boolean"!=typeof c)throw TypeError("Invalid resetTtl value");return new d(a,b,c)}},40786:(a,b,c)=>{"use strict";function d(a,b,c){let{width:d,height:e}=c.orig,f=c.trim;if(f){let c=f.width,g=f.height;a.minX=f.x-b._x*d,a.maxX=a.minX+c,a.minY=f.y-b._y*e,a.maxY=a.minY+g}else a.minX=-b._x*d,a.maxX=a.minX+d,a.minY=-b._y*e,a.maxY=a.minY+e}c.d(b,{y:()=>d})},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},41090:(a,b,c)=>{"use strict";function d(a,b){let c=a.byteLength/8|0,d=new Float64Array(a,0,c);new Float64Array(b,0,c).set(d);let e=a.byteLength-8*c;if(e>0){let d=new Uint8Array(a,8*c,e);new Uint8Array(b,8*c,e).set(d)}}c.d(b,{W:()=>d})},41890:(a,b,c)=>{"use strict";c.d(b,{_:()=>n});var d=c(66242),e=c(43274),f=c(48419),g=c(16503),h=c(61487),i=c(42115),j=c(71568),k=c(19748);let l=[{offset:0,color:"white"},{offset:1,color:"black"}],m=class a{constructor(...b){this.uid=(0,i.L)("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let c=function(a){let b=a[0]??{};return("number"==typeof b||a[1])&&((0,j.t6)("8.5.2","use options object instead"),b={type:"linear",start:{x:a[0],y:a[1]},end:{x:a[2],y:a[3]},textureSpace:a[4],textureSize:a[5]??n.defaultLinearOptions.textureSize}),b}(b);c={..."radial"===c.type?a.defaultRadialOptions:a.defaultLinearOptions,...(0,k.S)(c)},this._textureSize=c.textureSize,this._wrapMode=c.wrapMode,"radial"===c.type?(this.center=c.center,this.outerCenter=c.outerCenter??this.center,this.innerRadius=c.innerRadius,this.outerRadius=c.outerRadius,this.scale=c.scale,this.rotation=c.rotation):(this.start=c.start,this.end=c.end),this.textureSpace=c.textureSpace,this.type=c.type,c.colorStops.forEach(a=>{this.addColorStop(a.offset,a.color)})}addColorStop(a,b){return this.colorStops.push({offset:a,color:d.Q.shared.setValue(b).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:a,y:b}=this.start,{x:c,y:d}=this.end,e=c-a,i=d-b,j=e<0||i<0;if("clamp-to-edge"===this._wrapMode){if(e<0){let b=a;a=c,c=b,e*=-1}if(i<0){let a=b;b=d,d=a,i*=-1}}let k=this.colorStops.length?this.colorStops:l,m=this._textureSize,{canvas:n,context:q}=p(m,1),r=j?q.createLinearGradient(this._textureSize,0,0,0):q.createLinearGradient(0,0,this._textureSize,0);o(r,k),q.fillStyle=r,q.fillRect(0,0,m,1),this.texture=new h.g({source:new g.b({resource:n,addressMode:this._wrapMode})});let s=Math.sqrt(e*e+i*i),t=Math.atan2(i,e),u=new f.u;u.scale(s/m,1),u.rotate(t),u.translate(a,b),"local"===this.textureSpace&&u.scale(m,m),this.transform=u}buildGradient(){!this.texture&&this._tick++,"linear"===this.type?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;let a=this.colorStops.length?this.colorStops:l,b=this._textureSize,{canvas:c,context:d}=p(b,b),{x:e,y:i}=this.center,{x:j,y:k}=this.outerCenter,m=this.innerRadius,n=this.outerRadius,q=j-n,r=k-n,s=b/(2*n),t=(e-q)*s,u=(i-r)*s,v=d.createRadialGradient(t,u,m*s,(j-q)*s,(k-r)*s,n*s);o(v,a),d.fillStyle=a[a.length-1].color,d.fillRect(0,0,b,b),d.fillStyle=v,d.translate(t,u),d.rotate(this.rotation),d.scale(1,this.scale),d.translate(-t,-u),d.fillRect(0,0,b,b),this.texture=new h.g({source:new g.b({resource:c,addressMode:this._wrapMode})});let w=new f.u;w.scale(1/s,1/s),w.translate(q,r),"local"===this.textureSpace&&w.scale(b,b),this.transform=w}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};m.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"},m.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let n=m;function o(a,b){for(let c=0;c<b.length;c++){let d=b[c];a.addColorStop(d.offset,d.color)}}function p(a,b){let c=e.e.get().createCanvas(a,b),d=c.getContext("2d");return{canvas:c,context:d}}},42115:(a,b,c)=>{"use strict";c.d(b,{L:()=>e});let d={default:-1};function e(a="default"){return void 0===d[a]&&(d[a]=-1),++d[a]}},42247:(a,b,c)=>{Promise.resolve().then(c.bind(c,13968))},43274:(a,b,c)=>{"use strict";c.d(b,{e:()=>e});let d={createCanvas:(a,b)=>{let c=document.createElement("canvas");return c.width=a,c.height=b,c},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(a,b)=>fetch(a,b),parseXML:a=>new DOMParser().parseFromString(a,"text/xml")},e={get:()=>d,set(a){d=a}}},43362:(a,b,c)=>{"use strict";c.d(b,{S:()=>e});var d,e=((d=e||{})[d.MAP_READ=1]="MAP_READ",d[d.MAP_WRITE=2]="MAP_WRITE",d[d.COPY_SRC=4]="COPY_SRC",d[d.COPY_DST=8]="COPY_DST",d[d.INDEX=16]="INDEX",d[d.VERTEX=32]="VERTEX",d[d.UNIFORM=64]="UNIFORM",d[d.STORAGE=128]="STORAGE",d[d.INDIRECT=256]="INDIRECT",d[d.QUERY_RESOLVE=512]="QUERY_RESOLVE",d[d.STATIC=1024]="STATIC",d)},43954:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/interception-routes")},43984:(a,b,c)=>{"use strict";c.d(b,{d:()=>i});var d=c(15104),e=c(5086),f=c(86233),g=c(83305);let h=class a extends f.M{constructor(b){super(b={...a.defaultOptions,...b}),this.enabled=!0,this._state=g.U.for2d(),this.blendMode=b.blendMode,this.padding=b.padding,"boolean"==typeof b.antialias?this.antialias=b.antialias?"on":"off":this.antialias=b.antialias,this.resolution=b.resolution,this.blendRequired=b.blendRequired,this.clipToViewport=b.clipToViewport,this.addResource("uTexture",0,1),b.blendRequired&&this.addResource("uBackTexture",0,3)}apply(a,b,c,d){a.applyFilter(this,b,c,d)}get blendMode(){return this._state.blendMode}set blendMode(a){this._state.blendMode=a}static from(b){let c,f,{gpu:g,gl:h,...i}=b;return g&&(c=e.B.from(g)),h&&(f=d.M.from(h)),new a({gpuProgram:c,glProgram:f,...i})}};h.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let i=h},45373:(a,b,c)=>{"use strict";function d(){return null}c.d(b,{ServiceWorkerRegister:()=>d}),c(67484)},45464:(a,b,c)=>{"use strict";c.d(b,{m:()=>g});var d=c(48419),e=c(42115);let f={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class g{constructor(a,b){this.uid=(0,e.L)("fillPattern"),this._tick=0,this.transform=new d.u,this.texture=a,this.transform.scale(1/a.frame.width,1/a.frame.height),b&&(a.source.style.addressModeU=f[b].addressModeU,a.source.style.addressModeV=f[b].addressModeV)}setTransform(a){let b=this.texture;this.transform.copyFrom(a),this.transform.invert(),this.transform.scale(1/b.frame.width,1/b.frame.height),this._tick++}get texture(){return this._texture}set texture(a){this._texture!==a&&(this._texture=a,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}},45753:(a,b,c)=>{"use strict";c.d(b,{Ag:()=>e,XO:()=>h});var d,e=((d=e||{}).Application="application",d.WebGLPipes="webgl-pipes",d.WebGLPipesAdaptor="webgl-pipes-adaptor",d.WebGLSystem="webgl-system",d.WebGPUPipes="webgpu-pipes",d.WebGPUPipesAdaptor="webgpu-pipes-adaptor",d.WebGPUSystem="webgpu-system",d.CanvasSystem="canvas-system",d.CanvasPipesAdaptor="canvas-pipes-adaptor",d.CanvasPipes="canvas-pipes",d.Asset="asset",d.LoadParser="load-parser",d.ResolveParser="resolve-parser",d.CacheParser="cache-parser",d.DetectionParser="detection-parser",d.MaskEffect="mask-effect",d.BlendMode="blend-mode",d.TextureSource="texture-source",d.Environment="environment",d.ShapeBuilder="shape-builder",d.Batcher="batcher",d);let f=a=>{if("function"==typeof a||"object"==typeof a&&a.extension){if(!a.extension)throw Error("Extension class must have an extension object");a={..."object"!=typeof a.extension?{type:a.extension}:a.extension,ref:a}}if("object"==typeof a)a={...a};else throw Error("Invalid extension type");return"string"==typeof a.type&&(a.type=[a.type]),a},g=(a,b)=>f(a).priority??b,h={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...a){return a.map(f).forEach(a=>{a.type.forEach(b=>this._removeHandlers[b]?.(a))}),this},add(...a){return a.map(f).forEach(a=>{a.type.forEach(b=>{let c=this._addHandlers,d=this._queue;c[b]?c[b]?.(a):(d[b]=d[b]||[],d[b]?.push(a))})}),this},handle(a,b,c){let d=this._addHandlers,e=this._removeHandlers;if(d[a]||e[a])throw Error(`Extension type ${a} already has a handler`);d[a]=b,e[a]=c;let f=this._queue;return f[a]&&(f[a]?.forEach(a=>b(a)),delete f[a]),this},handleByMap(a,b){return this.handle(a,a=>{a.name&&(b[a.name]=a.ref)},a=>{a.name&&delete b[a.name]})},handleByNamedList(a,b,c=-1){return this.handle(a,a=>{b.findIndex(b=>b.name===a.name)>=0||(b.push({name:a.name,value:a.ref}),b.sort((a,b)=>g(b.value,c)-g(a.value,c)))},a=>{let c=b.findIndex(b=>b.name===a.name);-1!==c&&b.splice(c,1)})},handleByList(a,b,c=-1){return this.handle(a,a=>{b.includes(a.ref)||(b.push(a.ref),b.sort((a,b)=>g(b,c)-g(a,c)))},a=>{let c=b.indexOf(a.ref);-1!==c&&b.splice(c,1)})},mixin(a,...b){for(let c of b)Object.defineProperties(a.prototype,Object.getOwnPropertyDescriptors(c))}}},46994:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>C.a,__next_app__:()=>K,handler:()=>M,routeModule:()=>L});var d=c(7553),e=c(84006),f=c(67798),g=c(34775),h=c(99373),i=c(73461),j=c(1020),k=c(26349),l=c(54365),m=c(16023),n=c(63747),o=c(24235),p=c(23938),q=c(261),r=c(66758),s=c(77243),t=c(26713),u=c(37527),v=c(22820),w=c(88216),x=c(47929),y=c(79551),z=c(89125),A=c(86439),B=c(95547),C=c.n(B),D=c(61287),E=c(81494),F=c(70722),G=c(70753),H=c(43954),I={};for(let a in D)0>["default","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(I[a]=()=>D[a]);c.d(b,I);let J={children:["",{children:["projects",{children:["[projectId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,98698)),"/Users/dannyruchtie/Documents/moondream/web/src/app/projects/[projectId]/page.tsx"]}]},{}]},{metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,76537)),"/Users/dannyruchtie/Documents/moondream/web/src/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,95547,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,55091,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,45270,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,28193,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,K={require:c,loadChunk:()=>Promise.resolve()},L=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/projects/[projectId]/page",pathname:"/projects/[projectId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:J},distDir:".next",relativeProjectDir:""});async function M(a,b,d){var B;L.isDev&&(0,h.addRequestMeta)(a,"devRequestTimingInternalsEnd",process.hrtime.bigint());let I=!!(0,h.getRequestMeta)(a,"minimalMode"),N="/projects/[projectId]/page";"/index"===N&&(N="/");let O=await L.prepare(a,b,{srcPage:N,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,pageIsDynamic:S,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,serverActionsManifest:W,clientReferenceManifest:X,subresourceIntegrityManifest:Y,prerenderManifest:Z,isDraftMode:$,resolvedPathname:_,revalidateOnlyGenerated:aa,routerServerContext:ab,nextConfig:ac,parsedUrl:ad,interceptionRoutePatterns:ae,deploymentId:af}=O,ag=(0,q.normalizeAppPath)(N),{isOnDemandRevalidate:ah}=O,ai=ac.experimental.ppr&&!ac.cacheComponents&&(0,H.isInterceptionRouteAppPath)(_)?null:L.match(_,Z),aj=!!Z.routes[_],ak=a.headers["user-agent"]||"",al=(0,t.getBotType)(ak),am=(0,p.isHtmlBotRequest)(a),an=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[s.NEXT_ROUTER_PREFETCH_HEADER],ao=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[s.RSC_HEADER],ap=(0,r.getIsPossibleServerAction)(a),aq=(0,m.checkIsAppPPREnabled)(ac.experimental.ppr);if(!(0,h.getRequestMeta)(a,"postponed")&&aq&&"1"===a.headers[x.NEXT_RESUME_HEADER]&&"POST"===a.method){let b=[];for await(let c of a)b.push(c);let c=Buffer.concat(b).toString("utf8");(0,h.addRequestMeta)(a,"postponed",c)}let ar=aq&&(null==(B=Z.routes[ag]??Z.dynamicRoutes[ag])?void 0:B.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?(0,h.getRequestMeta)(a,"postponed"):void 0,av=ar&&ao&&!an;I&&(av=av&&!!au);let aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=(!am||!ar)&&(!ak||(0,p.shouldServeStreamingMetadata)(ak,ac.htmlLimitedBots)),ay=!!((ai||aj||Z.routes[ag])&&!(am&&ar)),az=ar&&!0===ac.cacheComponents,aA=!0===L.isDev||!ay||"string"==typeof au||(az&&(0,h.getRequestMeta)(a,"onCacheEntryV2")?av&&!I:av),aB=am&&ar,aC=null;$||!ay||aA||ap||au||av||(aC=_);let aD=aC;!aD&&L.isDev&&(aD=_),L.isDev||$||!ay||!ao||av||(0,k.d)(a.headers);let aE={...D,tree:J,GlobalError:C(),handler:M,routeModule:L,__next_app__:K};W&&X&&(0,o.setManifestsSingleton)({page:N,clientReferenceManifest:X,serverActionsManifest:W});let aF=a.method||"GET",aG=(0,g.getTracer)(),aH=aG.getActiveScopeSpan(),aI=async()=>((null==ab?void 0:ab.render404)?await ab.render404(a,b,ad,!1):b.end("This page could not be found"),null);try{let f=L.getVaryHeader(_,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return L.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let a=aG.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let d=a.get("next.route");if(d){let a=`${aF} ${d}`;c.setAttributes({"next.route":d,"http.route":d,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aF} ${N}`)})},m=(0,h.getRequestMeta)(a,"incrementalCache"),o=async({span:e,postponed:f,fallbackRouteParams:g,forceStaticRender:i})=>{let l={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aE,Component:(0,j.T)(aE),params:R,routeModule:L,page:N,postponed:f,shouldWaitOnAllReady:aB,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||aA,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,subresourceIntegrityManifest:Y,setCacheStatus:null==ab?void 0:ab.setCacheStatus,setIsrStatus:null==ab?void 0:ab.setIsrStatus,setReactDebugChannel:null==ab?void 0:ab.setReactDebugChannel,sendErrorsToBrowser:null==ab?void 0:ab.sendErrorsToBrowser,dir:c(33873).join(process.cwd(),L.relativeProjectDir),isDraftMode:$,botType:al,isOnDemandRevalidate:ah,isPossibleServerAction:ap,assetPrefix:ac.assetPrefix,nextConfigOutput:ac.output,crossOrigin:ac.crossOrigin,trailingSlash:ac.trailingSlash,images:ac.images,previewProps:Z.preview,deploymentId:af,enableTainting:ac.experimental.taint,htmlLimitedBots:ac.htmlLimitedBots,reactMaxHeadersLength:ac.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:m,cacheLifeProfiles:ac.cacheLife,basePath:ac.basePath,serverActions:ac.experimental.serverActions,...as||at?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isDebugDynamicAccesses:as}:{},cacheComponents:!!ac.cacheComponents,experimental:{isRoutePPREnabled:ar,expireTime:ac.expireTime,staleTimes:ac.experimental.staleTimes,dynamicOnHover:!!ac.experimental.dynamicOnHover,inlineCss:!!ac.experimental.inlineCss,authInterrupts:!!ac.experimental.authInterrupts,clientTraceMetadata:ac.experimental.clientTraceMetadata||[],clientParamParsingOrigins:ac.experimental.clientParamParsingOrigins},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d,e)=>L.onRequestError(a,b,d,e,ab),err:(0,h.getRequestMeta)(a,"invokeError"),dev:L.isDev}};as&&(l.renderOpts.nextExport=!0,l.renderOpts.supportsDynamicResponse=!1,l.renderOpts.isDebugDynamicAccesses=as),i&&(l.renderOpts.supportsDynamicResponse=!1);let n=await k(e,l),{metadata:o}=n,{cacheControl:p,headers:q={},fetchTags:r,fetchMetrics:s}=o;if(r&&(q[x.NEXT_CACHE_TAGS_HEADER]=r),a.fetchMetrics=s,ay&&(null==p?void 0:p.revalidate)===0&&!L.isDev&&!ar){let a=o.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${_}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:u.CachedRouteKind.APP_PAGE,html:n,headers:q,rscData:o.flightData,postponed:o.postponed,status:o.statusCode,segmentData:o.segmentData},cacheControl:p}},p=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i,forceStaticRender:j=!1})=>{let k,l=!1===L.isDev,q=c||b.writableEnded;if(ah&&aa&&!f&&!I)return(null==ab?void 0:ab.render404)?await ab.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(k=(0,v.parseFallbackField)(ai.fallback)),k===v.FallbackMode.PRERENDER&&(0,t.isBot)(ak)&&(!ar||am)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(k!==v.FallbackMode.NOT_FOUND||f)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),!I&&k!==v.FallbackMode.BLOCKING_STATIC_RENDER&&aD&&!q&&!$&&S&&(l||!aj)){if((l||ai)&&k===v.FallbackMode.NOT_FOUND){if(ac.experimental.adapterPath)return await aI();throw new A.NoFallbackError}if(ar&&(ac.cacheComponents?!av:!ao)){let b=l&&"string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:ag,c=l&&(null==ai?void 0:ai.fallbackRouteParams)?(0,n.createOpaqueFallbackRouteParams)(ai.fallbackRouteParams):at?(0,n.getFallbackRouteParams)(ag,L):null,f=await L.handleResponse({cacheKey:b,req:a,nextConfig:ac,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:Z,isRoutePPREnabled:ar,responseGenerator:async()=>o({span:i,postponed:void 0,fallbackRouteParams:c,forceStaticRender:!1}),waitUntil:d.waitUntil,isMinimalMode:I});if(null===f)return null;if(f)return delete f.cacheControl,f}}let r=ah||g||!au?void 0:au;if(az&&!I&&m&&av&&!j){let b=await m.get(_,{kind:u.IncrementalCacheKind.APP_PAGE,isRoutePPREnabled:!0,isFallback:!1});b&&b.value&&b.value.kind===u.CachedRouteKind.APP_PAGE&&(r=b.value.postponed,b&&(-1===b.isStale||!0===b.isStale)&&(0,G.scheduleOnNextTick)(async()=>{let b=L.getResponseCache(a);try{await b.revalidate(_,m,ar,!1,a=>p({...a,forceStaticRender:!0}),null,c,d.waitUntil)}catch(a){console.error("Error revalidating the page in the background",a)}}))}if(as&&void 0!==r)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:u.CachedRouteKind.PAGES,html:w.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let s=l&&(null==ai?void 0:ai.fallbackRouteParams)&&(0,h.getRequestMeta)(a,"renderFallbackShell")?(0,n.createOpaqueFallbackRouteParams)(ai.fallbackRouteParams):at?(0,n.getFallbackRouteParams)(ag,L):null;return o({span:i,postponed:r,fallbackRouteParams:s,forceStaticRender:j})},q=async c=>{var f,g,i,j,k;let l,m=await L.handleResponse({cacheKey:aC,responseGenerator:a=>p({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ac,prerenderManifest:Z,waitUntil:d.waitUntil,isMinimalMode:I});if($&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),L.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!m){if(aC)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=m.value)?void 0:f.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=m.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let n="string"==typeof m.value.postponed;ay&&!av&&(!n||an)&&(I||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":m.isMiss?"MISS":m.isStale?"STALE":"HIT"),b.setHeader(s.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=m;if(au)l={revalidate:0,expire:void 0};else if(av)l={revalidate:0,expire:void 0};else if(!L.isDev)if($)l={revalidate:0,expire:void 0};else if(ay){if(m.cacheControl)if("number"==typeof m.cacheControl.revalidate){if(m.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${m.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:m.cacheControl.revalidate,expire:(null==(j=m.cacheControl)?void 0:j.expire)??ac.expireTime}}else l={revalidate:x.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(m.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===u.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[x.NEXT_CACHE_TAGS_HEADER];I&&ay&&c&&"string"==typeof c&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,z.sendRenderResult)({req:a,res:b,generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(d,s.RSC_CONTENT_TYPE_HEADER),cacheControl:m.cacheControl}):(b.statusCode=204,(0,z.sendRenderResult)({req:a,res:b,generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.EMPTY,cacheControl:m.cacheControl}))}let r=az?(0,h.getRequestMeta)(a,"onCacheEntryV2")??(0,h.getRequestMeta)(a,"onCacheEntry"):(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r(m,{url:(0,h.getRequestMeta)(a,"initURL")??a.url}))return null;if(q.headers){let a={...q.headers};for(let[c,d]of(I&&ay||delete a[x.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let t=null==(g=q.headers)?void 0:g[x.NEXT_CACHE_TAGS_HEADER];if(I&&ay&&t&&"string"==typeof t&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,t),!q.status||ao&&ar||(b.statusCode=q.status),!I&&q.status&&E.RedirectStatusCode[q.status]&&ao&&(b.statusCode=200),n&&!av&&b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"1"),ao&&!$){if(void 0===q.rscData){if(q.html.contentType!==s.RSC_CONTENT_TYPE_HEADER)if(ac.cacheComponents)return b.statusCode=404,(0,z.sendRenderResult)({req:a,res:b,generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.EMPTY,cacheControl:m.cacheControl});else throw Object.defineProperty(new F.InvariantError(`Expected RSC response, got ${q.html.contentType}`),"__NEXT_ERROR_CODE",{value:"E789",enumerable:!1,configurable:!0});return(0,z.sendRenderResult)({req:a,res:b,generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:q.html,cacheControl:m.cacheControl})}return(0,z.sendRenderResult)({req:a,res:b,generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(q.rscData,s.RSC_CONTENT_TYPE_HEADER),cacheControl:m.cacheControl})}let v=q.html;if(!n||I||ao)return(0,z.sendRenderResult)({req:a,res:b,generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:m.cacheControl});if(as)return v.push(new ReadableStream({start(a){a.enqueue(y.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,z.sendRenderResult)({req:a,res:b,generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}});let A=new TransformStream;return v.push(A.readable),o({span:c,postponed:q.postponed,fallbackRouteParams:null,forceStaticRender:!1}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(A.writable)}).catch(a=>{A.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,z.sendRenderResult)({req:a,res:b,generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}})};if(!aH)return await aG.withPropagatedContext(a.headers,()=>aG.trace(i.BaseServerSpan.handleRequest,{spanName:`${aF} ${N}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aF,"http.target":a.url}},q));await q(aH)}catch(b){throw b instanceof A.NoFallbackError||await L.onRequestError(a,b,{routerKind:"App Router",routePath:N,routeType:"render",revalidateReason:(0,f.c)({isStaticGeneration:ay,isOnDemandRevalidate:ah})},!1,ab),b}}},48419:(a,b,c)=>{"use strict";c.d(b,{u:()=>f});var d=c(28514),e=c(21783);class f{constructor(a=1,b=0,c=0,d=1,e=0,f=0){this.array=null,this.a=a,this.b=b,this.c=c,this.d=d,this.tx=e,this.ty=f}fromArray(a){this.a=a[0],this.b=a[1],this.c=a[3],this.d=a[4],this.tx=a[2],this.ty=a[5]}set(a,b,c,d,e,f){return this.a=a,this.b=b,this.c=c,this.d=d,this.tx=e,this.ty=f,this}toArray(a,b){this.array||(this.array=new Float32Array(9));let c=b||this.array;return a?(c[0]=this.a,c[1]=this.b,c[2]=0,c[3]=this.c,c[4]=this.d,c[5]=0,c[6]=this.tx,c[7]=this.ty):(c[0]=this.a,c[1]=this.c,c[2]=this.tx,c[3]=this.b,c[4]=this.d,c[5]=this.ty,c[6]=0,c[7]=0),c[8]=1,c}apply(a,b){b=b||new e.b;let c=a.x,d=a.y;return b.x=this.a*c+this.c*d+this.tx,b.y=this.b*c+this.d*d+this.ty,b}applyInverse(a,b){b=b||new e.b;let c=this.a,d=this.b,f=this.c,g=this.d,h=this.tx,i=this.ty,j=1/(c*g+-(f*d)),k=a.x,l=a.y;return b.x=g*j*k+-f*j*l+(i*f-h*g)*j,b.y=c*j*l+-d*j*k+(-i*c+h*d)*j,b}translate(a,b){return this.tx+=a,this.ty+=b,this}scale(a,b){return this.a*=a,this.d*=b,this.c*=a,this.b*=b,this.tx*=a,this.ty*=b,this}rotate(a){let b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.c,f=this.tx;return this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b,this}append(a){let b=this.a,c=this.b,d=this.c,e=this.d;return this.a=a.a*b+a.b*d,this.b=a.a*c+a.b*e,this.c=a.c*b+a.d*d,this.d=a.c*c+a.d*e,this.tx=a.tx*b+a.ty*d+this.tx,this.ty=a.tx*c+a.ty*e+this.ty,this}appendFrom(a,b){let c=a.a,d=a.b,e=a.c,f=a.d,g=a.tx,h=a.ty,i=b.a,j=b.b,k=b.c,l=b.d;return this.a=c*i+d*k,this.b=c*j+d*l,this.c=e*i+f*k,this.d=e*j+f*l,this.tx=g*i+h*k+b.tx,this.ty=g*j+h*l+b.ty,this}setTransform(a,b,c,d,e,f,g,h,i){return this.a=Math.cos(g+i)*e,this.b=Math.sin(g+i)*e,this.c=-Math.sin(g-h)*f,this.d=Math.cos(g-h)*f,this.tx=a-(c*this.a+d*this.c),this.ty=b-(c*this.b+d*this.d),this}prepend(a){let b=this.tx;if(1!==a.a||0!==a.b||0!==a.c||1!==a.d){let b=this.a,c=this.c;this.a=b*a.a+this.b*a.c,this.b=b*a.b+this.b*a.d,this.c=c*a.a+this.d*a.c,this.d=c*a.b+this.d*a.d}return this.tx=b*a.a+this.ty*a.c+a.tx,this.ty=b*a.b+this.ty*a.d+a.ty,this}decompose(a){let b=this.a,c=this.b,e=this.c,f=this.d,g=a.pivot,h=-Math.atan2(-e,f),i=Math.atan2(c,b),j=Math.abs(h+i);return j<1e-5||1e-5>Math.abs(d.TO-j)?(a.rotation=i,a.skew.x=a.skew.y=0):(a.rotation=0,a.skew.x=h,a.skew.y=i),a.scale.x=Math.sqrt(b*b+c*c),a.scale.y=Math.sqrt(e*e+f*f),a.position.x=this.tx+(g.x*b+g.y*e),a.position.y=this.ty+(g.x*c+g.y*f),a}invert(){let a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this}isIdentity(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.tx&&0===this.ty}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let a=new f;return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a}copyTo(a){return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a}copyFrom(a){return this.a=a.a,this.b=a.b,this.c=a.c,this.d=a.d,this.tx=a.tx,this.ty=a.ty,this}equals(a){return a.a===this.a&&a.b===this.b&&a.c===this.c&&a.d===this.d&&a.tx===this.tx&&a.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return h.identity()}static get shared(){return g.identity()}}let g=new f,h=new f},49194:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81921,23))},50139:(a,b,c)=>{"use strict";c.d(b,{n:()=>f});var d=c(48419),e=c(11630);function f(a,b,c){return b.clear(),c||(c=d.u.IDENTITY),function a(b,c,f,g,h){let i;if(h)i=e.u.get(),i=f.copyTo(i);else{if(!b.visible||!b.measurable)return;b.updateLocalTransform();let a=b.localTransform;(i=e.u.get()).appendFrom(a,f)}let j=c,k=!!b.effects.length;if(k&&(c=e.o.get().clear()),b.boundsArea)c.addRect(b.boundsArea,i);else{b.renderPipeId&&(c.matrix=i,c.addBounds(b.bounds));let d=b.children;for(let b=0;b<d.length;b++)a(d[b],c,i,g,!1)}if(k){for(let a=0;a<b.effects.length;a++)b.effects[a].addLocalBounds?.(c,g);j.addBounds(c,d.u.IDENTITY),e.o.return(c)}e.u.return(i)}(a,b,c,a,!0),b.isValid||b.set(0,0,0,0),b}},54497:(a,b,c)=>{"use strict";c.d(b,{x:()=>n});var d=c(57680),e=c(66242),f=c(42115),g=c(71568),h=c(87818),i=c(41890),j=c(45464),k=c(73866),l=c(56488);let m=class a extends d.A{constructor(b={}){super(),this.uid=(0,f.L)("textStyle"),this._tick=0,function(a){if("boolean"==typeof a.dropShadow&&a.dropShadow){let b=n.defaultDropShadow;a.dropShadow={alpha:a.dropShadowAlpha??b.alpha,angle:a.dropShadowAngle??b.angle,blur:a.dropShadowBlur??b.blur,color:a.dropShadowColor??b.color,distance:a.dropShadowDistance??b.distance}}if(void 0!==a.strokeThickness){(0,g.t6)(g.lj,"strokeThickness is now a part of stroke");let b=a.stroke,c={};if(e.Q.isColorLike(b))c.color=b;else if(b instanceof i._||b instanceof j.m)c.fill=b;else if(Object.hasOwnProperty.call(b,"color")||Object.hasOwnProperty.call(b,"fill"))c=b;else throw Error("Invalid stroke value.");a.stroke={...c,width:a.strokeThickness}}if(Array.isArray(a.fillGradientStops)){if((0,g.t6)(g.lj,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(a.fill)||0===a.fill.length)throw Error("Invalid fill value. Expected an array of colors for gradient fill.");a.fill.length!==a.fillGradientStops.length&&(0,h.R)("The number of fill colors must match the number of fill gradient stops.");let b=new i._({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),c=a.fillGradientStops.slice(),d=a.fill.map(a=>e.Q.shared.setValue(a).toNumber());c.forEach((a,c)=>{b.addColorStop(a,d[c])}),a.fill={fill:b}}}(b);const c={...a.defaultTextStyle,...b};for(const a in c)this[a]=c[a];this.update(),this._tick=0}get align(){return this._align}set align(a){this._align!==a&&(this._align=a,this.update())}get breakWords(){return this._breakWords}set breakWords(a){this._breakWords!==a&&(this._breakWords=a,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(b){this._dropShadow!==b&&(null!==b&&"object"==typeof b?this._dropShadow=this._createProxy({...a.defaultDropShadow,...b}):this._dropShadow=b?this._createProxy({...a.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(a){this._fontFamily!==a&&(this._fontFamily=a,this.update())}get fontSize(){return this._fontSize}set fontSize(a){this._fontSize!==a&&("string"==typeof a?this._fontSize=parseInt(a,10):this._fontSize=a,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(a){this._fontStyle!==a&&(this._fontStyle=a.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(a){this._fontVariant!==a&&(this._fontVariant=a,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(a){this._fontWeight!==a&&(this._fontWeight=a,this.update())}get leading(){return this._leading}set leading(a){this._leading!==a&&(this._leading=a,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(a){this._letterSpacing!==a&&(this._letterSpacing=a,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(a){this._lineHeight!==a&&(this._lineHeight=a,this.update())}get padding(){return this._padding}set padding(a){this._padding!==a&&(this._padding=a,this.update())}get filters(){return this._filters}set filters(a){this._filters!==a&&(this._filters=Object.freeze(a),this.update())}get trim(){return this._trim}set trim(a){this._trim!==a&&(this._trim=a,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(a){this._textBaseline!==a&&(this._textBaseline=a,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(a){this._whiteSpace!==a&&(this._whiteSpace=a,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(a){this._wordWrap!==a&&(this._wordWrap=a,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(a){this._wordWrapWidth!==a&&(this._wordWrapWidth=a,this.update())}get fill(){return this._originalFill}set fill(a){a!==this._originalFill&&(this._originalFill=a,this._isFillStyle(a)&&(this._originalFill=this._createProxy({...k.T.defaultFillStyle,...a},()=>{this._fill=(0,l.w)({...this._originalFill},k.T.defaultFillStyle)})),this._fill=(0,l.w)(0===a?"black":a,k.T.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(a){a!==this._originalStroke&&(this._originalStroke=a,this._isFillStyle(a)&&(this._originalStroke=this._createProxy({...k.T.defaultStrokeStyle,...a},()=>{this._stroke=(0,l.T)({...this._originalStroke},k.T.defaultStrokeStyle)})),this._stroke=(0,l.T)(a,k.T.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){let b=a.defaultTextStyle;for(let a in b)this[a]=b[a]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new a({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let a=0;if(this._filters)for(let b=0;b<this._filters.length;b++)a+=this._filters[b].padding;return Math.max(this._padding,a)}destroy(a=!1){if(this.removeAllListeners(),"boolean"==typeof a?a:a?.texture){let b="boolean"==typeof a?a:a?.textureSource;this._fill?.texture&&this._fill.texture.destroy(b),this._originalFill?.texture&&this._originalFill.texture.destroy(b),this._stroke?.texture&&this._stroke.texture.destroy(b),this._originalStroke?.texture&&this._originalStroke.texture.destroy(b)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(a,b){return new Proxy(a,{set:(a,c,d)=>a[c]===d||(a[c]=d,b?.(c,d),this.update(),!0)})}_isFillStyle(a){return(a??null)!==null&&!(e.Q.isColorLike(a)||a instanceof i._||a instanceof j.m)}};m.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},m.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let n=m},54894:(a,b,c)=>{"use strict";c.d(b,{gy:()=>g,mj:()=>f});var d=c(92913);let e="last_project_id";function f(){let a;return a=(0,d.L)().prepare("SELECT value FROM app_state WHERE key = ?").get(e),a?.value??null}function g(a){let b;b=(0,d.L)(),null===a?b.prepare("DELETE FROM app_state WHERE key = ?").run(e):b.prepare(`INSERT INTO app_state (key, value, updated_at)
     VALUES (?, ?, ?)
     ON CONFLICT(key) DO UPDATE SET
       value=excluded.value,
       updated_at=excluded.updated_at`).run(e,a,new Date().toISOString())}},54977:(a,b,c)=>{"use strict";c.d(b,{E:()=>l});var d=c(48419);let e=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],f=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],g=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],h=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],i=[],j=[],k=Math.sign;!function(){for(let a=0;a<16;a++){let b=[];i.push(b);for(let c=0;c<16;c++){let d=k(e[a]*e[c]+g[a]*f[c]),i=k(f[a]*e[c]+h[a]*f[c]),j=k(e[a]*g[c]+g[a]*h[c]),l=k(f[a]*g[c]+h[a]*h[c]);for(let a=0;a<16;a++)if(e[a]===d&&f[a]===i&&g[a]===j&&h[a]===l){b.push(a);break}}}for(let a=0;a<16;a++){let b=new d.u;b.set(e[a],f[a],g[a],h[a],0,0),j.push(b)}}();let l={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:a=>e[a],uY:a=>f[a],vX:a=>g[a],vY:a=>h[a],inv:a=>8&a?15&a:7&-a,add:(a,b)=>i[a][b],sub:(a,b)=>i[a][l.inv(b)],rotate180:a=>4^a,isVertical:a=>(3&a)==2,byDirection:(a,b)=>2*Math.abs(a)<=Math.abs(b)?b>=0?l.S:l.N:2*Math.abs(b)<=Math.abs(a)?a>0?l.E:l.W:b>0?a>0?l.SE:l.SW:a>0?l.NE:l.NW,matrixAppendRotationInv:(a,b,c=0,d=0)=>{let e=j[l.inv(b)];e.tx=c,e.ty=d,a.append(e)},transformRectCoords:(a,b,c,d)=>{let{x:e,y:f,width:g,height:h}=a,{x:i,y:j,width:k,height:m}=b;return c===l.E?(d.set(e+i,f+j,g,h),d):c===l.S?d.set(k-f-h+i,e+j,h,g):c===l.W?d.set(k-e-g+i,m-f-h+j,g,h):c===l.N?d.set(f+i,m-e-g+j,h,g):d.set(e+i,f+j,g,h)}}},56488:(a,b,c)=>{"use strict";c.d(b,{T:()=>m,w:()=>l});var d=c(66242),e=c(61487),f=c(41890),g=c(45464);function h(a){return a instanceof g.m}function i(a){return a instanceof f._}function j(a,b,c){return a.fill=b,a.color=0xffffff,a.texture=b.texture,a.matrix=b.transform,{...c,...a}}function k(a,b,c){return b.buildGradient(),a.fill=b,a.color=0xffffff,a.texture=b.texture,a.matrix=b.transform,a.textureSpace=b.textureSpace,{...c,...a}}function l(a,b){let c,f;if(null==a)return null;let g={};if(d.Q.isColorLike(a)){let c;return g.color=(c=d.Q.shared.setValue(a??0)).toNumber(),g.alpha=1===c.alpha?b.alpha:c.alpha,g.texture=e.g.WHITE,{...b,...g}}if(a instanceof e.g)return g.texture=a,{...b,...g};if(h(a))return j(g,a,b);if(i(a))return k(g,a,b);else if(a.fill&&h(a.fill))return j(a,a.fill,b);else if(a.fill&&i(a.fill))return k(a,a.fill,b);return c={...b,...a},f=d.Q.shared.setValue(c.color),c.alpha*=f.alpha,c.color=f.toNumber(),c}function m(a,b){let{width:c,alignment:d,miterLimit:e,cap:f,join:g,pixelLine:h,...i}=b,j=l(a,i);return j?{width:c,alignment:d,miterLimit:e,cap:f,join:g,pixelLine:h,...j}:null}},57266:(a,b,c)=>{"use strict";c.d(b,{r:()=>j});var d=c(66242),e=c(48419),f=c(61487),g=c(87818),h=c(41890),i=c(45464);function j(a,b,c,k=0){if(a.texture===f.g.WHITE&&!a.fill)return d.Q.shared.setValue(a.color).setAlpha(a.alpha??1).toHexa();if(a.fill){if(a.fill instanceof i.m){let c=a.fill,d=b.createPattern(c.texture.source.resource,"repeat"),f=c.transform.copyTo(e.u.shared);return f.scale(c.texture.frame.width,c.texture.frame.height),d.setTransform(f),d}else if(a.fill instanceof h._){let e,f=a.fill,g="linear"===f.type,h="local"===f.textureSpace,i=1,j=1;h&&c&&(i=c.width+k,j=c.height+k);let l=!1;if(g){let{start:a,end:c}=f;e=b.createLinearGradient(a.x*i,a.y*j,c.x*i,c.y*j),l=Math.abs(c.x-a.x)<Math.abs((c.y-a.y)*.1)}else{let{center:a,innerRadius:c,outerCenter:d,outerRadius:g}=f;e=b.createRadialGradient(a.x*i,a.y*j,c*i,d.x*i,d.y*j,g*i)}if(l&&h&&c){let a=c.lineHeight/j;for(let b=0;b<c.lines.length;b++){let g=(b*c.lineHeight+k/2)/j;f.colorStops.forEach(b=>{let c=g+b.offset*a;e.addColorStop(Math.floor(1e5*c)/1e5,d.Q.shared.setValue(b.color).toHex())})}}else f.colorStops.forEach(a=>{e.addColorStop(a.offset,d.Q.shared.setValue(a.color).toHex())});return e}}else{let c=b.createPattern(a.texture.source.resource,"repeat"),d=a.matrix.copyTo(e.u.shared);return d.scale(a.texture.frame.width,a.texture.frame.height),c.setTransform(d),c}return(0,g.R)("FillStyle not recognised",a),"red"}},57680:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=c(80639)},60056:(a,b,c)=>{"use strict";c.d(b,{Z:()=>e});let d=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function e(a){let b="number"==typeof a.fontSize?`${a.fontSize}px`:a.fontSize,c=a.fontFamily;Array.isArray(a.fontFamily)||(c=a.fontFamily.split(","));for(let a=c.length-1;a>=0;a--){let b=c[a].trim();/([\"\'])[^\'\"]+\1/.test(b)||d.includes(b)||(b=`"${b}"`),c[a]=b}return`${a.fontStyle} ${a.fontVariant} ${a.fontWeight} ${b} ${c.join(",")}`}},61135:()=>{},61328:(a,b,c)=>{"use strict";c.d(b,{d:()=>e});var d,e=((d=e||{})[d.INTERACTION=50]="INTERACTION",d[d.HIGH=25]="HIGH",d[d.NORMAL=0]="NORMAL",d[d.LOW=-25]="LOW",d[d.UTILITY=-50]="UTILITY",d)},61487:(a,b,c)=>{"use strict";c.d(b,{g:()=>m});var d=c(57680),e=c(54977),f=c(91546),g=c(42115),h=c(71568);let i=()=>{};var j=c(2233),k=c(93141),l=c(84434);class m extends d.A{constructor({source:a,label:b,frame:c,orig:d,trim:e,defaultAnchor:h,defaultBorders:i,rotate:j,dynamic:l}={}){if(super(),this.uid=(0,g.L)("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new f.M,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=b,this.source=a?.source??new k.v,this.noFrame=!c,c)this.frame.copyFrom(c);else{const{width:a,height:b}=this._source;this.frame.width=a,this.frame.height=b}this.orig=d||this.frame,this.trim=e,this.rotate=j??0,this.defaultAnchor=h,this.defaultBorders=i,this.destroyed=!1,this.dynamic=l||!1,this.updateUvs()}set source(a){this._source&&this._source.off("resize",this.update,this),this._source=a,a.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new l.N(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){let{uvs:a,frame:b}=this,{width:c,height:d}=this._source,f=b.x/c,g=b.y/d,h=b.width/c,i=b.height/d,j=this.rotate;if(j){let b=h/2,c=i/2,d=f+b,k=g+c;j=e.E.add(j,e.E.NW),a.x0=d+b*e.E.uX(j),a.y0=k+c*e.E.uY(j),j=e.E.add(j,2),a.x1=d+b*e.E.uX(j),a.y1=k+c*e.E.uY(j),j=e.E.add(j,2),a.x2=d+b*e.E.uX(j),a.y2=k+c*e.E.uY(j),j=e.E.add(j,2),a.x3=d+b*e.E.uX(j),a.y3=k+c*e.E.uY(j)}else a.x0=f,a.y0=g,a.x1=f+h,a.y1=g,a.x2=f+h,a.y2=g+i,a.x3=f,a.y3=g+i}destroy(a=!1){this._source&&(this._source.off("resize",this.update,this),a&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return(0,h.t6)(h.lj,"Texture.baseTexture is now Texture.source"),this._source}}m.EMPTY=new m({label:"EMPTY",source:new k.v({label:"EMPTY"})}),m.EMPTY.destroy=i,m.WHITE=new m({source:new j.P({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"}),m.WHITE.destroy=i},62503:(a,b,c)=>{Promise.resolve().then(c.bind(c,37195))},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63598:(a,b,c)=>{"use strict";function d(a,b){return 0xffffff!==a&&b?0xffffff!==b&&a?((a>>16&255)*(b>>16&255)/255<<16)+((a>>8&255)*(b>>8&255)/255<<8)+((255&a)*(255&b)/255|0):a:b}c.d(b,{u:()=>d})},64974:(a,b,c)=>{"use strict";c.d(b,{mc:()=>J,u:()=>H,ig:()=>G,fR:()=>I});var d=c(57680),e=c(66242),f=c(45753),g=c(48419),h=c(28514),i=c(8542),j=c(42115),k=c(71568),l=c(87818),m=c(6672),n=c(37753),o=c(65151);class p{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(a=>{this.add({test:a.test,maskClass:a})}))}add(a){this._tests.push(a)}getMaskEffect(a){this._initialized||this.init();for(let b=0;b<this._tests.length;b++){let c=this._tests[b];if(c.test(a))return m.Z.get(c.maskClass,a)}return a}returnMaskEffect(a){m.Z.return(a)}}let q=new p;f.XO.handleByList(f.Ag.MaskEffect,q._effectClasses);var r=c(87790),s=c(11630);let t=new g.u;var u=c(33349),v=c(28383);function w(a){return((255&a)<<16)+(65280&a)+(a>>16&255)}var x=c(50139);let y=new g.u;function z(a,b){return a._zIndex-b._zIndex}var A=c(21783),B=c(92602);let C=new i.o(null),D=new i.o(null),E=new i.o(null,1,1),F=new i.o(null),G=1,H=2,I=4;class J extends d.A{constructor(a={}){super(),this.uid=(0,j.L)("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new g.u,this.relativeGroupTransform=new g.u,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new i.o(this,0,0),this._scale=E,this._pivot=D,this._origin=F,this._skew=C,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=0xffffff,this.localAlpha=1,this.groupAlpha=1,this.groupColor=0xffffff,this.groupColorAlpha=0xffffffff,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],function(a,b,c={}){for(let d in b)c[d]||void 0===b[d]||(a[d]=b[d])}(this,a,{children:!0,parent:!0,effects:!0}),a.children?.forEach(a=>this.addChild(a)),a.parent?.addChild(this)}static mixin(a){(0,k.t6)("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),f.XO.mixin(J,a)}set _didChangeId(a){this._didViewChangeTick=a>>12&4095,this._didContainerChangeTick=4095&a}get _didChangeId(){return 4095&this._didContainerChangeTick|(4095&this._didViewChangeTick)<<12}addChild(...a){if(this.allowChildren||(0,k.t6)(k.lj,"addChild: Only Containers will be allowed to add children in v8.0.0"),a.length>1){for(let b=0;b<a.length;b++)this.addChild(a[b]);return a[0]}let b=a[0],c=this.renderGroup||this.parentRenderGroup;return b.parent===this?(this.children.splice(this.children.indexOf(b),1),this.children.push(b),c&&(c.structureDidChange=!0)):(b.parent&&b.parent.removeChild(b),this.children.push(b),this.sortableChildren&&(this.sortDirty=!0),b.parent=this,b.didChange=!0,b._updateFlags=15,c&&c.addChild(b),this.emit("childAdded",b,this,this.children.length-1),b.emit("added",this),this._didViewChangeTick++,0!==b._zIndex&&b.depthOfChildModified()),b}removeChild(...a){if(a.length>1){for(let b=0;b<a.length;b++)this.removeChild(a[b]);return a[0]}let b=a[0],c=this.children.indexOf(b);return c>-1&&(this._didViewChangeTick++,this.children.splice(c,1),this.renderGroup?this.renderGroup.removeChild(b):this.parentRenderGroup&&this.parentRenderGroup.removeChild(b),b.parentRenderLayer&&b.parentRenderLayer.detach(b),b.parent=null,this.emit("childRemoved",b,this,c),b.emit("removed",this)),b}_onUpdate(a){a&&a===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(a){!!this.renderGroup!==a&&(a?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;let a=this.parentRenderGroup;a?.removeChild(this),this.renderGroup=m.Z.get(B.m,this),this.groupTransform=g.u.IDENTITY,a?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;let a=this.parentRenderGroup;a?.removeChild(this),m.Z.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,a?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&0===this.effects.length}get worldTransform(){return this._worldTransform||(this._worldTransform=new g.u),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(a){this._position.x=a}get y(){return this._position.y}set y(a){this._position.y=a}get position(){return this._position}set position(a){this._position.copyFrom(a)}get rotation(){return this._rotation}set rotation(a){this._rotation!==a&&(this._rotation=a,this._onUpdate(this._skew))}get angle(){return this.rotation*h.bO}set angle(a){this.rotation=a*h.Td}get pivot(){return this._pivot===D&&(this._pivot=new i.o(this,0,0)),this._pivot}set pivot(a){this._pivot===D&&(this._pivot=new i.o(this,0,0),this._origin!==F&&(0,l.R)("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),"number"==typeof a?this._pivot.set(a):this._pivot.copyFrom(a)}get skew(){return this._skew===C&&(this._skew=new i.o(this,0,0)),this._skew}set skew(a){this._skew===C&&(this._skew=new i.o(this,0,0)),this._skew.copyFrom(a)}get scale(){return this._scale===E&&(this._scale=new i.o(this,1,1)),this._scale}set scale(a){this._scale===E&&(this._scale=new i.o(this,0,0)),"string"==typeof a&&(a=parseFloat(a)),"number"==typeof a?this._scale.set(a):this._scale.copyFrom(a)}get origin(){return this._origin===F&&(this._origin=new i.o(this,0,0)),this._origin}set origin(a){this._origin===F&&(this._origin=new i.o(this,0,0),this._pivot!==D&&(0,l.R)("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),"number"==typeof a?this._origin.set(a):this._origin.copyFrom(a)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(a){let b=this.getLocalBounds().width;this._setWidth(a,b)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(a){let b=this.getLocalBounds().height;this._setHeight(a,b)}getSize(a){a||(a={});let b=this.getLocalBounds();return a.width=Math.abs(this.scale.x*b.width),a.height=Math.abs(this.scale.y*b.height),a}setSize(a,b){let c=this.getLocalBounds();"object"==typeof a?(b=a.height??a.width,a=a.width):b??(b=a),void 0!==a&&this._setWidth(a,c.width),void 0!==b&&this._setHeight(b,c.height)}_updateSkew(){let a=this._rotation,b=this._skew;this._cx=Math.cos(a+b._y),this._sx=Math.sin(a+b._y),this._cy=-Math.sin(a-b._x),this._sy=Math.cos(a-b._x)}updateTransform(a){return this.position.set("number"==typeof a.x?a.x:this.position.x,"number"==typeof a.y?a.y:this.position.y),this.scale.set("number"==typeof a.scaleX?a.scaleX||1:this.scale.x,"number"==typeof a.scaleY?a.scaleY||1:this.scale.y),this.rotation="number"==typeof a.rotation?a.rotation:this.rotation,this.skew.set("number"==typeof a.skewX?a.skewX:this.skew.x,"number"==typeof a.skewY?a.skewY:this.skew.y),this.pivot.set("number"==typeof a.pivotX?a.pivotX:this.pivot.x,"number"==typeof a.pivotY?a.pivotY:this.pivot.y),this.origin.set("number"==typeof a.originX?a.originX:this.origin.x,"number"==typeof a.originY?a.originY:this.origin.y),this}setFromMatrix(a){a.decompose(this)}updateLocalTransform(){let a=this._didContainerChangeTick;if(this._didLocalTransformChangeId===a)return;this._didLocalTransformChangeId=a;let b=this.localTransform,c=this._scale,d=this._pivot,e=this._origin,f=this._position,g=c._x,h=c._y,i=d._x,j=d._y,k=-e._x,l=-e._y;b.a=this._cx*g,b.b=this._sx*g,b.c=this._cy*h,b.d=this._sy*h,b.tx=f._x-(i*b.a+j*b.c)+(k*b.a+l*b.c)-k,b.ty=f._y-(i*b.b+j*b.d)+(k*b.b+l*b.d)-l}set alpha(a){a!==this.localAlpha&&(this.localAlpha=a,this._updateFlags|=G,this._onUpdate())}get alpha(){return this.localAlpha}set tint(a){let b=e.Q.shared.setValue(a??0xffffff).toBgrNumber();b!==this.localColor&&(this.localColor=b,this._updateFlags|=G,this._onUpdate())}get tint(){return w(this.localColor)}set blendMode(a){this.localBlendMode!==a&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=H,this.localBlendMode=a,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(2&this.localDisplayStatus)}set visible(a){(2&this.localDisplayStatus)!=2*!!a&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=I,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(4&this.localDisplayStatus)}set culled(a){(4&this.localDisplayStatus)!=4*!a&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=I,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(1&this.localDisplayStatus)}set renderable(a){(1&this.localDisplayStatus)!=+!!a&&(this._updateFlags|=I,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return 7===this.localDisplayStatus&&this.groupAlpha>0}destroy(a=!1){let b;if(!this.destroyed){if(this.destroyed=!0,this.children.length&&(b=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),("boolean"==typeof a?a:a?.children)&&b)for(let c=0;c<b.length;++c)b[c].destroy(a);this.renderGroup?.destroy(),this.renderGroup=null}}}f.XO.mixin(J,{allowChildren:!0,removeChildren(a=0,b){let c=b??this.children.length,d=c-a,e=[];if(d>0&&d<=c){for(let b=c-1;b>=a;b--){let a=this.children[b];a&&(e.push(a),a.parent=null)}(0,n.d)(this.children,a,c);let b=this.renderGroup||this.parentRenderGroup;b&&b.removeChildren(e);for(let a=0;a<e.length;++a){let b=e[a];b.parentRenderLayer?.detach(b),this.emit("childRemoved",b,this,a),e[a].emit("removed",this)}return e.length>0&&this._didViewChangeTick++,e}if(0===d&&0===this.children.length)return e;throw RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(a){let b=this.getChildAt(a);return this.removeChild(b)},getChildAt(a){if(a<0||a>=this.children.length)throw Error(`getChildAt: Index (${a}) does not exist.`);return this.children[a]},setChildIndex(a,b){if(b<0||b>=this.children.length)throw Error(`The index ${b} supplied is out of bounds ${this.children.length}`);this.getChildIndex(a),this.addChildAt(a,b)},getChildIndex(a){let b=this.children.indexOf(a);if(-1===b)throw Error("The supplied Container must be a child of the caller");return b},addChildAt(a,b){this.allowChildren||(0,k.t6)(k.lj,"addChildAt: Only Containers will be allowed to add children in v8.0.0");let{children:c}=this;if(b<0||b>c.length)throw Error(`${a}addChildAt: The index ${b} supplied is out of bounds ${c.length}`);if(a.parent){let c=a.parent.children.indexOf(a);if(a.parent===this&&c===b)return a;-1!==c&&a.parent.children.splice(c,1)}b===c.length?c.push(a):c.splice(b,0,a),a.parent=this,a.didChange=!0,a._updateFlags=15;let d=this.renderGroup||this.parentRenderGroup;return d&&d.addChild(a),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",a,this,b),a.emit("added",this),a},swapChildren(a,b){if(a===b)return;let c=this.getChildIndex(a),d=this.getChildIndex(b);this.children[c]=b,this.children[d]=a;let e=this.renderGroup||this.parentRenderGroup;e&&(e.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...a){return 1===a.length?this.reparentChildAt(a[0],this.children.length):(a.forEach(a=>this.reparentChildAt(a,this.children.length)),a[0])},reparentChildAt(a,b){if(a.parent===this)return this.setChildIndex(a,b),a;let c=a.worldTransform.clone();a.removeFromParent(),this.addChildAt(a,b);let d=this.worldTransform.clone();return d.invert(),c.prepend(d),a.setFromMatrix(c),a},replaceChild(a,b){a.updateLocalTransform(),this.addChildAt(b,this.getChildIndex(a)),b.setFromMatrix(a.localTransform),b.updateLocalTransform(),this.removeChild(a)}},{getFastGlobalBounds(a,b){b||(b=new r.c),b.clear(),this._getGlobalBoundsRecursive(!!a,b,this.parentRenderLayer),b.isValid||b.set(0,0,0,0);let c=this.renderGroup||this.parentRenderGroup;return b.applyMatrix(c.worldTransform),b},_getGlobalBoundsRecursive(a,b,c){let d=b;if(a&&this.parentRenderLayer&&this.parentRenderLayer!==c||7!==this.localDisplayStatus||!this.measurable)return;let e=!!this.effects.length;if((this.renderGroup||e)&&(d=s.o.get().clear()),this.boundsArea)b.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){let a=this.bounds;d.addFrame(a.minX,a.minY,a.maxX,a.maxY,this.groupTransform)}let b=this.children;for(let e=0;e<b.length;e++)b[e]._getGlobalBoundsRecursive(a,d,c)}if(e){let a=!1,c=this.renderGroup||this.parentRenderGroup;for(let b=0;b<this.effects.length;b++)this.effects[b].addBounds&&(a||(a=!0,d.applyMatrix(c.worldTransform)),this.effects[b].addBounds(d,!0));a&&d.applyMatrix(c.worldTransform.copyTo(t).invert()),b.addBounds(d),s.o.return(d)}else this.renderGroup&&(b.addBounds(d,this.relativeGroupTransform),s.o.return(d))}},{getGlobalPosition(a=new A.b,b=!1){return this.parent?this.parent.toGlobal(this._position,a,b):(a.x=this._position.x,a.y=this._position.y),a},toGlobal(a,b,c=!1){let d=this.getGlobalTransform(s.u.get(),c);return b=d.apply(a,b),s.u.return(d),b},toLocal(a,b,c,d){b&&(a=b.toGlobal(a,c,d));let e=this.getGlobalTransform(s.u.get(),d);return c=e.applyInverse(a,c),s.u.return(e),c}},{_onRender:null,set onRender(func){let a=this.renderGroup||this.parentRenderGroup;if(!func){this._onRender&&a?.removeOnRender(this),this._onRender=null;return}this._onRender||a?.addOnRender(this),this._onRender=func},get onRender(){return this._onRender}},{_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(a,b){let c=Math.sign(this.scale.x)||1;0!==b?this.scale.x=a/b*c:this.scale.x=c},_setHeight(a,b){let c=Math.sign(this.scale.y)||1;0!==b?this.scale.y=a/b*c:this.scale.y=c},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new r.c});let a=this._localBoundsCacheData;return a.index=1,a.didChange=!1,a.data[0]!==this._didViewChangeTick&&(a.didChange=!0,a.data[0]=this._didViewChangeTick),!function a(b,c){let d=b.children;for(let b=0;b<d.length;b++){let e=d[b],f=e.uid,g=(65535&e._didViewChangeTick)<<16|65535&e._didContainerChangeTick,h=c.index;(c.data[h]!==f||c.data[h+1]!==g)&&(c.data[c.index]=f,c.data[c.index+1]=g,c.didChange=!0),c.index=h+2,e.children.length&&a(e,c)}return c.didChange}(this,a),a.didChange&&(0,x.n)(this,a.localBounds,y),a.localBounds},getBounds(a,b){return(0,u.f)(this,a,b||new r.c)}},{_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){let a=this.renderGroup||this.parentRenderGroup;a&&(a.structureDidChange=!0)},addEffect(a){-1===this.effects.indexOf(a)&&(this.effects.push(a),this.effects.sort((a,b)=>a.priority-b.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(a){let b=this.effects.indexOf(a);-1!==b&&(this.effects.splice(b,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(value){let a=this._maskEffect;if(a?.mask===value||(a&&(this.removeEffect(a),q.returnMaskEffect(a),this._maskEffect=null),null==value))return;this._maskEffect=q.getMaskEffect(value),this.addEffect(this._maskEffect)},get mask(){return this._maskEffect?.mask},setMask(a){this._maskOptions={...this._maskOptions,...a},a.mask&&(this.mask=a.mask),this._markStructureAsChanged()},set filters(value){!Array.isArray(value)&&value&&(value=[value]);let a=this._filterEffect||(this._filterEffect=new o.a),b=value?.length>0,c=a.filters?.length>0;a.filters=Object.freeze(value=Array.isArray(value)?value.slice(0):value),b!==c&&(b?this.addEffect(a):(this.removeEffect(a),a.filters=value??null))},get filters(){return this._filterEffect?.filters},set filterArea(value){this._filterEffect||(this._filterEffect=new o.a),this._filterEffect.filterArea=value},get filterArea(){return this._filterEffect?.filterArea}},{label:null,get name(){return(0,k.t6)(k.lj,"Container.name property has been removed, use Container.label instead"),this.label},set name(value){(0,k.t6)(k.lj,"Container.name property has been removed, use Container.label instead"),this.label=value},getChildByName(a,b=!1){return this.getChildByLabel(a,b)},getChildByLabel(a,b=!1){let c=this.children;for(let b=0;b<c.length;b++){let d=c[b];if(d.label===a||a instanceof RegExp&&a.test(d.label))return d}if(b)for(let b=0;b<c.length;b++){let d=c[b].getChildByLabel(a,!0);if(d)return d}return null},getChildrenByLabel(a,b=!1,c=[]){let d=this.children;for(let b=0;b<d.length;b++){let e=d[b];(e.label===a||a instanceof RegExp&&a.test(e.label))&&c.push(e)}if(b)for(let b=0;b<d.length;b++)d[b].getChildrenByLabel(a,!0,c);return c}},{_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(value){if(this._zIndex===value)return;this._zIndex=value,this.depthOfChildModified()},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(z))}},{cullArea:null,cullable:!1,cullableChildren:!0},{get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(a){"boolean"==typeof a&&!1===a?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(!0===a?{}:a))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(val){(0,k.t6)("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(val)}},{getGlobalAlpha(a){if(a)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let b=this.alpha,c=this.parent;for(;c;)b*=c.alpha,c=c.parent;return b},getGlobalTransform(a=new g.u,b){if(b)return a.copyFrom(this.worldTransform);this.updateLocalTransform();let c=(0,u.E)(this,s.u.get().identity());return a.appendFrom(this.localTransform,c),s.u.return(c),a},getGlobalTint(a){if(a)return this.renderGroup?w(this.renderGroup.worldColor):this.parentRenderGroup?w((0,v.j)(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let b=this.localColor,c=this.parent;for(;c;)b=(0,v.j)(b,c.localColor),c=c.parent;return w(b)}},{collectRenderables(a,b,c){this.parentRenderLayer&&this.parentRenderLayer!==c||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(a,b,c):this.renderGroup?b.renderPipes.renderGroup.addRenderGroup(this.renderGroup,a):this.collectRenderablesWithEffects(a,b,c))},collectRenderablesSimple(a,b,c){let d=this.children,e=d.length;for(let f=0;f<e;f++)d[f].collectRenderables(a,b,c)},collectRenderablesWithEffects(a,b,c){let{renderPipes:d}=b;for(let b=0;b<this.effects.length;b++){let c=this.effects[b];d[c.pipe].push(c,this,a)}this.collectRenderablesSimple(a,b,c);for(let b=this.effects.length-1;b>=0;b--){let c=this.effects[b];d[c.pipe].pop(c,this,a)}}})},65151:(a,b,c)=>{"use strict";c.d(b,{a:()=>d});class d{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let a=0;a<this.filters.length;a++)this.filters[a].destroy();this.filters=null,this.filterArea=null}}},66242:(a,b,c)=>{"use strict";c.d(b,{Q:()=>F});var d={grad:.9,turn:360,rad:360/(2*Math.PI)},e=function(a){return"string"==typeof a?a.length>0:"number"==typeof a},f=function(a,b,c){return void 0===b&&(b=0),void 0===c&&(c=Math.pow(10,b)),Math.round(c*a)/c+0},g=function(a,b,c){return void 0===b&&(b=0),void 0===c&&(c=1),a>c?c:a>b?a:b},h=function(a){return(a=isFinite(a)?a%360:0)>0?a:a+360},i=function(a){return{r:g(a.r,0,255),g:g(a.g,0,255),b:g(a.b,0,255),a:g(a.a)}},j=function(a){return{r:f(a.r),g:f(a.g),b:f(a.b),a:f(a.a,3)}},k=/^#([0-9a-f]{3,8})$/i,l=function(a){var b=a.toString(16);return b.length<2?"0"+b:b},m=function(a){var b=a.r,c=a.g,d=a.b,e=a.a,f=Math.max(b,c,d),g=f-Math.min(b,c,d),h=g?f===b?(c-d)/g:f===c?2+(d-b)/g:4+(b-c)/g:0;return{h:60*(h<0?h+6:h),s:f?g/f*100:0,v:f/255*100,a:e}},n=function(a){var b=a.h,c=a.s,d=a.v,e=a.a;b=b/360*6,c/=100,d/=100;var f=Math.floor(b),g=d*(1-c),h=d*(1-(b-f)*c),i=d*(1-(1-b+f)*c),j=f%6;return{r:255*[d,h,g,g,i,d][j],g:255*[i,d,d,h,g,g][j],b:255*[g,g,i,d,d,h][j],a:e}},o=function(a){return{h:h(a.h),s:g(a.s,0,100),l:g(a.l,0,100),a:g(a.a)}},p=function(a){return{h:f(a.h),s:f(a.s),l:f(a.l),a:f(a.a,3)}},q=function(a){var b,c;return n((b=a.s,{h:a.h,s:(b*=((c=a.l)<50?c:100-c)/100)>0?2*b/(c+b)*100:0,v:c+b,a:a.a}))},r=function(a){var b,c,d,e;return{h:(b=m(a)).h,s:(e=(200-(c=b.s))*(d=b.v)/100)>0&&e<200?c*d/100/(e<=100?e:200-e)*100:0,l:e/2,a:b.a}},s=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,t=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,u=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,w={string:[[function(a){var b=k.exec(a);return b?(a=b[1]).length<=4?{r:parseInt(a[0]+a[0],16),g:parseInt(a[1]+a[1],16),b:parseInt(a[2]+a[2],16),a:4===a.length?f(parseInt(a[3]+a[3],16)/255,2):1}:6===a.length||8===a.length?{r:parseInt(a.substr(0,2),16),g:parseInt(a.substr(2,2),16),b:parseInt(a.substr(4,2),16),a:8===a.length?f(parseInt(a.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(a){var b=u.exec(a)||v.exec(a);return b?b[2]!==b[4]||b[4]!==b[6]?null:i({r:Number(b[1])/(b[2]?100/255:1),g:Number(b[3])/(b[4]?100/255:1),b:Number(b[5])/(b[6]?100/255:1),a:void 0===b[7]?1:Number(b[7])/(b[8]?100:1)}):null},"rgb"],[function(a){var b,c,e=s.exec(a)||t.exec(a);return e?q(o({h:(b=e[1],void 0===(c=e[2])&&(c="deg"),Number(b)*(d[c]||1)),s:Number(e[3]),l:Number(e[4]),a:void 0===e[5]?1:Number(e[5])/(e[6]?100:1)})):null},"hsl"]],object:[[function(a){var b=a.r,c=a.g,d=a.b,f=a.a;return e(b)&&e(c)&&e(d)?i({r:Number(b),g:Number(c),b:Number(d),a:Number(void 0===f?1:f)}):null},"rgb"],[function(a){var b=a.h,c=a.s,d=a.l,f=a.a;return e(b)&&e(c)&&e(d)?q(o({h:Number(b),s:Number(c),l:Number(d),a:Number(void 0===f?1:f)})):null},"hsl"],[function(a){var b,c=a.h,d=a.s,f=a.v,i=a.a;return e(c)&&e(d)&&e(f)?n({h:h((b={h:Number(c),s:Number(d),v:Number(f),a:Number(void 0===i?1:i)}).h),s:g(b.s,0,100),v:g(b.v,0,100),a:g(b.a)}):null},"hsv"]]},x=function(a,b){for(var c=0;c<b.length;c++){var d=b[c][0](a);if(d)return[d,b[c][1]]}return[null,void 0]},y=function(a,b){var c=r(a);return{h:c.h,s:g(c.s+100*b,0,100),l:c.l,a:c.a}},z=function(a){return(299*a.r+587*a.g+114*a.b)/1e3/255},A=function(a,b){var c=r(a);return{h:c.h,s:c.s,l:g(c.l+100*b,0,100),a:c.a}},B=function(){function a(a){this.parsed=("string"==typeof a?x(a.trim(),w.string):"object"==typeof a&&null!==a?x(a,w.object):[null,void 0])[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return a.prototype.isValid=function(){return null!==this.parsed},a.prototype.brightness=function(){return f(z(this.rgba),2)},a.prototype.isDark=function(){return .5>z(this.rgba)},a.prototype.isLight=function(){return z(this.rgba)>=.5},a.prototype.toHex=function(){var a,b,c,d,e,g;return b=(a=j(this.rgba)).r,c=a.g,d=a.b,g=(e=a.a)<1?l(f(255*e)):"","#"+l(b)+l(c)+l(d)+g},a.prototype.toRgb=function(){return j(this.rgba)},a.prototype.toRgbString=function(){var a,b,c,d,e;return b=(a=j(this.rgba)).r,c=a.g,d=a.b,(e=a.a)<1?"rgba("+b+", "+c+", "+d+", "+e+")":"rgb("+b+", "+c+", "+d+")"},a.prototype.toHsl=function(){return p(r(this.rgba))},a.prototype.toHslString=function(){var a,b,c,d,e;return b=(a=p(r(this.rgba))).h,c=a.s,d=a.l,(e=a.a)<1?"hsla("+b+", "+c+"%, "+d+"%, "+e+")":"hsl("+b+", "+c+"%, "+d+"%)"},a.prototype.toHsv=function(){var a;return{h:f((a=m(this.rgba)).h),s:f(a.s),v:f(a.v),a:f(a.a,3)}},a.prototype.invert=function(){var a;return C({r:255-(a=this.rgba).r,g:255-a.g,b:255-a.b,a:a.a})},a.prototype.saturate=function(a){return void 0===a&&(a=.1),C(y(this.rgba,a))},a.prototype.desaturate=function(a){return void 0===a&&(a=.1),C(y(this.rgba,-a))},a.prototype.grayscale=function(){return C(y(this.rgba,-1))},a.prototype.lighten=function(a){return void 0===a&&(a=.1),C(A(this.rgba,a))},a.prototype.darken=function(a){return void 0===a&&(a=.1),C(A(this.rgba,-a))},a.prototype.rotate=function(a){return void 0===a&&(a=15),this.hue(this.hue()+a)},a.prototype.alpha=function(a){var b;return"number"==typeof a?C({r:(b=this.rgba).r,g:b.g,b:b.b,a:a}):f(this.rgba.a,3)},a.prototype.hue=function(a){var b=r(this.rgba);return"number"==typeof a?C({h:a,s:b.s,l:b.l,a:b.a}):f(b.h)},a.prototype.isEqual=function(a){return this.toHex()===C(a).toHex()},a}(),C=function(a){return a instanceof B?a:new B(a)},D=[];[function(a,b){var c={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},d={};for(var e in c)d[c[e]]=e;var f={};a.prototype.toName=function(b){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var e,g=d[this.toHex()];if(g)return g;if(null==b?void 0:b.closest){var h=this.toRgb(),i=1/0,j="black";if(!f.length)for(var k in c)f[k]=new a(c[k]).toRgb();for(var l in c){var m=(e=f[l],Math.pow(h.r-e.r,2)+Math.pow(h.g-e.g,2)+Math.pow(h.b-e.b,2));m<i&&(i=m,j=l)}return j}},b.string.push([function(b){var d=b.toLowerCase(),e="transparent"===d?"#0000":c[d];return e?new a(e).toRgb():null},"name"])}].forEach(function(a){0>D.indexOf(a)&&(a(B,w),D.push(a))});let E=class a{constructor(a=0xffffff){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=0xffffff,this.value=a}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(a){return this.value=a,this}set value(b){if(b instanceof a)this._value=this._cloneSource(b._value),this._int=b._int,this._components.set(b._components);else if(null===b)throw Error("Cannot set Color#value to null");else null!==this._value&&this._isSourceEqual(this._value,b)||(this._value=this._cloneSource(b),this._normalize(this._value))}get value(){return this._value}_cloneSource(a){if("string"==typeof a||"number"==typeof a||a instanceof Number||null===a);else if(Array.isArray(a)||ArrayBuffer.isView(a))return a.slice(0);else if("object"==typeof a&&null!==a)return{...a};return a}_isSourceEqual(a,b){let c=typeof a;if(c!==typeof b)return!1;if("number"===c||"string"===c||a instanceof Number);else if(Array.isArray(a)&&Array.isArray(b)||ArrayBuffer.isView(a)&&ArrayBuffer.isView(b))return a.length===b.length&&a.every((a,c)=>a===b[c]);else if(null!==a&&null!==b){let c=Object.keys(a),d=Object.keys(b);return c.length===d.length&&c.every(c=>a[c]===b[c])}return a===b}toRgba(){let[a,b,c,d]=this._components;return{r:a,g:b,b:c,a:d}}toRgb(){let[a,b,c]=this._components;return{r:a,g:b,b:c}}toRgbaString(){let[a,b,c]=this.toUint8RgbArray();return`rgba(${a},${b},${c},${this.alpha})`}toUint8RgbArray(a){let[b,c,d]=this._components;return this._arrayRgb||(this._arrayRgb=[]),a||(a=this._arrayRgb),a[0]=Math.round(255*b),a[1]=Math.round(255*c),a[2]=Math.round(255*d),a}toArray(a){this._arrayRgba||(this._arrayRgba=[]),a||(a=this._arrayRgba);let[b,c,d,e]=this._components;return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a}toRgbArray(a){this._arrayRgb||(this._arrayRgb=[]),a||(a=this._arrayRgb);let[b,c,d]=this._components;return a[0]=b,a[1]=c,a[2]=d,a}toNumber(){return this._int}toBgrNumber(){let[a,b,c]=this.toUint8RgbArray();return(c<<16)+(b<<8)+a}toLittleEndianNumber(){let a=this._int;return(a>>16)+(65280&a)+((255&a)<<16)}multiply(b){let[c,d,e,f]=a._temp.setValue(b)._components;return this._components[0]*=c,this._components[1]*=d,this._components[2]*=e,this._components[3]*=f,this._refreshInt(),this._value=null,this}premultiply(a,b=!0){return b&&(this._components[0]*=a,this._components[1]*=a,this._components[2]*=a),this._components[3]=a,this._refreshInt(),this._value=null,this}toPremultiplied(a,b=!0){if(1===a)return -0x1000000+this._int;if(0===a)return b?0:this._int;let c=this._int>>16&255,d=this._int>>8&255,e=255&this._int;return b&&(c=c*a+.5|0,d=d*a+.5|0,e=e*a+.5|0),(255*a<<24)+(c<<16)+(d<<8)+e}toHex(){let a=this._int.toString(16);return`#${"000000".substring(0,6-a.length)+a}`}toHexa(){let a=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-a.length)+a}setAlpha(a){return this._components[3]=this._clamp(a),this}_normalize(b){let c,d,e,f;if(("number"==typeof b||b instanceof Number)&&b>=0&&b<=0xffffff){let a=b;c=(a>>16&255)/255,d=(a>>8&255)/255,e=(255&a)/255,f=1}else if((Array.isArray(b)||b instanceof Float32Array)&&b.length>=3&&b.length<=4)b=this._clamp(b),[c,d,e,f=1]=b;else if((b instanceof Uint8Array||b instanceof Uint8ClampedArray)&&b.length>=3&&b.length<=4)b=this._clamp(b,0,255),[c,d,e,f=255]=b,c/=255,d/=255,e/=255,f/=255;else if("string"==typeof b||"object"==typeof b){if("string"==typeof b){let c=a.HEX_PATTERN.exec(b);c&&(b=`#${c[2]}`)}let g=C(b);g.isValid()&&({r:c,g:d,b:e,a:f}=g.rgba,c/=255,d/=255,e/=255)}if(void 0!==c)this._components[0]=c,this._components[1]=d,this._components[2]=e,this._components[3]=f,this._refreshInt();else throw Error(`Unable to convert color ${b}`)}_refreshInt(){this._clamp(this._components);let[a,b,c]=this._components;this._int=(255*a<<16)+(255*b<<8)+(255*c|0)}_clamp(a,b=0,c=1){return"number"==typeof a?Math.min(Math.max(a,b),c):(a.forEach((d,e)=>{a[e]=Math.min(Math.max(d,b),c)}),a)}static isColorLike(b){return"number"==typeof b||"string"==typeof b||b instanceof Number||b instanceof a||Array.isArray(b)||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Float32Array||void 0!==b.r&&void 0!==b.g&&void 0!==b.b||void 0!==b.r&&void 0!==b.g&&void 0!==b.b&&void 0!==b.a||void 0!==b.h&&void 0!==b.s&&void 0!==b.l||void 0!==b.h&&void 0!==b.s&&void 0!==b.l&&void 0!==b.a||void 0!==b.h&&void 0!==b.s&&void 0!==b.v||void 0!==b.h&&void 0!==b.s&&void 0!==b.v&&void 0!==b.a}};E.shared=new E,E._temp=new E,E.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let F=E},67834:(a,b,c)=>{"use strict";c.d(b,{u:()=>d});class d{constructor(a){"number"==typeof a?this.rawBinaryData=new ArrayBuffer(a):a instanceof Uint8Array?this.rawBinaryData=a.buffer:this.rawBinaryData=a,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(a){return this[`${a}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(a){switch(a){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw Error(`${a} isn't a valid view type`)}}}},67891:(a,b,c)=>{"use strict";var d=c(1157),e=c(45753),f=c(93141),g=c(61487);let h=[];function i(a={}){let b=a&&a.resource,c=b?a.resource:a,d=b?a:{resource:a};for(let a=0;a<h.length;a++){let b=h[a];if(b.test(c))return new b(d)}throw Error(`Could not find a source type for resource: ${d.resource}`)}e.XO.handleByList(e.Ag.TextureSource,h),g.g.from=function(a,b=!1){return"string"==typeof a?d.l.get(a):a instanceof f.v?new g.g({source:a}):function(a={},b=!1){let c=a&&a.resource,e=c?a.resource:a,f=c?a:{resource:a};if(!b&&d.l.has(e))return d.l.get(e);let h=new g.g({source:i(f)});return h.on("destroy",()=>{d.l.has(e)&&d.l.remove(e)}),b||d.l.set(e,h),h}(a,b)},f.v.from=i},69043:(a,b,c)=>{"use strict";c.d(b,{u:()=>e});var d,e=((d=e||{})[d.NONE=0]="NONE",d[d.COLOR=16384]="COLOR",d[d.STENCIL=1024]="STENCIL",d[d.DEPTH=256]="DEPTH",d[d.COLOR_DEPTH=16640]="COLOR_DEPTH",d[d.COLOR_STENCIL=17408]="COLOR_STENCIL",d[d.DEPTH_STENCIL=1280]="DEPTH_STENCIL",d[d.ALL=17664]="ALL",d)},70440:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>e});var d=c(88868);let e=async a=>[{type:"image/x-icon",sizes:"16x16",url:(0,d.fillMetadataSegment)(".",await a.params,"favicon.ico")+"?603d046c9a6fdfbb"}]},70722:a=>{"use strict";a.exports=require("next/dist/shared/lib/invariant-error")},71064:(a,b,c)=>{"use strict";c.d(b,{ProjectWorkspace:()=>d});let d=(0,c(77943).registerClientReference)(function(){throw Error("Attempted to call ProjectWorkspace() from the server but ProjectWorkspace is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/dannyruchtie/Documents/moondream/web/src/components/workspace/ProjectWorkspace.tsx","ProjectWorkspace")},71254:(a,b,c)=>{"use strict";c.d(b,{X:()=>f});let d=Object.create(null),e=Object.create(null);function f(a,b){let c=e[a];return void 0===c&&(void 0===d[b]&&(d[b]=1),e[a]=c=d[b]++),c}},71568:(a,b,c)=>{"use strict";c.d(b,{Ek:()=>f,lj:()=>e,t6:()=>h});let d=new Set,e="8.0.0",f="8.3.4",g={quiet:!1,noColor:!1},h=(a,b,c=3)=>{if(g.quiet||d.has(b))return;let e=Error().stack,f=`${b}
Deprecated since v${a}`,h="function"==typeof console.groupCollapsed&&!g.noColor;void 0===e?console.warn("PixiJS Deprecation Warning: ",f):(e=e.split("\n").splice(c).join("\n"),h?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",f),console.warn(e),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",f),console.warn(e))),d.add(b)};Object.defineProperties(h,{quiet:{get:()=>g.quiet,set:a=>{g.quiet=a},enumerable:!0,configurable:!1},noColor:{get:()=>g.noColor,set:a=>{g.noColor=a},enumerable:!0,configurable:!1}})},73024:a=>{"use strict";a.exports=require("node:fs")},73866:(a,b,c)=>{"use strict";let d,e;c.d(b,{T:()=>R});var f=c(57680),g=c(66242),h=c(48419),i=c(21783),j=c(61487),k=c(42115),l=c(71568),m=c(87790),n=c(87818),o=c(29508),p=c(91546);class q{constructor(a=0,b=0,c=0){this.type="circle",this.x=a,this.y=b,this.radius=c}clone(){return new q(this.x,this.y,this.radius)}contains(a,b){if(this.radius<=0)return!1;let c=this.radius*this.radius,d=this.x-a,e=this.y-b;return d*=d,e*=e,d+e<=c}strokeContains(a,b,c,d=.5){if(0===this.radius)return!1;let e=this.x-a,f=this.y-b,g=this.radius,h=(1-d)*c,i=Math.sqrt(e*e+f*f);return i<=g+h&&i>g-(c-h)}getBounds(a){return a||(a=new p.M),a.x=this.x-this.radius,a.y=this.y-this.radius,a.width=2*this.radius,a.height=2*this.radius,a}copyFrom(a){return this.x=a.x,this.y=a.y,this.radius=a.radius,this}copyTo(a){return a.copyFrom(this),a}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class r{constructor(a=0,b=0,c=0,d=0){this.type="ellipse",this.x=a,this.y=b,this.halfWidth=c,this.halfHeight=d}clone(){return new r(this.x,this.y,this.halfWidth,this.halfHeight)}contains(a,b){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let c=(a-this.x)/this.halfWidth,d=(b-this.y)/this.halfHeight;return c*=c,d*=d,c+d<=1}strokeContains(a,b,c,d=.5){let{halfWidth:e,halfHeight:f}=this;if(e<=0||f<=0)return!1;let g=c*(1-d),h=c-g,i=e-h,j=f-h,k=e+g,l=f+g,m=a-this.x,n=b-this.y;return m*m/(i*i)+n*n/(j*j)>1&&m*m/(k*k)+n*n/(l*l)<=1}getBounds(a){return a||(a=new p.M),a.x=this.x-this.halfWidth,a.y=this.y-this.halfHeight,a.width=2*this.halfWidth,a.height=2*this.halfHeight,a}copyFrom(a){return this.x=a.x,this.y=a.y,this.halfWidth=a.halfWidth,this.halfHeight=a.halfHeight,this}copyTo(a){return a.copyFrom(this),a}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}class s{constructor(...a){this.type="polygon";let b=Array.isArray(a[0])?a[0]:a;if("number"!=typeof b[0]){const a=[];for(let c=0,d=b.length;c<d;c++)a.push(b[c].x,b[c].y);b=a}this.points=b,this.closePath=!0}isClockwise(){let a=0,b=this.points,c=b.length;for(let d=0;d<c;d+=2){let e=b[d],f=b[d+1];a+=(b[(d+2)%c]-e)*(b[(d+3)%c]+f)}return a<0}containsPolygon(a){let b=this.getBounds(d),c=a.getBounds(e);if(!b.containsRect(c))return!1;let f=a.points;for(let a=0;a<f.length;a+=2){let b=f[a],c=f[a+1];if(!this.contains(b,c))return!1}return!0}clone(){let a=new s(this.points.slice());return a.closePath=this.closePath,a}contains(a,b){let c=!1,d=this.points.length/2;for(let e=0,f=d-1;e<d;f=e++){let d=this.points[2*e],g=this.points[2*e+1],h=this.points[2*f],i=this.points[2*f+1];g>b!=i>b&&a<(b-g)/(i-g)*(h-d)+d&&(c=!c)}return c}strokeContains(a,b,c,d=.5){let e=c*c,f=e*(1-d),g=e-f,{points:h}=this,i=h.length-2*!this.closePath;for(let c=0;c<i;c+=2){let d=h[c],e=h[c+1],i=h[(c+2)%h.length],j=h[(c+3)%h.length];if(function(a,b,c,d,e,f){let g,h,i=e-c,j=f-d,k=i*i+j*j,l=-1;0!==k&&(l=((a-c)*i+(b-d)*j)/k),l<0?(g=c,h=d):l>1?(g=e,h=f):(g=c+l*i,h=d+l*j);let m=a-g,n=b-h;return m*m+n*n}(a,b,d,e,i,j)<=(0>Math.sign((i-d)*(b-e)-(j-e)*(a-d))?g:f))return!0}return!1}getBounds(a){a||(a=new p.M);let b=this.points,c=1/0,d=-1/0,e=1/0,f=-1/0;for(let a=0,g=b.length;a<g;a+=2){let g=b[a],h=b[a+1];c=g<c?g:c,d=g>d?g:d,e=h<e?h:e,f=h>f?h:f}return a.x=c,a.width=d-c,a.y=e,a.height=f-e,a}copyFrom(a){return this.points=a.points.slice(),this.closePath=a.closePath,this}copyTo(a){return a.copyFrom(this),a}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((a,b)=>`${a}, ${b}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return(0,l.t6)("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return(0,l.t6)("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}let t=(a,b,c,d,e,f,g)=>{let h=a-c,i=b-d,j=Math.sqrt(h*h+i*i);return j>=e-f&&j<=e+g};class u{constructor(a=0,b=0,c=0,d=0,e=20){this.type="roundedRectangle",this.x=a,this.y=b,this.width=c,this.height=d,this.radius=e}getBounds(a){return a||(a=new p.M),a.x=this.x,a.y=this.y,a.width=this.width,a.height=this.height,a}clone(){return new u(this.x,this.y,this.width,this.height,this.radius)}copyFrom(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this}copyTo(a){return a.copyFrom(this),a}contains(a,b){if(this.width<=0||this.height<=0)return!1;if(a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<=this.y+this.height){let c=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(b>=this.y+c&&b<=this.y+this.height-c||a>=this.x+c&&a<=this.x+this.width-c)return!0;let d=a-(this.x+c),e=b-(this.y+c),f=c*c;if(d*d+e*e<=f||(d=a-(this.x+this.width-c))*d+e*e<=f||d*d+(e=b-(this.y+this.height-c))*e<=f||(d=a-(this.x+c))*d+e*e<=f)return!0}return!1}strokeContains(a,b,c,d=.5){let{x:e,y:f,width:g,height:h,radius:i}=this,j=c*(1-d),k=c-j,l=e+i,m=f+i,n=g-2*i,o=h-2*i,p=e+g,q=f+h;return(a>=e-j&&a<=e+k||a>=p-k&&a<=p+j)&&b>=m&&b<=m+o||(b>=f-j&&b<=f+k||b>=q-k&&b<=q+j)&&a>=l&&a<=l+n||a<l&&b<m&&t(a,b,l,m,i,k,j)||a>p-i&&b<m&&t(a,b,p-i,m,i,k,j)||a>p-i&&b>q-i&&t(a,b,p-i,q-i,i,k,j)||a<l&&b>q-i&&t(a,b,l,q-i,i,k,j)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}var v=c(84195);function w(a,b,c,d,e,f,g,h,i,j){var k,l,m;let n=(1-Math.min(.99,Math.max(0,j??v.GH.defaultOptions.bezierSmoothness)))/1;return n*=n,function a(b,c,d,e,f,g,h,i,j,k,l){if(l>8)return;let m=(b+d)/2,n=(c+e)/2,o=(d+f)/2,p=(e+g)/2,q=(f+h)/2,r=(g+i)/2,s=(m+o)/2,t=(n+p)/2,u=(o+q)/2,v=(p+r)/2,w=(s+u)/2,x=(t+v)/2;if(l>0){let a=h-b,l=i-c,m=Math.abs((d-h)*l-(e-i)*a),n=Math.abs((f-h)*l-(g-i)*a);if(m>11920929e-14&&n>11920929e-14){if((m+n)*(m+n)<=k*(a*a+l*l))return void j.push(w,x)}else if(m>11920929e-14){if(m*m<=k*(a*a+l*l))return void j.push(w,x)}else if(n>11920929e-14){if(n*n<=k*(a*a+l*l))return void j.push(w,x)}else if((a=w-(b+h)/2)*a+(l=x-(c+i)/2)*l<=k)return void j.push(w,x)}a(b,c,m,n,s,t,w,x,j,k,l+1),a(w,x,u,v,q,r,h,i,j,k,l+1)}(b,c,d,e,f,g,k=h,l=i,m=a,n,0),m.push(k,l),a}function x(a,b,c,d,e,f,g,h){let i=Math.abs(e-f);!g&&e>f?i=2*Math.PI-i:g&&f>e&&(i=2*Math.PI-i),h||(h=Math.max(6,Math.floor(6*Math.pow(d,1/3)*(i/Math.PI))));let j=i/(h=Math.max(h,3)),k=e;j*=g?-1:1;for(let e=0;e<h+1;e++){let e=b+Math.cos(k)*d,f=c+Math.sin(k)*d;a.push(e,f),k+=j}}let y=2*Math.PI,z={centerX:0,centerY:0,ang1:0,ang2:0},A=({x:a,y:b},c,d,e,f,g,h,i)=>{let j=e*(a*=c)-f*(b*=d),k=f*a+e*b;return i.x=j+g,i.y=k+h,i},B=(a,b,c,d)=>{let e=a*c+b*d;return e>1&&(e=1),e<-1&&(e=-1),(a*d-b*c<0?-1:1)*Math.acos(e)},C=new p.M;class D{constructor(a){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new m.c,this._graphicsPath2D=a,this.signed=a.checkForHoles}moveTo(a,b){return this.startPoly(a,b),this}lineTo(a,b){this._ensurePoly();let c=this._currentPoly.points,d=c[c.length-2],e=c[c.length-1];return(d!==a||e!==b)&&c.push(a,b),this}arc(a,b,c,d,e,f){return this._ensurePoly(!1),x(this._currentPoly.points,a,b,c,d,e,f),this}arcTo(a,b,c,d,e){return this._ensurePoly(),!function(a,b,c,d,e,f){let g=a[a.length-2],h=a[a.length-1]-c,i=g-b,j=e-c,k=d-b,l=Math.abs(h*k-i*j);if(l<1e-8||0===f){(a[a.length-2]!==b||a[a.length-1]!==c)&&a.push(b,c);return}let m=h*h+i*i,n=j*j+k*k,o=h*j+i*k,p=f*Math.sqrt(m)/l,q=f*Math.sqrt(n)/l,r=p*o/m,s=q*o/n,t=p*k+q*i,u=p*j+q*h,v=Math.atan2(h*(q+r)-u,i*(q+r)-t),w=Math.atan2(j*(p+s)-u,k*(p+s)-t);x(a,t+b,u+c,f,v,w,i*j>k*h)}(this._currentPoly.points,a,b,c,d,e),this}arcToSvg(a,b,c,d,e,f,g){return!function(a,b,c,d,e,f,g,h=0,i=0,j=0){var k,l;let m,n,o,p,q,r,s,t,u,v,x;if(0===f||0===g)return;let C=Math.sin(h*y/360),D=Math.cos(h*y/360),E=D*(b-d)/2+C*(c-e)/2,F=-C*(b-d)/2+D*(c-e)/2;if(0===E&&0===F)return;let G=Math.pow(E,2)/Math.pow(f=Math.abs(f),2)+Math.pow(F,2)/Math.pow(g=Math.abs(g),2);G>1&&(f*=Math.sqrt(G),g*=Math.sqrt(G)),k=f,l=g,m=Math.pow(k,2),n=Math.pow(l,2),o=Math.pow(E,2),(q=m*n-m*(p=Math.pow(F,2))-n*o)<0&&(q=0),q/=m*p+n*o,r=(q=Math.sqrt(q)*(i===j?-1:1))*k/l*F,s=-(q*l)/k*E,v=B(1,0,t=(E-r)/k,u=(F-s)/l),x=B(t,u,(-E-r)/k,(-F-s)/l),0===j&&x>0&&(x-=y),1===j&&x<0&&(x+=y),z.centerX=D*r-C*s+(b+d)/2,z.centerY=C*r+D*s+(c+e)/2,z.ang1=v,z.ang2=x;let{ang1:H,ang2:I}=z,{centerX:J,centerY:K}=z,L=Math.abs(I)/(y/4);1e-7>Math.abs(1-L)&&(L=1);let M=Math.max(Math.ceil(L),1);I/=M;let N=a[a.length-2],O=a[a.length-1],P={x:0,y:0};for(let b=0;b<M;b++){let b=function(a,b){let c=-1.5707963267948966===b?-.551915024494:4/3*Math.tan(b/4),d=1.5707963267948966===b?.551915024494:c,e=Math.cos(a),f=Math.sin(a),g=Math.cos(a+b),h=Math.sin(a+b);return[{x:e-f*d,y:f+e*d},{x:g+h*d,y:h-g*d},{x:g,y:h}]}(H,I),{x:c,y:d}=A(b[0],f,g,D,C,J,K,P),{x:e,y:h}=A(b[1],f,g,D,C,J,K,P),{x:i,y:j}=A(b[2],f,g,D,C,J,K,P);w(a,N,O,c,d,e,h,i,j),N=i,O=j,H+=I}}(this._currentPoly.points,this._currentPoly.lastX,this._currentPoly.lastY,f,g,a,b,c,d,e),this}bezierCurveTo(a,b,c,d,e,f,g){this._ensurePoly();let h=this._currentPoly;return w(this._currentPoly.points,h.lastX,h.lastY,a,b,c,d,e,f,g),this}quadraticCurveTo(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p;let q;this._ensurePoly();let r=this._currentPoly;return f=this._currentPoly.points,g=r.lastX,h=r.lastY,q=(1-Math.min(.99,Math.max(0,e??v.GH.defaultOptions.bezierSmoothness)))/1,i=g,j=h,k=a,l=b,m=c,n=d,o=f,p=q*=q,function a(b,c,d,e,f,g,h,i,j){if(j>8)return;let k=(c+e)/2,l=(d+f)/2,m=(e+g)/2,n=(f+h)/2,o=(k+m)/2,p=(l+n)/2,q=g-c,r=h-d,s=Math.abs((e-g)*r-(f-h)*q);if(s>11920929e-14){if(s*s<=i*(q*q+r*r))return void b.push(o,p)}else if((q=o-(c+g)/2)*q+(r=p-(d+h)/2)*r<=i)return void b.push(o,p);a(b,c,d,k,l,o,p,i,j+1),a(b,o,p,m,n,g,h,i,j+1)}(o,i,j,k,l,m,n,p,0),o.push(m,n),this}closePath(){return this.endPoly(!0),this}addPath(a,b){this.endPoly(),b&&!b.isIdentity()&&(a=a.clone(!0)).transform(b);let c=this.shapePrimitives,d=c.length;for(let b=0;b<a.instructions.length;b++){let c=a.instructions[b];this[c.action](...c.data)}if(a.checkForHoles&&c.length-d>1){let a=null;for(let b=d;b<c.length;b++){let d=c[b];if("polygon"===d.shape.type){let e=d.shape,f=a?.shape;f&&f.containsPolygon(e)?(a.holes||(a.holes=[]),a.holes.push(d),c.copyWithin(b,b+1),c.length--,b--):a=d}}}return this}finish(a=!1){this.endPoly(a)}rect(a,b,c,d,e){return this.drawShape(new p.M(a,b,c,d),e),this}circle(a,b,c,d){return this.drawShape(new q(a,b,c),d),this}poly(a,b,c){let d=new s(a);return d.closePath=b,this.drawShape(d,c),this}regularPoly(a,b,c,d,e=0,f){let g=-1*Math.PI/2+e,h=2*Math.PI/(d=Math.max(0|d,3)),i=[];for(let e=0;e<d;e++){let d=g-e*h;i.push(a+c*Math.cos(d),b+c*Math.sin(d))}return this.poly(i,!0,f),this}roundPoly(a,b,c,d,e,f=0,g){if(d=Math.max(0|d,3),e<=0)return this.regularPoly(a,b,c,d,f);e=Math.min(e,c*Math.sin(Math.PI/d)-.001);let h=-1*Math.PI/2+f,i=2*Math.PI/d,j=(d-2)*Math.PI/d/2;for(let f=0;f<d;f++){let d=f*i+h,k=a+c*Math.cos(d),l=b+c*Math.sin(d),m=d+Math.PI+j,n=d-Math.PI-j,o=k+e*Math.cos(m),p=l+e*Math.sin(m),q=k+e*Math.cos(n),r=l+e*Math.sin(n);0===f?this.moveTo(o,p):this.lineTo(o,p),this.quadraticCurveTo(k,l,q,r,g)}return this.closePath()}roundShape(a,b,c=!1,d){return a.length<3?this:(c?!function(a,b,c,d){let e=(a,b)=>Math.sqrt((a.x-b.x)**2+(a.y-b.y)**2),f=(a,b,c)=>({x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}),g=b.length;for(let h=0;h<g;h++){let i,j,k=b[(h+1)%g],l=k.radius??c;if(l<=0){0===h?a.moveTo(k.x,k.y):a.lineTo(k.x,k.y);continue}let m=b[h],n=b[(h+2)%g],o=e(m,k);i=o<1e-4?k:f(k,m,Math.min(o/2,l)/o);let p=e(n,k);j=p<1e-4?k:f(k,n,Math.min(p/2,l)/p),0===h?a.moveTo(i.x,i.y):a.lineTo(i.x,i.y),a.quadraticCurveTo(k.x,k.y,j.x,j.y,d)}}(this,a,b,d):!function(a,b,c){let d=(a,b)=>{let c=b.x-a.x,d=b.y-a.y,e=Math.sqrt(c*c+d*d);return{len:e,nx:c/e,ny:d/e}},e=(b,c)=>{0===b?a.moveTo(c.x,c.y):a.lineTo(c.x,c.y)},f=b[b.length-1];for(let g=0;g<b.length;g++){let h,i=b[g%b.length],j=i.radius??c;if(j<=0){e(g,i),f=i;continue}let k=b[(g+1)%b.length],l=d(i,f),m=d(i,k);if(l.len<1e-4||m.len<1e-4){e(g,i),f=i;continue}let n=Math.asin(l.nx*m.ny-l.ny*m.nx),o=1,p=!1;l.nx*m.nx- -(l.ny*m.ny)<0?n<0?n=Math.PI+n:(n=Math.PI-n,o=-1,p=!0):n>0&&(o=-1,p=!0);let q=n/2,r=Math.abs(Math.cos(q)*j/Math.sin(q));h=r>Math.min(l.len/2,m.len/2)?Math.abs((r=Math.min(l.len/2,m.len/2))*Math.sin(q)/Math.cos(q)):j;let s=i.x+m.nx*r+-m.ny*h*o,t=i.y+m.ny*r+m.nx*h*o,u=Math.atan2(l.ny,l.nx)+Math.PI/2*o,v=Math.atan2(m.ny,m.nx)-Math.PI/2*o;0===g&&a.moveTo(s+Math.cos(u)*h,t+Math.sin(u)*h),a.arc(s,t,h,u,v,p),f=i}}(this,a,b),this.closePath())}filletRect(a,b,c,d,e){if(0===e)return this.rect(a,b,c,d);let f=Math.min(c,d)/2,g=Math.min(f,Math.max(-f,e)),h=a+c,i=b+d,j=g<0?-g:0,k=Math.abs(g);return this.moveTo(a,b+k).arcTo(a+j,b+j,a+k,b,k).lineTo(h-k,b).arcTo(h-j,b+j,h,b+k,k).lineTo(h,i-k).arcTo(h-j,i-j,a+c-k,i,k).lineTo(a+k,i).arcTo(a+j,i-j,a,i-k,k).closePath()}chamferRect(a,b,c,d,e,f){if(e<=0)return this.rect(a,b,c,d);let g=Math.min(e,Math.min(c,d)/2),h=a+c,i=b+d,j=[a+g,b,h-g,b,h,b+g,h,i-g,h-g,i,a+g,i,a,i-g,a,b+g];for(let a=j.length-1;a>=2;a-=2)j[a]===j[a-2]&&j[a-1]===j[a-3]&&j.splice(a-1,2);return this.poly(j,!0,f)}ellipse(a,b,c,d,e){return this.drawShape(new r(a,b,c,d),e),this}roundRect(a,b,c,d,e,f){return this.drawShape(new u(a,b,c,d,e),f),this}drawShape(a,b){return this.endPoly(),this.shapePrimitives.push({shape:a,transform:b}),this}startPoly(a,b){let c=this._currentPoly;return c&&this.endPoly(),(c=new s).points.push(a,b),this._currentPoly=c,this}endPoly(a=!1){let b=this._currentPoly;return b&&b.points.length>2&&(b.closePath=a,this.shapePrimitives.push({shape:b})),this._currentPoly=null,this}_ensurePoly(a=!0){if(!this._currentPoly&&(this._currentPoly=new s,a)){let a=this.shapePrimitives[this.shapePrimitives.length-1];if(a){let b=a.shape.x,c=a.shape.y;if(a.transform&&!a.transform.isIdentity()){let d=a.transform,e=b;b=d.a*b+d.c*c+d.tx,c=d.b*e+d.d*c+d.ty}this._currentPoly.points.push(b,c)}else this._currentPoly.points.push(0,0)}}buildPath(){let a=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let b=0;b<a.instructions.length;b++){let c=a.instructions[b];this[c.action](...c.data)}this.finish()}get bounds(){let a=this._bounds;a.clear();let b=this.shapePrimitives;for(let c=0;c<b.length;c++){let d=b[c],e=d.shape.getBounds(C);d.transform?a.addRect(e,d.transform):a.addRect(e)}return a}}class E{constructor(a,b=!1){this.instructions=[],this.uid=(0,k.L)("graphicsPath"),this._dirty=!0,this.checkForHoles=b,"string"==typeof a?function(a,b){let c=o(a),d=[],e=null,f=0,g=0;for(let a=0;a<c.length;a++){let h=c[a],i=h[0];switch(i){case"M":f=h[1],g=h[2],b.moveTo(f,g);break;case"m":f+=h[1],g+=h[2],b.moveTo(f,g);break;case"H":f=h[1],b.lineTo(f,g);break;case"h":f+=h[1],b.lineTo(f,g);break;case"V":g=h[1],b.lineTo(f,g);break;case"v":g+=h[1],b.lineTo(f,g);break;case"L":f=h[1],g=h[2],b.lineTo(f,g);break;case"l":f+=h[1],g+=h[2],b.lineTo(f,g);break;case"C":f=h[5],g=h[6],b.bezierCurveTo(h[1],h[2],h[3],h[4],f,g);break;case"c":b.bezierCurveTo(f+h[1],g+h[2],f+h[3],g+h[4],f+h[5],g+h[6]),f+=h[5],g+=h[6];break;case"S":f=h[3],g=h[4],b.bezierCurveToShort(h[1],h[2],f,g);break;case"s":b.bezierCurveToShort(f+h[1],g+h[2],f+h[3],g+h[4]),f+=h[3],g+=h[4];break;case"Q":f=h[3],g=h[4],b.quadraticCurveTo(h[1],h[2],f,g);break;case"q":b.quadraticCurveTo(f+h[1],g+h[2],f+h[3],g+h[4]),f+=h[3],g+=h[4];break;case"T":f=h[1],g=h[2],b.quadraticCurveToShort(f,g);break;case"t":f+=h[1],g+=h[2],b.quadraticCurveToShort(f,g);break;case"A":f=h[6],g=h[7],b.arcToSvg(h[1],h[2],h[3],h[4],h[5],f,g);break;case"a":f+=h[6],g+=h[7],b.arcToSvg(h[1],h[2],h[3],h[4],h[5],f,g);break;case"Z":case"z":b.closePath(),d.length>0&&((e=d.pop())?(f=e.startX,g=e.startY):(f=0,g=0)),e=null;break;default:(0,n.R)(`Unknown SVG path command: ${i}`)}"Z"!==i&&"z"!==i&&null===e&&(e={startX:f,startY:g},d.push(e))}}(a,this):this.instructions=a?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new D(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(a,b){return a=a.clone(),this.instructions.push({action:"addPath",data:[a,b]}),this._dirty=!0,this}arc(...a){return this.instructions.push({action:"arc",data:a}),this._dirty=!0,this}arcTo(...a){return this.instructions.push({action:"arcTo",data:a}),this._dirty=!0,this}arcToSvg(...a){return this.instructions.push({action:"arcToSvg",data:a}),this._dirty=!0,this}bezierCurveTo(...a){return this.instructions.push({action:"bezierCurveTo",data:a}),this._dirty=!0,this}bezierCurveToShort(a,b,c,d,e){let f=this.instructions[this.instructions.length-1],g=this.getLastPoint(i.b.shared),h=0,j=0;if(f&&"bezierCurveTo"===f.action){h=f.data[2],j=f.data[3];let a=g.x,b=g.y;h=a+(a-h),j=b+(b-j)}else h=g.x,j=g.y;return this.instructions.push({action:"bezierCurveTo",data:[h,j,a,b,c,d,e]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...a){return this.instructions.push({action:"ellipse",data:a}),this._dirty=!0,this}lineTo(...a){return this.instructions.push({action:"lineTo",data:a}),this._dirty=!0,this}moveTo(...a){return this.instructions.push({action:"moveTo",data:a}),this}quadraticCurveTo(...a){return this.instructions.push({action:"quadraticCurveTo",data:a}),this._dirty=!0,this}quadraticCurveToShort(a,b,c){let d=this.instructions[this.instructions.length-1],e=this.getLastPoint(i.b.shared),f=0,g=0;if(d&&"quadraticCurveTo"===d.action){f=d.data[0],g=d.data[1];let a=e.x,b=e.y;f=a+(a-f),g=b+(b-g)}else f=e.x,g=e.y;return this.instructions.push({action:"quadraticCurveTo",data:[f,g,a,b,c]}),this._dirty=!0,this}rect(a,b,c,d,e){return this.instructions.push({action:"rect",data:[a,b,c,d,e]}),this._dirty=!0,this}circle(a,b,c,d){return this.instructions.push({action:"circle",data:[a,b,c,d]}),this._dirty=!0,this}roundRect(...a){return this.instructions.push({action:"roundRect",data:a}),this._dirty=!0,this}poly(...a){return this.instructions.push({action:"poly",data:a}),this._dirty=!0,this}regularPoly(...a){return this.instructions.push({action:"regularPoly",data:a}),this._dirty=!0,this}roundPoly(...a){return this.instructions.push({action:"roundPoly",data:a}),this._dirty=!0,this}roundShape(...a){return this.instructions.push({action:"roundShape",data:a}),this._dirty=!0,this}filletRect(...a){return this.instructions.push({action:"filletRect",data:a}),this._dirty=!0,this}chamferRect(...a){return this.instructions.push({action:"chamferRect",data:a}),this._dirty=!0,this}star(a,b,c,d,e,f,g){e||(e=d/2);let h=-1*Math.PI/2+f,i=2*c,j=2*Math.PI/i,k=[];for(let c=0;c<i;c++){let f=c%2?e:d,g=c*j+h;k.push(a+f*Math.cos(g),b+f*Math.sin(g))}return this.poly(k,!0,g),this}clone(a=!1){let b=new E;if(b.checkForHoles=this.checkForHoles,a)for(let a=0;a<this.instructions.length;a++){let c=this.instructions[a];b.instructions.push({action:c.action,data:c.data.slice()})}else b.instructions=this.instructions.slice();return b}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(a){if(a.isIdentity())return this;let b=a.a,c=a.b,d=a.c,e=a.d,f=a.tx,g=a.ty,h=0,i=0,j=0,k=0,l=0,m=0,o=0,p=0;for(let q=0;q<this.instructions.length;q++){let r=this.instructions[q],s=r.data;switch(r.action){case"moveTo":case"lineTo":h=s[0],i=s[1],s[0]=b*h+d*i+f,s[1]=c*h+e*i+g;break;case"bezierCurveTo":j=s[0],k=s[1],l=s[2],m=s[3],h=s[4],i=s[5],s[0]=b*j+d*k+f,s[1]=c*j+e*k+g,s[2]=b*l+d*m+f,s[3]=c*l+e*m+g,s[4]=b*h+d*i+f,s[5]=c*h+e*i+g;break;case"quadraticCurveTo":j=s[0],k=s[1],h=s[2],i=s[3],s[0]=b*j+d*k+f,s[1]=c*j+e*k+g,s[2]=b*h+d*i+f,s[3]=c*h+e*i+g;break;case"arcToSvg":h=s[5],i=s[6],o=s[0],p=s[1],s[0]=b*o+d*p,s[1]=c*o+e*p,s[5]=b*h+d*i+f,s[6]=c*h+e*i+g;break;case"circle":s[4]=F(s[3],a);break;case"rect":s[4]=F(s[4],a);break;case"ellipse":s[8]=F(s[8],a);break;case"roundRect":s[5]=F(s[5],a);break;case"addPath":s[0].transform(a);break;case"poly":s[2]=F(s[2],a);break;default:(0,n.R)("unknown transform action",r.action)}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(a){let b=this.instructions.length-1,c=this.instructions[b];if(!c)return a.x=0,a.y=0,a;for(;"closePath"===c.action;){if(--b<0)return a.x=0,a.y=0,a;c=this.instructions[b]}switch(c.action){case"moveTo":case"lineTo":a.x=c.data[0],a.y=c.data[1];break;case"quadraticCurveTo":a.x=c.data[2],a.y=c.data[3];break;case"bezierCurveTo":a.x=c.data[4],a.y=c.data[5];break;case"arc":case"arcToSvg":a.x=c.data[5],a.y=c.data[6];break;case"addPath":c.data[0].getLastPoint(a)}return a}}function F(a,b){return a?a.prepend(b):b.clone()}var G=c(41890);function H(a,b,c){let d=a.getAttribute(b);return d?Number(d):c}function I(a){let b=a.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return b?b[1]:""}let J={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function K(a,b){let c=a.getAttribute("style"),d={},e={},f={strokeStyle:d,fillStyle:e,useFill:!1,useStroke:!1};for(let c in J){let d=a.getAttribute(c);d&&L(b,f,c,d.trim())}if(c){let a=c.split(";");for(let c=0;c<a.length;c++){let[d,e]=a[c].trim().split(":");J[d]&&L(b,f,d,e.trim())}}return{strokeStyle:f.useStroke?d:null,fillStyle:f.useFill?e:null,useFill:f.useFill,useStroke:f.useStroke}}function L(a,b,c,d){switch(c){case"stroke":if("none"!==d){if(d.startsWith("url(")){let c=I(d);b.strokeStyle.fill=a.defs[c]}else b.strokeStyle.color=g.Q.shared.setValue(d).toNumber();b.useStroke=!0}break;case"stroke-width":b.strokeStyle.width=Number(d);break;case"fill":if("none"!==d){if(d.startsWith("url(")){let c=I(d);b.fillStyle.fill=a.defs[c]}else b.fillStyle.color=g.Q.shared.setValue(d).toNumber();b.useFill=!0}break;case"fill-opacity":b.fillStyle.alpha=Number(d);break;case"stroke-opacity":b.strokeStyle.alpha=Number(d);break;case"opacity":b.fillStyle.alpha=Number(d),b.strokeStyle.alpha=Number(d)}}function M(a,b){for(let c of new E(a,!1).instructions)b.instructions.push(c)}var N=c(56488);let O=new i.b,P=new h.u,Q=class a extends f.A{constructor(){super(...arguments),this.uid=(0,k.L)("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new E,this._transform=new h.u,this._fillStyle={...a.defaultFillStyle},this._strokeStyle={...a.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new m.c,this._boundsDirty=!0}clone(){let b=new a;return b.batchMode=this.batchMode,b.instructions=this.instructions.slice(),b._activePath=this._activePath.clone(),b._transform=this._transform.clone(),b._fillStyle={...this._fillStyle},b._strokeStyle={...this._strokeStyle},b._stateStack=this._stateStack.slice(),b._bounds=this._bounds.clone(),b._boundsDirty=!0,b}get fillStyle(){return this._fillStyle}set fillStyle(b){this._fillStyle=(0,N.w)(b,a.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(b){this._strokeStyle=(0,N.T)(b,a.defaultStrokeStyle)}setFillStyle(b){return this._fillStyle=(0,N.w)(b,a.defaultFillStyle),this}setStrokeStyle(b){return this._strokeStyle=(0,N.w)(b,a.defaultStrokeStyle),this}texture(a,b,c,d,e,f){return this.instructions.push({action:"texture",data:{image:a,dx:c||0,dy:d||0,dw:e||a.frame.width,dh:f||a.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:b?g.Q.shared.setValue(b).toNumber():0xffffff}}),this.onUpdate(),this}beginPath(){return this._activePath=new E,this}fill(b,c){let d,e=this.instructions[this.instructions.length-1];return(d=0===this._tick&&e?.action==="stroke"?e.data.path:this._activePath.clone())&&(null!=b&&(void 0!==c&&"number"==typeof b&&((0,l.t6)(l.lj,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),b={color:b,alpha:c}),this._fillStyle=(0,N.w)(b,a.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:d}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0),this}_initNextPathLocation(){let{x:a,y:b}=this._activePath.getLastPoint(i.b.shared);this._activePath.clear(),this._activePath.moveTo(a,b)}stroke(b){let c,d=this.instructions[this.instructions.length-1];return(c=0===this._tick&&d?.action==="fill"?d.data.path:this._activePath.clone())&&(null!=b&&(this._strokeStyle=(0,N.T)(b,a.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:c}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0),this}cut(){for(let a=0;a<2;a++){let b=this.instructions[this.instructions.length-1-a],c=this._activePath.clone();if(b&&("stroke"===b.action||"fill"===b.action))if(b.data.hole)b.data.hole.addPath(c);else{b.data.hole=c;break}}return this._initNextPathLocation(),this}arc(a,b,c,d,e,f){this._tick++;let g=this._transform;return this._activePath.arc(g.a*a+g.c*b+g.tx,g.b*a+g.d*b+g.ty,c,d,e,f),this}arcTo(a,b,c,d,e){this._tick++;let f=this._transform;return this._activePath.arcTo(f.a*a+f.c*b+f.tx,f.b*a+f.d*b+f.ty,f.a*c+f.c*d+f.tx,f.b*c+f.d*d+f.ty,e),this}arcToSvg(a,b,c,d,e,f,g){this._tick++;let h=this._transform;return this._activePath.arcToSvg(a,b,c,d,e,h.a*f+h.c*g+h.tx,h.b*f+h.d*g+h.ty),this}bezierCurveTo(a,b,c,d,e,f,g){this._tick++;let h=this._transform;return this._activePath.bezierCurveTo(h.a*a+h.c*b+h.tx,h.b*a+h.d*b+h.ty,h.a*c+h.c*d+h.tx,h.b*c+h.d*d+h.ty,h.a*e+h.c*f+h.tx,h.b*e+h.d*f+h.ty,g),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(a,b,c,d){return this._tick++,this._activePath.ellipse(a,b,c,d,this._transform.clone()),this}circle(a,b,c){return this._tick++,this._activePath.circle(a,b,c,this._transform.clone()),this}path(a){return this._tick++,this._activePath.addPath(a,this._transform.clone()),this}lineTo(a,b){this._tick++;let c=this._transform;return this._activePath.lineTo(c.a*a+c.c*b+c.tx,c.b*a+c.d*b+c.ty),this}moveTo(a,b){this._tick++;let c=this._transform,d=this._activePath.instructions,e=c.a*a+c.c*b+c.tx,f=c.b*a+c.d*b+c.ty;return 1===d.length&&"moveTo"===d[0].action?(d[0].data[0]=e,d[0].data[1]=f):this._activePath.moveTo(e,f),this}quadraticCurveTo(a,b,c,d,e){this._tick++;let f=this._transform;return this._activePath.quadraticCurveTo(f.a*a+f.c*b+f.tx,f.b*a+f.d*b+f.ty,f.a*c+f.c*d+f.tx,f.b*c+f.d*d+f.ty,e),this}rect(a,b,c,d){return this._tick++,this._activePath.rect(a,b,c,d,this._transform.clone()),this}roundRect(a,b,c,d,e){return this._tick++,this._activePath.roundRect(a,b,c,d,e,this._transform.clone()),this}poly(a,b){return this._tick++,this._activePath.poly(a,b,this._transform.clone()),this}regularPoly(a,b,c,d,e=0,f){return this._tick++,this._activePath.regularPoly(a,b,c,d,e,f),this}roundPoly(a,b,c,d,e,f){return this._tick++,this._activePath.roundPoly(a,b,c,d,e,f),this}roundShape(a,b,c,d){return this._tick++,this._activePath.roundShape(a,b,c,d),this}filletRect(a,b,c,d,e){return this._tick++,this._activePath.filletRect(a,b,c,d,e),this}chamferRect(a,b,c,d,e,f){return this._tick++,this._activePath.chamferRect(a,b,c,d,e,f),this}star(a,b,c,d,e=0,f=0){return this._tick++,this._activePath.star(a,b,c,d,e,f,this._transform.clone()),this}svg(a){return this._tick++,!function(a,b){if("string"==typeof a){let b=document.createElement("div");b.innerHTML=a.trim(),a=b.querySelector("svg")}let c={context:b,defs:{},path:new E};!function(a,b){let c=a.querySelectorAll("defs");for(let a=0;a<c.length;a++){let e=c[a];for(let a=0;a<e.children.length;a++){let c=e.children[a];switch(c.nodeName.toLowerCase()){case"lineargradient":b.defs[c.id]=function(a){let b=H(a,"x1",0),c=H(a,"y1",0),d=H(a,"x2",1),e=H(a,"y2",0),f=a.getAttribute("gradientUnits")||"objectBoundingBox",h=new G._(b,c,d,e,"objectBoundingBox"===f?"local":"global");for(let b=0;b<a.children.length;b++){let c=a.children[b],d=H(c,"offset",0),e=g.Q.shared.setValue(c.getAttribute("stop-color")).toNumber();h.addColorStop(d,e)}return h}(c);break;case"radialgradient":var d;b.defs[c.id]=(d=0,(0,n.R)("[SVG Parser] Radial gradients are not yet supported"),new G._(0,0,1,0))}}}}(a,c);let d=a.children,{fillStyle:e,strokeStyle:f}=K(a,c);for(let a=0;a<d.length;a++){let b=d[a];"defs"!==b.nodeName.toLowerCase()&&function a(b,c,d,e){let f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w=b.children,{fillStyle:x,strokeStyle:y}=K(b,c);x&&d?d={...d,...x}:x&&(d=x),y&&e?e={...e,...y}:y&&(e=y);let z=!d&&!e;switch(z&&(d={color:0}),b.nodeName.toLowerCase()){case"path":{s=b.getAttribute("d");let a=b.getAttribute("fill-rule"),f=s.split(/(?=[Mm])/).filter(a=>a.trim().length>0),g=f.length>1;if("evenodd"===a&&g){let a=f.map(a=>({path:a,area:function(a){let b=a.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!b||b.length<4)return 0;let c=b.map(Number),d=[],e=[];for(let a=0;a<c.length;a+=2)a+1<c.length&&(d.push(c[a]),e.push(c[a+1]));if(0===d.length||0===e.length)return 0;let f=Math.min(...d),g=Math.min(...e);return(Math.max(...d)-f)*(Math.max(...e)-g)}(a)}));if(a.sort((a,b)=>b.area-a.area),f.length>3||!function(a){if(a.length<=2)return!0;let b=a.map(a=>a.area).sort((a,b)=>b-a),[c,d]=b,e=b[b.length-1];return!(c/d>3)||!(d/e<2)}(a))for(let b=0;b<a.length;b++){let f=a[b],g=0===b;c.context.beginPath();let h=new E(void 0,!0);M(f.path,h),c.context.path(h),g?(d&&c.context.fill(d),e&&c.context.stroke(e)):c.context.cut()}else for(let b=0;b<a.length;b++){let f=a[b],g=b%2==1;c.context.beginPath();let h=new E(void 0,!0);M(f.path,h),c.context.path(h),g?c.context.cut():(d&&c.context.fill(d),e&&c.context.stroke(e))}}else t=new E(s,!a||"evenodd"===a),c.context.path(t),d&&c.context.fill(d),e&&c.context.stroke(e);break}case"circle":l=H(b,"cx",0),m=H(b,"cy",0),o=H(b,"r",0),c.context.ellipse(l,m,o,o),d&&c.context.fill(d),e&&c.context.stroke(e);break;case"rect":f=H(b,"x",0),g=H(b,"y",0),u=H(b,"width",0),v=H(b,"height",0),p=H(b,"rx",0),q=H(b,"ry",0),p||q?c.context.roundRect(f,g,u,v,p||q):c.context.rect(f,g,u,v),d&&c.context.fill(d),e&&c.context.stroke(e);break;case"ellipse":l=H(b,"cx",0),m=H(b,"cy",0),p=H(b,"rx",0),q=H(b,"ry",0),c.context.beginPath(),c.context.ellipse(l,m,p,q),d&&c.context.fill(d),e&&c.context.stroke(e);break;case"line":h=H(b,"x1",0),i=H(b,"y1",0),j=H(b,"x2",0),k=H(b,"y2",0),c.context.beginPath(),c.context.moveTo(h,i),c.context.lineTo(j,k),e&&c.context.stroke(e);break;case"polygon":r=b.getAttribute("points").match(/\d+/g).map(a=>parseInt(a,10)),c.context.poly(r,!0),d&&c.context.fill(d),e&&c.context.stroke(e);break;case"polyline":r=b.getAttribute("points").match(/\d+/g).map(a=>parseInt(a,10)),c.context.poly(r,!1),e&&c.context.stroke(e);break;case"g":case"svg":break;default:(0,n.R)(`[SVG parser] <${b.nodeName}> elements unsupported`)}z&&(d=null);for(let b=0;b<w.length;b++)a(w[b],c,d,e)}(b,c,e,f)}}(a,this),this}restore(){let a=this._stateStack.pop();return a&&(this._transform=a.transform,this._fillStyle=a.fillStyle,this._strokeStyle=a.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(a){return this._transform.rotate(a),this}scale(a,b=a){return this._transform.scale(a,b),this}setTransform(a,b,c,d,e,f){return a instanceof h.u?this._transform.set(a.a,a.b,a.c,a.d,a.tx,a.ty):this._transform.set(a,b,c,d,e,f),this}transform(a,b,c,d,e,f){return a instanceof h.u?this._transform.append(a):(P.set(a,b,c,d,e,f),this._transform.append(P)),this}translate(a,b=a){return this._transform.translate(a,b),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,this.dirty||(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;let a=this._bounds;a.clear();for(let b=0;b<this.instructions.length;b++){let c=this.instructions[b],d=c.action;if("fill"===d){let b=c.data;a.addBounds(b.path.bounds)}else if("texture"===d){let b=c.data;a.addFrame(b.dx,b.dy,b.dx+b.dw,b.dy+b.dh,b.transform)}if("stroke"===d){let b=c.data,d=b.style.alignment,e=b.style.width*(1-d),f=b.path.bounds;a.addFrame(f.minX-e,f.minY-e,f.maxX+e,f.maxY+e)}}return a}containsPoint(a){if(!this.bounds.containsPoint(a.x,a.y))return!1;let b=this.instructions,c=!1;for(let d=0;d<b.length;d++){let e=b[d],f=e.data,g=f.path;if(!e.action||!g)continue;let h=f.style,i=g.shapePath.shapePrimitives;for(let b=0;b<i.length;b++){let d=i[b].shape;if(!h||!d)continue;let g=i[b].transform,j=g?g.applyInverse(a,O):a;c="fill"===e.action?d.contains(j.x,j.y):d.strokeContains(j.x,j.y,h.width,h.alignment);let k=f.hole;if(k){let a=k.shapePath?.shapePrimitives;if(a)for(let b=0;b<a.length;b++)a[b].shape.contains(j.x,j.y)&&(c=!1)}if(c)return!0}}return c}destroy(a=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),"boolean"==typeof a?a:a?.texture){let b="boolean"==typeof a?a:a?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(b)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(b))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Q.defaultFillStyle={color:0xffffff,alpha:1,texture:j.g.WHITE,matrix:null,fill:null,textureSpace:"local"},Q.defaultStrokeStyle={width:1,color:0xffffff,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:j.g.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let R=Q},74885:(a,b,c)=>{"use strict";c.d(b,{xv:()=>d}),c(57680);let d="8.14.3"},76518:(a,b,c)=>{"use strict";c.d(b,{gy:()=>f,J3:()=>g,GU:()=>h,sy:()=>j});var d=c(92913);let e=require("node:child_process");function f(a){(0,d.L)().prepare("DELETE FROM asset_search WHERE asset_id = ?").run(a)}function g(a){(0,d.L)().prepare("DELETE FROM asset_search WHERE project_id = ?").run(a)}function h(a){let b,c=(0,d.L)(),e=Math.min(Math.max(a.limit??50,1),200),f=0===(b=a.query.trim().split(/\s+/g).map(a=>a.replace(/["']/g,"").trim()).map(a=>a.replace(/[^a-zA-Z0-9_]+/g,"").trim()).filter(Boolean)).length?"":b.map(a=>`${a}*`).join(" ");return f?c.prepare(`SELECT
        a.*,
        ai.caption AS ai_caption,
        ai.tags_json AS ai_tags_json,
        ai.status AS ai_status,
        ai.model_version AS ai_model_version,
        ai.updated_at AS ai_updated_at
      FROM asset_search s
      JOIN assets a ON a.id = s.asset_id
      LEFT JOIN asset_ai ai ON ai.asset_id = a.id
      WHERE s.project_id = ? AND asset_search MATCH ?
      ORDER BY rank
      LIMIT ?`).all(a.projectId,f,e):c.prepare(`SELECT
          a.*,
          ai.caption AS ai_caption,
          ai.tags_json AS ai_tags_json,
          ai.status AS ai_status,
          ai.model_version AS ai_model_version,
          ai.updated_at AS ai_updated_at
        FROM assets a
        LEFT JOIN asset_ai ai ON ai.asset_id = a.id
        WHERE a.project_id = ?
        ORDER BY a.created_at DESC
        LIMIT ?`).all(a.projectId,e)}function i(){if(process.env.VERCEL)return!1;let a=(process.env.MOONDREAM_VECTOR_MODE||"off").toLowerCase();return"off"!==a&&"0"!==a&&"false"!==a}async function j(a){let b=Math.min(Math.max(a.limit??50,1),200);if(!i())return h({projectId:a.projectId,query:a.query,limit:b});let c=function(a){let b=a.query.trim();if(!b)return[];let c=function(a){if(!i())return null;let b=process.env.MOONDREAM_PYTHON||"python3",c=process.env.MOONDREAM_EMBEDDING_MODEL||"sentence-transformers/all-MiniLM-L6-v2",d=`
import json, os, sys
from sentence_transformers import SentenceTransformer
model = SentenceTransformer(os.environ.get("MOONDREAM_EMBEDDING_MODEL") or ${JSON.stringify(c)})
q = sys.stdin.read() or ""
vec = model.encode([q], normalize_embeddings=True)[0]
print(json.dumps({"model": os.environ.get("MOONDREAM_EMBEDDING_MODEL") or ${JSON.stringify(c)}, "dim": int(len(vec)), "vec": [float(x) for x in vec]}))
`.trim();try{let f=(0,e.execFileSync)(b,["-c",d],{input:a,env:{...process.env,MOONDREAM_EMBEDDING_MODEL:c},maxBuffer:0xa00000}).toString("utf8"),g=JSON.parse(f);if(!g?.vec?.length||!g?.dim)return null;return g}catch{return null}}(b);if(!c)return[];let f=(j=a.projectId,(0,d.L)().prepare(`SELECT e.asset_id AS asset_id, e.model AS model, e.dim AS dim, e.embedding AS embedding
       FROM asset_embeddings e
       JOIN assets a ON a.id = e.asset_id
       WHERE a.project_id = ? AND e.embedding IS NOT NULL`).all(j)).filter(a=>a.model===c.model);if(!f.length)return[];let g=new Float32Array(c.vec),h=[];for(let a of f){let b=a.embedding,c=new Float32Array(b.buffer,b.byteOffset,Math.floor(b.byteLength/4));c.length===g.length&&h.push({assetId:a.asset_id,score:function(a,b){let c=Math.min(a.length,b.length),d=0;for(let e=0;e<c;e++)d+=a[e]*b[e];return d}(g,c)})}h.sort((a,b)=>b.score-a.score);var j,k=h.slice(0,a.limit).map(a=>a.assetId);if(!k.length)return[];let l=(0,d.L)(),m=k.map(()=>"?").join(", "),n=k.map(()=>"WHEN ? THEN ?").join(" ");return l.prepare(`SELECT
        a.*,
        ai.caption AS ai_caption,
        ai.tags_json AS ai_tags_json,
        ai.status AS ai_status,
        ai.model_version AS ai_model_version,
        ai.updated_at AS ai_updated_at
      FROM assets a
      LEFT JOIN asset_ai ai ON ai.asset_id = a.id
      WHERE a.id IN (${m})
      ORDER BY CASE a.id ${n} ELSE 999999 END`).all(...k,...k.flatMap((a,b)=>[a,b]))}({projectId:a.projectId,query:a.query,limit:b});if("vector"===a.mode)return c.length?c:h({projectId:a.projectId,query:a.query,limit:b});let f=h({projectId:a.projectId,query:a.query,limit:b}),g=new Set,j=[];for(let a of c)if(!g.has(a.id)&&(g.add(a.id),j.push(a),j.length>=b))return j;for(let a of f)if(!g.has(a.id)&&(g.add(a.id),j.push(a),j.length>=b))break;return j}},76537:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>l,metadata:()=>j,viewport:()=>k});var d=c(5735),e=c(70210),f=c.n(e),g=c(30084),h=c.n(g);c(61135);var i=c(37195);let j={title:"Moondream Invite Canvas",description:"Local-first canvas for building layouts by dropping images onto an infinite board.",manifest:"/manifest.webmanifest"},k={themeColor:[{media:"(prefers-color-scheme: light)",color:"#ffffff"},{media:"(prefers-color-scheme: dark)",color:"#0a0a0a"}]};function l({children:a}){return(0,d.jsx)("html",{lang:"en",children:(0,d.jsxs)("body",{className:`${f().variable} ${h().variable} antialiased`,children:[(0,d.jsx)(i.ServiceWorkerRegister,{}),a]})})}},76760:a=>{"use strict";a.exports=require("node:path")},77219:(a,b,c)=>{"use strict";c.d(b,{l:()=>f});var d=c(87790),e=c(64974);class f extends e.mc{constructor(a){super(a),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new d.c(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty&&(this.updateBounds(),this._boundsDirty=!1),this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(a){this._roundPixels=+!!a}containsPoint(a){let b=this.bounds,{x:c,y:d}=a;return c>=b.minX&&c<=b.maxX&&d>=b.minY&&d<=b.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;let a=this.renderGroup||this.parentRenderGroup;a&&a.onChildViewUpdate(this)}destroy(a){for(let b in super.destroy(a),this._bounds=null,this._gpuData)this._gpuData[b].destroy?.();this._gpuData=null}collectRenderablesSimple(a,b,c){let{renderPipes:d}=b;d.blendMode.pushBlendMode(this,this.groupBlendMode,a),d[this.renderPipeId].addRenderable(this,a),this.didViewUpdate=!1;let e=this.children,f=e.length;for(let d=0;d<f;d++)e[d].collectRenderables(a,b,c);d.blendMode.popBlendMode(a)}}},78335:()=>{},79862:(a,b,c)=>{"use strict";c.d(b,{P:()=>g,_:()=>e});let d={};function e(a){return d[a]||(d[a]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${function(a){let b=[];if(1===a)b.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),b.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let c=0;for(let d=0;d<a;d++)b.push(`@group(1) @binding(${c++}) var textureSource${d+1}: texture_2d<f32>;`),b.push(`@group(1) @binding(${c++}) var textureSampler${d+1}: sampler;`)}return b.join("\n")}(a)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${function(a){let b=[];if(1===a)b.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{b.push("switch vTextureId {");for(let c=0;c<a;c++)c===a-1?b.push("  default:{"):b.push(`  case ${c}:{`),b.push(`      outColor = textureSampleGrad(textureSource${c+1}, textureSampler${c+1}, vUV, uvDx, uvDy);`),b.push("      break;}");b.push("}")}return b.join("\n")}(a)}
            `}}),d[a]}let f={};function g(a){return f[a]||(f[a]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${a}];

            `,main:`

                ${function(a){let b=[];for(let c=0;c<a;c++)c>0&&b.push("else"),c<a-1&&b.push(`if(vTextureId < ${c}.5)`),b.push("{"),b.push(`	outColor = texture(uTextures[${c}], vUV);`),b.push("}");return b.join("\n")}(a)}
            `}}),f[a]}},80225:(a,b,c)=>{"use strict";c.d(b,{F:()=>d,a:()=>e});let d={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},e={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}}},80424:(a,b,c)=>{"use strict";c.d(b,{n:()=>i});var d=c(57680),e=c(42115),f=c(71568);let g=Object.create(null),h=class a extends d.A{constructor(b={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,b={...a.defaultOptions,...b},this.addressMode=b.addressMode,this.addressModeU=b.addressModeU??this.addressModeU,this.addressModeV=b.addressModeV??this.addressModeV,this.addressModeW=b.addressModeW??this.addressModeW,this.scaleMode=b.scaleMode,this.magFilter=b.magFilter??this.magFilter,this.minFilter=b.minFilter??this.minFilter,this.mipmapFilter=b.mipmapFilter??this.mipmapFilter,this.lodMinClamp=b.lodMinClamp,this.lodMaxClamp=b.lodMaxClamp,this.compare=b.compare,this.maxAnisotropy=b.maxAnisotropy??1}set addressMode(a){this.addressModeU=a,this.addressModeV=a,this.addressModeW=a}get addressMode(){return this.addressModeU}set wrapMode(a){(0,f.t6)(f.lj,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=a}get wrapMode(){return this.addressMode}set scaleMode(a){this.magFilter=a,this.minFilter=a,this.mipmapFilter=a}get scaleMode(){return this.magFilter}set maxAnisotropy(a){this._maxAnisotropy=Math.min(a,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){let a,b=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=(void 0===(a=g[b])&&(g[b]=(0,e.L)("resource")),a),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};h.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let i=h},80639:a=>{"use strict";var b=Object.prototype.hasOwnProperty,c="~";function d(){}function e(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function f(a,b,d,f,g){if("function"!=typeof d)throw TypeError("The listener must be a function");var h=new e(d,f||a,g),i=c?c+b:b;return a._events[i]?a._events[i].fn?a._events[i]=[a._events[i],h]:a._events[i].push(h):(a._events[i]=h,a._eventsCount++),a}function g(a,b){0==--a._eventsCount?a._events=new d:delete a._events[b]}function h(){this._events=new d,this._eventsCount=0}Object.create&&(d.prototype=Object.create(null),new d().__proto__||(c=!1)),h.prototype.eventNames=function(){var a,d,e=[];if(0===this._eventsCount)return e;for(d in a=this._events)b.call(a,d)&&e.push(c?d.slice(1):d);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(a)):e},h.prototype.listeners=function(a){var b=c?c+a:a,d=this._events[b];if(!d)return[];if(d.fn)return[d.fn];for(var e=0,f=d.length,g=Array(f);e<f;e++)g[e]=d[e].fn;return g},h.prototype.listenerCount=function(a){var b=c?c+a:a,d=this._events[b];return d?d.fn?1:d.length:0},h.prototype.emit=function(a,b,d,e,f,g){var h=c?c+a:a;if(!this._events[h])return!1;var i,j,k=this._events[h],l=arguments.length;if(k.fn){switch(k.once&&this.removeListener(a,k.fn,void 0,!0),l){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,b),!0;case 3:return k.fn.call(k.context,b,d),!0;case 4:return k.fn.call(k.context,b,d,e),!0;case 5:return k.fn.call(k.context,b,d,e,f),!0;case 6:return k.fn.call(k.context,b,d,e,f,g),!0}for(j=1,i=Array(l-1);j<l;j++)i[j-1]=arguments[j];k.fn.apply(k.context,i)}else{var m,n=k.length;for(j=0;j<n;j++)switch(k[j].once&&this.removeListener(a,k[j].fn,void 0,!0),l){case 1:k[j].fn.call(k[j].context);break;case 2:k[j].fn.call(k[j].context,b);break;case 3:k[j].fn.call(k[j].context,b,d);break;case 4:k[j].fn.call(k[j].context,b,d,e);break;default:if(!i)for(m=1,i=Array(l-1);m<l;m++)i[m-1]=arguments[m];k[j].fn.apply(k[j].context,i)}}return!0},h.prototype.on=function(a,b,c){return f(this,a,b,c,!1)},h.prototype.once=function(a,b,c){return f(this,a,b,c,!0)},h.prototype.removeListener=function(a,b,d,e){var f=c?c+a:a;if(!this._events[f])return this;if(!b)return g(this,f),this;var h=this._events[f];if(h.fn)h.fn!==b||e&&!h.once||d&&h.context!==d||g(this,f);else{for(var i=0,j=[],k=h.length;i<k;i++)(h[i].fn!==b||e&&!h[i].once||d&&h[i].context!==d)&&j.push(h[i]);j.length?this._events[f]=1===j.length?j[0]:j:g(this,f)}return this},h.prototype.removeAllListeners=function(a){var b;return a?(b=c?c+a:a,this._events[b]&&g(this,b)):(this._events=new d,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=c,h.EventEmitter=h,a.exports=h},81618:(a,b,c)=>{"use strict";c.d(b,{A:()=>g});var d=c(71568),e=c(77219),f=c(73866);class g extends e.l{constructor(a){a instanceof f.T&&(a={context:a});const{context:b,roundPixels:c,...d}=a||{};super({label:"Graphics",...d}),this.renderPipeId="graphics",b?this._context=b:this._context=this._ownedContext=new f.T,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=c??!1}set context(a){a!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=a,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(a){return this._context.containsPoint(a)}destroy(a){this._ownedContext&&!a?this._ownedContext.destroy(a):(!0===a||a?.context===!0)&&this._context.destroy(a),this._ownedContext=null,this._context=null,super.destroy(a)}_callContextMethod(a,b){return this.context[a](...b),this}setFillStyle(...a){return this._callContextMethod("setFillStyle",a)}setStrokeStyle(...a){return this._callContextMethod("setStrokeStyle",a)}fill(...a){return this._callContextMethod("fill",a)}stroke(...a){return this._callContextMethod("stroke",a)}texture(...a){return this._callContextMethod("texture",a)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...a){return this._callContextMethod("arc",a)}arcTo(...a){return this._callContextMethod("arcTo",a)}arcToSvg(...a){return this._callContextMethod("arcToSvg",a)}bezierCurveTo(...a){return this._callContextMethod("bezierCurveTo",a)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...a){return this._callContextMethod("ellipse",a)}circle(...a){return this._callContextMethod("circle",a)}path(...a){return this._callContextMethod("path",a)}lineTo(...a){return this._callContextMethod("lineTo",a)}moveTo(...a){return this._callContextMethod("moveTo",a)}quadraticCurveTo(...a){return this._callContextMethod("quadraticCurveTo",a)}rect(...a){return this._callContextMethod("rect",a)}roundRect(...a){return this._callContextMethod("roundRect",a)}poly(...a){return this._callContextMethod("poly",a)}regularPoly(...a){return this._callContextMethod("regularPoly",a)}roundPoly(...a){return this._callContextMethod("roundPoly",a)}roundShape(...a){return this._callContextMethod("roundShape",a)}filletRect(...a){return this._callContextMethod("filletRect",a)}chamferRect(...a){return this._callContextMethod("chamferRect",a)}star(...a){return this._callContextMethod("star",a)}svg(...a){return this._callContextMethod("svg",a)}restore(...a){return this._callContextMethod("restore",a)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...a){return this._callContextMethod("rotate",a)}scaleTransform(...a){return this._callContextMethod("scale",a)}setTransform(...a){return this._callContextMethod("setTransform",a)}transform(...a){return this._callContextMethod("transform",a)}translateTransform(...a){return this._callContextMethod("translate",a)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(a){this._context.fillStyle=a}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(a){this._context.strokeStyle=a}clone(a=!1){return a?new g(this._context.clone()):(this._ownedContext=null,new g(this._context))}lineStyle(a,b,c){(0,d.t6)(d.lj,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");let e={};return a&&(e.width=a),b&&(e.color=b),c&&(e.alpha=c),this.context.strokeStyle=e,this}beginFill(a,b){(0,d.t6)(d.lj,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");let c={};return void 0!==a&&(c.color=a),void 0!==b&&(c.alpha=b),this.context.fillStyle=c,this}endFill(){(0,d.t6)(d.lj,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();let a=this.context.strokeStyle;return(a.width!==f.T.defaultStrokeStyle.width||a.color!==f.T.defaultStrokeStyle.color||a.alpha!==f.T.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...a){return(0,d.t6)(d.lj,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",a)}drawEllipse(...a){return(0,d.t6)(d.lj,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",a)}drawPolygon(...a){return(0,d.t6)(d.lj,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",a)}drawRect(...a){return(0,d.t6)(d.lj,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",a)}drawRoundedRect(...a){return(0,d.t6)(d.lj,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",a)}drawStar(...a){return(0,d.t6)(d.lj,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",a)}}},82298:(a,b,c)=>{"use strict";var d=c(45753),e=c(84443),f=c(20183),g=c(21283),h=c(61487),i=c(13901),j=c(91546),k=c(93141);let l=class a{constructor(a,b){this.linkedSheets=[];let c=a;a?.source instanceof k.v&&(c={texture:a,data:b});const{texture:d,data:e,cachePrefix:f=""}=c;this.cachePrefix=f,this._texture=d instanceof h.g?d:null,this.textureSource=d.source,this.textures={},this.animations={},this.data=e;const g=parseFloat(e.meta.scale);g?(this.resolution=g,d.source.resolution=this.resolution):this.resolution=d.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(b=>{this._callback=b,this._batchIndex=0,this._frameKeys.length<=a.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(b){let c=b,d=a.BATCH_SIZE;for(;c-b<d&&c<this._frameKeys.length;){let a=this._frameKeys[c],b=this._frames[a],d=b.frame;if(d){let c=null,e=null,f=!1!==b.trimmed&&b.sourceSize?b.sourceSize:b.frame,g=new j.M(0,0,Math.floor(f.w)/this.resolution,Math.floor(f.h)/this.resolution);c=b.rotated?new j.M(Math.floor(d.x)/this.resolution,Math.floor(d.y)/this.resolution,Math.floor(d.h)/this.resolution,Math.floor(d.w)/this.resolution):new j.M(Math.floor(d.x)/this.resolution,Math.floor(d.y)/this.resolution,Math.floor(d.w)/this.resolution,Math.floor(d.h)/this.resolution),!1!==b.trimmed&&b.spriteSourceSize&&(e=new j.M(Math.floor(b.spriteSourceSize.x)/this.resolution,Math.floor(b.spriteSourceSize.y)/this.resolution,Math.floor(d.w)/this.resolution,Math.floor(d.h)/this.resolution)),this.textures[a]=new h.g({source:this.textureSource,frame:c,orig:g,trim:e,rotate:2*!!b.rotated,defaultAnchor:b.anchor,defaultBorders:b.borders,label:a.toString()})}c++}}_processAnimations(){let a=this.data.animations||{};for(let b in a){this.animations[b]=[];for(let c=0;c<a[b].length;c++){let d=a[b][c];this.animations[b].push(this.textures[d])}}}_parseComplete(){let a=this._callback;this._callback=null,this._batchIndex=0,a.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*a.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*a.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(a=!1){for(let a in this.textures)this.textures[a].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,a&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};l.BATCH_SIZE=1e3;let m=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"],n={extension:d.Ag.Asset,cache:{test:a=>a instanceof l,getCacheableAssets:(a,b)=>(function a(b,c,d){let e={};if(b.forEach(a=>{e[a]=c}),Object.keys(c.textures).forEach(a=>{e[`${c.cachePrefix}${a}`]=c.textures[a]}),!d){let d=i.A.dirname(b[0]);c.linkedSheets.forEach((b,f)=>{Object.assign(e,a([`${d}/${c.data.meta.related_multi_packs[f]}`],b,!0))})}return e})(a,b,!1)},resolver:{extension:{type:d.Ag.ResolveParser,name:"resolveSpritesheet"},test:a=>{let b=a.split("?")[0].split("."),c=b.pop(),d=b.pop();return"json"===c&&m.includes(d)},parse:a=>{let b=a.split(".");return{resolution:parseFloat(f.x.RETINA_PREFIX.exec(a)?.[1]??"1"),format:b[b.length-2],src:a}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:d.Ag.LoadParser,priority:e.T.Normal,name:"spritesheetLoader"},testParse:async(a,b)=>".json"===i.A.extname(b.src).toLowerCase()&&!!a.frames,async parse(a,b,c){let d,{texture:e,imageFilename:f,textureOptions:j,cachePrefix:k}=b?.data??{},m=i.A.dirname(b.src);if(m&&m.lastIndexOf("/")!==m.length-1&&(m+="/"),e instanceof h.g)d=e;else{let e=(0,g.Y)(m+(f??a.meta.image),b.src);d=(await c.load([{src:e,data:j}]))[e]}let n=new l({texture:d.source,data:a,cachePrefix:k});await n.parse();let o=a?.meta?.related_multi_packs;if(Array.isArray(o)){let a=[];for(let d of o){if("string"!=typeof d)continue;let e=m+d;b.data?.ignoreMultiPack||(e=(0,g.Y)(e,b.src),a.push(c.load({src:e,data:{textureOptions:j,ignoreMultiPack:!0}})))}let d=await Promise.all(a);n.linkedSheets=d,d.forEach(a=>{a.linkedSheets=[n].concat(n.linkedSheets.filter(b=>b!==a))})}return n},async unload(a,b,c){await c.unload(a.textureSource._sourceOrigin),a.destroy(!1)}}};d.XO.add(n)},83305:(a,b,c)=>{"use strict";c.d(b,{U:()=>f});let d={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},e=class a{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(a){!!(1&this.data)!==a&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(a){!!(2&this.data)!==a&&(this.data^=2)}set cullMode(a){if("none"===a){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace="front"===a}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(4&this.data)}set culling(a){!!(4&this.data)!==a&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(a){!!(8&this.data)!==a&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(a){!!(32&this.data)!==a&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(a){!!(16&this.data)!==a&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(a){this.blend="none"!==a,this._blendMode=a,this._blendModeId=d[a]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(a){this.offsets=!!a,this._polygonOffset=a}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){let b=new a;return b.depthTest=!1,b.blend=!0,b}};e.default2d=e.for2d();let f=e},83401:(a,b,c)=>{"use strict";c.d(b,{L:()=>d});let d={_registeredResources:new Set,register(a){this._registeredResources.add(a)},unregister(a){this._registeredResources.delete(a)},release(){this._registeredResources.forEach(a=>a.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(a){return this._registeredResources.has(a)},reset(){this._registeredResources.clear()}}},84195:(a,b,c)=>{"use strict";c.d(b,{GH:()=>_});var d=c(45753),e=c(21579),f=c(36519),g=c(20402),h=c(71568),i=c(6672),j=c(48419),k=c(91546);function l(a,b,c,d,e){let f=b.a,g=b.b,h=b.c,i=b.d,j=b.tx,k=b.ty;c||(c=0),d||(d=2),e||(e=a.length/d-c);let l=c*d;for(let b=0;b<e;b++){let b=a[l],c=a[l+1];a[l]=f*b+h*c+j,a[l+1]=g*b+i*c+k,l+=d}}var m=c(61487),n=c(9848);let o={extension:{type:d.Ag.ShapeBuilder,name:"circle"},build(a,b){let c,d,e,f,g,h;if("circle"===a.type){if((g=h=a.radius)<=0)return!1;c=a.x,d=a.y,e=f=0}else if("ellipse"===a.type){if(g=a.halfWidth,h=a.halfHeight,g<=0||h<=0)return!1;c=a.x,d=a.y,e=f=0}else{let b=a.width/2,i=a.height/2;c=a.x+b,d=a.y+i,g=h=Math.max(0,Math.min(a.radius,Math.min(b,i))),e=b-g,f=i-h}if(e<0||f<0)return!1;let i=Math.ceil(2.3*Math.sqrt(g+h)),j=8*i+4*!!e+4*!!f;if(0===j)return!1;if(0===i)return b[0]=b[6]=c+e,b[1]=b[3]=d+f,b[2]=b[4]=c-e,b[5]=b[7]=d-f,!0;let k=0,l=4*i+2*!!e+2,m=l,n=j,o=e+g,p=f,q=c+o,r=c-o,s=d+p;if(b[k++]=q,b[k++]=s,b[--l]=s,b[--l]=r,f){let a=d-p;b[m++]=r,b[m++]=a,b[--n]=a,b[--n]=q}for(let a=1;a<i;a++){let j=Math.PI/2*(a/i),o=e+Math.cos(j)*g,p=f+Math.sin(j)*h,q=c+o,r=c-o,s=d+p,t=d-p;b[k++]=q,b[k++]=s,b[--l]=s,b[--l]=r,b[m++]=r,b[m++]=t,b[--n]=t,b[--n]=q}o=e,p=f+h,q=c+o,r=c-o,s=d+p;let t=d-p;return b[k++]=q,b[k++]=s,b[--n]=t,b[--n]=q,e&&(b[k++]=r,b[k++]=s,b[--n]=t,b[--n]=r),!0},triangulate(a,b,c,d,e,f){if(0===a.length)return;let g=0,h=0;for(let b=0;b<a.length;b+=2)g+=a[b],h+=a[b+1];g/=a.length/2,h/=a.length/2;let i=d;b[i*c]=g,b[i*c+1]=h;let j=i++;for(let d=0;d<a.length;d+=2)b[i*c]=a[d],b[i*c+1]=a[d+1],d>0&&(e[f++]=i,e[f++]=j,e[f++]=i-1),i++;e[f++]=j+1,e[f++]=j,e[f++]=i-1}},p={...o,extension:{...o.extension,name:"ellipse"}},q={...o,extension:{...o.extension,name:"roundedRectangle"}};var r=c(21783);function s(a,b,c,d,e,f,g,h){let i,j;g?(i=d,j=-c):(i=-d,j=c);let k=a-c*e+i,l=b-d*e+j,m=a+c*f+i,n=b+d*f+j;return h.push(k,l),h.push(m,n),2}function t(a,b,c,d,e,f,g,h){let i=c-a,j=d-b,k=Math.atan2(i,j),l=Math.atan2(e-a,f-b);h&&k<l?k+=2*Math.PI:!h&&k>l&&(l+=2*Math.PI);let m=k,n=l-k,o=Math.sqrt(i*i+j*j),p=(15*Math.abs(n)*Math.sqrt(o)/Math.PI|0)+1,q=n/p;if(m+=q,h){g.push(a,b),g.push(c,d);for(let c=1,d=m;c<p;c++,d+=q)g.push(a,b),g.push(a+Math.sin(d)*o,b+Math.cos(d)*o);g.push(a,b),g.push(e,f)}else{g.push(c,d),g.push(a,b);for(let c=1,d=m;c<p;c++,d+=q)g.push(a+Math.sin(d)*o,b+Math.cos(d)*o),g.push(a,b);g.push(e,f),g.push(a,b)}return 2*p}function u(a,b,c=2){let d,e,f,g=b&&b.length,h=g?b[0]*c:a.length,i=v(a,0,h,c,!0),j=[];if(!i||i.next===i.prev)return j;if(g&&(i=function(a,b,c,d){let e=[];for(let c=0,f=b.length;c<f;c++){let g=b[c]*d,h=c<f-1?b[c+1]*d:a.length,i=v(a,g,h,d,!1);i===i.next&&(i.steiner=!0),e.push(function(a){let b=a,c=a;do(b.x<c.x||b.x===c.x&&b.y<c.y)&&(c=b),b=b.next;while(b!==a);return c}(i))}e.sort(x);for(let a=0;a<e.length;a++)c=function(a,b){let c=function(a,b){let c,d=b,e=a.x,f=a.y,g=-1/0;if(C(a,d))return d;do{if(C(a,d.next))return d.next;if(f<=d.y&&f>=d.next.y&&d.next.y!==d.y){let a=d.x+(f-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(a<=e&&a>g&&(g=a,c=d.x<d.next.x?d:d.next,a===e))return c}d=d.next}while(d!==b);if(!c)return null;let h=c,i=c.x,j=c.y,k=1/0;d=c;do{if(e>=d.x&&d.x>=i&&e!==d.x&&z(f<j?e:g,f,i,j,f<j?g:e,f,d.x,d.y)){var l,m;let b=Math.abs(f-d.y)/(e-d.x);G(d,a)&&(b<k||b===k&&(d.x>c.x||d.x===c.x&&(l=c,m=d,0>B(l.prev,l,m.prev)&&0>B(m.next,l,l.next))))&&(c=d,k=b)}d=d.next}while(d!==h);return c}(a,b);if(!c)return b;let d=H(c,a);return w(d,d.next),w(c,c.next)}(e[a],c);return c}(a,b,i,c)),a.length>80*c){d=a[0],e=a[1];let b=d,g=e;for(let f=c;f<h;f+=c){let c=a[f],h=a[f+1];c<d&&(d=c),h<e&&(e=h),c>b&&(b=c),h>g&&(g=h)}f=0!==(f=Math.max(b-d,g-e))?32767/f:0}return function a(b,c,d,e,f,g,h){if(!b)return;!h&&g&&function(a,b,c,d){let e=a;do 0===e.z&&(e.z=y(e.x,e.y,b,c,d)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next;while(e!==a);e.prevZ.nextZ=null,e.prevZ=null,function(a){let b,c=1;do{let d,e=a;a=null;let f=null;for(b=0;e;){b++;let g=e,h=0;for(let a=0;a<c&&(h++,g=g.nextZ);a++);let i=c;for(;h>0||i>0&&g;)0!==h&&(0===i||!g||e.z<=g.z)?(d=e,e=e.nextZ,h--):(d=g,g=g.nextZ,i--),f?f.nextZ=d:a=d,d.prevZ=f,f=d;e=g}f.nextZ=null,c*=2}while(b>1)}(e)}(b,e,f,g);let i=b;for(;b.prev!==b.next;){let j=b.prev,k=b.next;if(g?function(a,b,c,d){let e=a.prev,f=a.next;if(B(e,a,f)>=0)return!1;let g=e.x,h=a.x,i=f.x,j=e.y,k=a.y,l=f.y,m=Math.min(g,h,i),n=Math.min(j,k,l),o=Math.max(g,h,i),p=Math.max(j,k,l),q=y(m,n,b,c,d),r=y(o,p,b,c,d),s=a.prevZ,t=a.nextZ;for(;s&&s.z>=q&&t&&t.z<=r;){if(s.x>=m&&s.x<=o&&s.y>=n&&s.y<=p&&s!==e&&s!==f&&A(g,j,h,k,i,l,s.x,s.y)&&B(s.prev,s,s.next)>=0||(s=s.prevZ,t.x>=m&&t.x<=o&&t.y>=n&&t.y<=p&&t!==e&&t!==f&&A(g,j,h,k,i,l,t.x,t.y)&&B(t.prev,t,t.next)>=0))return!1;t=t.nextZ}for(;s&&s.z>=q;){if(s.x>=m&&s.x<=o&&s.y>=n&&s.y<=p&&s!==e&&s!==f&&A(g,j,h,k,i,l,s.x,s.y)&&B(s.prev,s,s.next)>=0)return!1;s=s.prevZ}for(;t&&t.z<=r;){if(t.x>=m&&t.x<=o&&t.y>=n&&t.y<=p&&t!==e&&t!==f&&A(g,j,h,k,i,l,t.x,t.y)&&B(t.prev,t,t.next)>=0)return!1;t=t.nextZ}return!0}(b,e,f,g):function(a){let b=a.prev,c=a.next;if(B(b,a,c)>=0)return!1;let d=b.x,e=a.x,f=c.x,g=b.y,h=a.y,i=c.y,j=Math.min(d,e,f),k=Math.min(g,h,i),l=Math.max(d,e,f),m=Math.max(g,h,i),n=c.next;for(;n!==b;){if(n.x>=j&&n.x<=l&&n.y>=k&&n.y<=m&&A(d,g,e,h,f,i,n.x,n.y)&&B(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}(b)){c.push(j.i,b.i,k.i),J(b),b=k.next,i=k.next;continue}if((b=k)===i){h?1===h?a(b=function(a,b){let c=a;do{let d=c.prev,e=c.next.next;!C(d,e)&&D(d,c,c.next,e)&&G(d,e)&&G(e,d)&&(b.push(d.i,c.i,e.i),J(c),J(c.next),c=a=e),c=c.next}while(c!==a);return w(c)}(w(b),c),c,d,e,f,g,2):2===h&&function(b,c,d,e,f,g){let h=b;do{let b=h.next.next;for(;b!==h.prev;){var i,j;if(h.i!==b.i&&(i=h,j=b,i.next.i!==j.i&&i.prev.i!==j.i&&!function(a,b){let c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&D(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1}(i,j)&&(G(i,j)&&G(j,i)&&function(a,b){let c=a,d=!1,e=(a.x+b.x)/2,f=(a.y+b.y)/2;do c.y>f!=c.next.y>f&&c.next.y!==c.y&&e<(c.next.x-c.x)*(f-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next;while(c!==a);return d}(i,j)&&(B(i.prev,i,j.prev)||B(i,j.prev,j))||C(i,j)&&B(i.prev,i,i.next)>0&&B(j.prev,j,j.next)>0))){let i=H(h,b);h=w(h,h.next),i=w(i,i.next),a(h,c,d,e,f,g,0),a(i,c,d,e,f,g,0);return}b=b.next}h=h.next}while(h!==b)}(b,c,d,e,f,g):a(w(b),c,d,e,f,g,1);break}}}(i,j,c,d,e,f,0),j}function v(a,b,c,d,e){let f;if(e===function(a,b,c,d){let e=0;for(let f=b,g=c-d;f<c;f+=d)e+=(a[g]-a[f])*(a[f+1]+a[g+1]),g=f;return e}(a,b,c,d)>0)for(let e=b;e<c;e+=d)f=I(e/d|0,a[e],a[e+1],f);else for(let e=c-d;e>=b;e-=d)f=I(e/d|0,a[e],a[e+1],f);return f&&C(f,f.next)&&(J(f),f=f.next),f}function w(a,b){if(!a)return a;b||(b=a);let c=a,d;do if(d=!1,!c.steiner&&(C(c,c.next)||0===B(c.prev,c,c.next))){if(J(c),(c=b=c.prev)===c.next)break;d=!0}else c=c.next;while(d||c!==b);return b}function x(a,b){let c=a.x-b.x;return 0===c&&0==(c=a.y-b.y)&&(c=(a.next.y-a.y)/(a.next.x-a.x)-(b.next.y-b.y)/(b.next.x-b.x)),c}function y(a,b,c,d,e){return(a=((a=((a=((a=((a=(a-c)*e|0)|a<<8)&0xff00ff)|a<<4)&0xf0f0f0f)|a<<2)&0x33333333)|a<<1)&0x55555555)|(b=((b=((b=((b=((b=(b-d)*e|0)|b<<8)&0xff00ff)|b<<4)&0xf0f0f0f)|b<<2)&0x33333333)|b<<1)&0x55555555)<<1}function z(a,b,c,d,e,f,g,h){return(e-g)*(b-h)>=(a-g)*(f-h)&&(a-g)*(d-h)>=(c-g)*(b-h)&&(c-g)*(f-h)>=(e-g)*(d-h)}function A(a,b,c,d,e,f,g,h){return(a!==g||b!==h)&&z(a,b,c,d,e,f,g,h)}function B(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function C(a,b){return a.x===b.x&&a.y===b.y}function D(a,b,c,d){let e=F(B(a,b,c)),f=F(B(a,b,d)),g=F(B(c,d,a)),h=F(B(c,d,b));return!!(e!==f&&g!==h||0===e&&E(a,c,b)||0===f&&E(a,d,b)||0===g&&E(c,a,d)||0===h&&E(c,b,d))}function E(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}function F(a){return a>0?1:a<0?-1:0}function G(a,b){return 0>B(a.prev,a,a.next)?B(a,b,a.next)>=0&&B(a,a.prev,b)>=0:0>B(a,b,a.prev)||0>B(a,a.next,b)}function H(a,b){let c=K(a.i,a.x,a.y),d=K(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function I(a,b,c,d){let e=K(a,b,c);return d?(e.next=d.next,e.prev=d,d.next.prev=e,d.next=e):(e.prev=e,e.next=e),e}function J(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function K(a,b,c){return{i:a,x:b,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}c(57680);let L=u.default||u;function M(a,b,c,d,e,f,g){let h=L(a,b,2);if(!h)return;for(let a=0;a<h.length;a+=3)f[g++]=h[a]+e,f[g++]=h[a+1]+e,f[g++]=h[a+2]+e;let i=e*d;for(let b=0;b<a.length;b+=2)c[i]=a[b],c[i+1]=a[b+1],i+=d}let N=[],O={extension:{type:d.Ag.ShapeBuilder,name:"polygon"},build(a,b){for(let c=0;c<a.points.length;c++)b[c]=a.points[c];return!0},triangulate(a,b,c,d,e,f){M(a,N,b,c,d,e,f)}},P={extension:{type:d.Ag.ShapeBuilder,name:"rectangle"},build(a,b){let c=a.x,d=a.y,e=a.width,f=a.height;return!!(e>0&&f>0)&&(b[0]=c,b[1]=d,b[2]=c+e,b[3]=d,b[4]=c+e,b[5]=d+f,b[6]=c,b[7]=d+f,!0)},triangulate(a,b,c,d,e,f){let g=0;b[(d*=c)+g]=a[0],b[d+g+1]=a[1],g+=c,b[d+g]=a[2],b[d+g+1]=a[3],g+=c,b[d+g]=a[6],b[d+g+1]=a[7],g+=c,b[d+g]=a[4],b[d+g+1]=a[5],g+=c;let h=d/c;e[f++]=h,e[f++]=h+1,e[f++]=h+2,e[f++]=h+1,e[f++]=h+3,e[f++]=h+2}},Q={extension:{type:d.Ag.ShapeBuilder,name:"triangle"},build:(a,b)=>(b[0]=a.x,b[1]=a.y,b[2]=a.x2,b[3]=a.y2,b[4]=a.x3,b[5]=a.y3,!0),triangulate(a,b,c,d,e,f){let g=0;b[(d*=c)+g]=a[0],b[d+g+1]=a[1],g+=c,b[d+g]=a[2],b[d+g+1]=a[3],g+=c,b[d+g]=a[4],b[d+g+1]=a[5];let h=d/c;e[f++]=h,e[f++]=h+1,e[f++]=h+2}};var R=c(41890);let S=new j.u,T=new k.M,U={};d.XO.handleByMap(d.Ag.ShapeBuilder,U),d.XO.add(P,O,Q,o,p,q);let V=new k.M,W=new j.u;function X(a,b,c,d,e){let{vertices:f,uvs:g,indices:h}=e;a.shapePrimitives.forEach(({shape:a,transform:j,holes:k})=>{let o=[],p=U[a.type];if(!p.build(a,o))return;let q=h.length,u=f.length/2,v="triangle-list";if(j&&l(o,j),c){let c=a.closePath??!0;b.pixelLine?(!function(a,b,c,d){if(0===a.length)return;let e=a[0],f=a[1],g=a[a.length-2],h=a[a.length-1],i=b||1e-4>Math.abs(e-g)&&1e-4>Math.abs(f-h),j=a.length/2,k=c.length/2;for(let b=0;b<j;b++)c.push(a[2*b]),c.push(a[2*b+1]);for(let a=0;a<j-1;a++)d.push(k+a,k+a+1);i&&d.push(k+j-1,k)}(o,c,f,h),v="line-list"):function(a,b,c,d,e,f){if(0===a.length)return;let g=b.alignment;if(.5!==b.alignment){let b=function(a){let b=a.length;if(b<6)return 1;let c=0;for(let d=0,e=a[b-2],f=a[b-1];d<b;d+=2){let b=a[d],g=a[d+1];c+=(b-e)*(g+f),e=b,f=g}return c<0?-1:1}(a);c&&(b*=-1),g=(g-.5)*b+.5}let h=new r.b(a[0],a[1]),i=new r.b(a[a.length-2],a[a.length-1]),j=1e-4>Math.abs(h.x-i.x)&&1e-4>Math.abs(h.y-i.y);if(d){a=a.slice(),j&&(a.pop(),a.pop(),i.set(a[a.length-2],a[a.length-1]));let b=(h.x+i.x)*.5,c=(i.y+h.y)*.5;a.unshift(b,c),a.push(b,c)}let k=a.length/2,l=a.length,m=e.length/2,n=b.width/2,o=n*n,p=b.miterLimit*b.miterLimit,q=a[0],u=a[1],v=a[2],w=a[3],x=0,y=0,z=-(u-w),A=q-v,B=0,C=0,D=Math.sqrt(z*z+A*A);z/=D,A/=D,z*=n,A*=n;let E=g,F=(1-E)*2,G=2*E;d||("round"===b.cap?l+=t(q-z*(F-G)*.5,u-A*(F-G)*.5,q-z*F,u-A*F,q+z*G,u+A*G,e,!0)+2:"square"===b.cap&&(l+=s(q,u,z,A,F,G,!0,e))),e.push(q-z*F,u-A*F),e.push(q+z*G,u+A*G);for(let c=1;c<k-1;++c){q=a[(c-1)*2],u=a[(c-1)*2+1],v=a[2*c],w=a[2*c+1],x=a[(c+1)*2],y=a[(c+1)*2+1],D=Math.sqrt((z=-(u-w))*z+(A=q-v)*A),z/=D,A/=D,z*=n,A*=n,D=Math.sqrt((B=-(w-y))*B+(C=v-x)*C),B/=D,C/=D,B*=n,C*=n;let d=v-q,f=u-w,g=v-x,h=y-w,i=d*g+f*h,j=f*g-h*d,k=j<0;if(Math.abs(j)<.001*Math.abs(i)){e.push(v-z*F,w-A*F),e.push(v+z*G,w+A*G),i>=0&&("round"===b.join?l+=t(v,w,v-z*F,w-A*F,v-B*F,w-C*F,e,!1)+4:l+=2,e.push(v-B*G,w-C*G),e.push(v+B*F,w+C*F));continue}let m=(-z+q)*(-A+w)-(-z+v)*(-A+u),r=(-B+x)*(-C+w)-(-B+v)*(-C+y),s=(d*r-g*m)/j,E=(h*m-f*r)/j,H=(s-v)*(s-v)+(E-w)*(E-w),I=v+(s-v)*F,J=w+(E-w)*F,K=v-(s-v)*G,L=w-(E-w)*G,M=k?F:G;H<=Math.min(d*d+f*f,g*g+h*h)+M*M*o?"bevel"===b.join||H/o>p?(k?(e.push(I,J),e.push(v+z*G,w+A*G),e.push(I,J),e.push(v+B*G,w+C*G)):(e.push(v-z*F,w-A*F),e.push(K,L),e.push(v-B*F,w-C*F),e.push(K,L)),l+=2):"round"===b.join?k?(e.push(I,J),e.push(v+z*G,w+A*G),l+=t(v,w,v+z*G,w+A*G,v+B*G,w+C*G,e,!0)+4,e.push(I,J),e.push(v+B*G,w+C*G)):(e.push(v-z*F,w-A*F),e.push(K,L),l+=t(v,w,v-z*F,w-A*F,v-B*F,w-C*F,e,!1)+4,e.push(v-B*F,w-C*F),e.push(K,L)):(e.push(I,J),e.push(K,L)):(e.push(v-z*F,w-A*F),e.push(v+z*G,w+A*G),"round"===b.join?k?l+=t(v,w,v+z*G,w+A*G,v+B*G,w+C*G,e,!0)+2:l+=t(v,w,v-z*F,w-A*F,v-B*F,w-C*F,e,!1)+2:"miter"===b.join&&H/o<=p&&(k?(e.push(K,L),e.push(K,L)):(e.push(I,J),e.push(I,J)),l+=2),e.push(v-B*F,w-C*F),e.push(v+B*G,w+C*G),l+=2)}q=a[(k-2)*2],u=a[(k-2)*2+1],v=a[(k-1)*2],D=Math.sqrt((z=-(u-(w=a[(k-1)*2+1])))*z+(A=q-v)*A),z/=D,A/=D,z*=n,A*=n,e.push(v-z*F,w-A*F),e.push(v+z*G,w+A*G),d||("round"===b.cap?l+=t(v-z*(F-G)*.5,w-A*(F-G)*.5,v-z*F,w-A*F,v+z*G,w+A*G,e,!1)+2:"square"===b.cap&&(l+=s(v,w,z,A,F,G,!1,e)));let H=1e-4*1e-4;for(let a=m;a<l+m-2;++a)q=e[2*a],u=e[2*a+1],v=e[(a+1)*2],w=e[(a+1)*2+1],x=e[(a+2)*2],Math.abs(q*(w-(y=e[(a+2)*2+1]))+v*(y-u)+x*(u-w))<H||f.push(a,a+1,a+2)}(o,b,!1,c,f,h)}else if(k){let a=[],b=o.slice();(function(a){let b=[];for(let c=0;c<a.length;c++){let d=a[c].shape,e=[];U[d.type].build(d,e)&&b.push(e)}return b})(k).forEach(c=>{a.push(b.length/2),b.push(...c)}),M(b,a,f,2,u,h,q)}else p.triangulate(o,f,2,u,h,q);let w=g.length/2,x=b.texture;if(x!==m.g.WHITE){let c=function(a,b,c,d){let e=b.matrix?a.copyFrom(b.matrix).invert():a.identity();if("local"===b.textureSpace){let a=c.getBounds(T);b.width&&a.pad(b.width);let{x:d,y:f}=a,g=1/a.width,h=1/a.height,i=-d*g,j=-f*h,k=e.a,l=e.b,m=e.c,n=e.d;e.a*=g,e.b*=g,e.c*=h,e.d*=h,e.tx=i*k+j*m+e.tx,e.ty=i*l+j*n+e.ty}else e.translate(b.texture.frame.x,b.texture.frame.y),e.scale(1/b.texture.source.width,1/b.texture.source.height);let f=b.texture.source.style;return b.fill instanceof R._||"clamp-to-edge"!==f.addressMode||(f.addressMode="repeat",f.update()),d&&e.append(S.copyFrom(d).invert()),e}(W,b,a,j);!function(a,b,c,d,e,f,g,h=null){let i=0;c*=2,e*=2;let j=h.a,k=h.b,l=h.c,m=h.d,n=h.tx,o=h.ty;for(;i<g;){let b=a[c],f=a[c+1];d[e]=j*b+l*f+n,d[e+1]=k*b+m*f+o,e+=2,c+=2,i++}}(f,0,u,g,w,0,f.length/2-u,c)}else{var y=w,z=f.length/2-u;let a=0;for(y*=2;a<z;)g[y]=0,g[y+1]=0,y+=2,a++}let A=i.Z.get(n.G);A.indexOffset=q,A.indexSize=h.length-q,A.attributeOffset=u,A.attributeSize=f.length/2-u,A.baseColor=b.color,A.alpha=b.alpha,A.texture=x,A.geometryData=e,A.topology=v,d.push(A)})}class Y{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Z{constructor(){this.instructions=new g.L}init(a){let b=a.maxTextures;this.batcher?this.batcher._updateMaxTextures(b):this.batcher=new f.J({maxTextures:b}),this.instructions.reset()}get geometry(){return(0,h.t6)(h.Ek,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}let $=class a{constructor(a){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=a,a.renderableGC.addManagedHash(this,"_gpuContextHash"),a.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(b){a.defaultOptions.bezierSmoothness=b?.bezierSmoothness??a.defaultOptions.bezierSmoothness}getContextRenderData(a){return this._graphicsDataContextHash[a.uid]||this._initContextRenderData(a)}updateGpuContext(a){let b=this._gpuContextHash[a.uid]||this._initContext(a);if(a.dirty){b?this._cleanGraphicsContextData(a):b=this._initContext(a),function(a,b){let{geometryData:c,batches:d}=b;d.length=0,c.indices.length=0,c.vertices.length=0,c.uvs.length=0;for(let b=0;b<a.instructions.length;b++){let e=a.instructions[b];if("texture"===e.action)!function(a,b,c){let d=[],e=U.rectangle;V.x=a.dx,V.y=a.dy,V.width=a.dw,V.height=a.dh;let f=a.transform;if(!e.build(V,d))return;let{vertices:g,uvs:h,indices:j}=c,k=j.length,m=g.length/2;f&&l(d,f),e.triangulate(d,g,2,m,j,k);let o=a.image,p=o.uvs;h.push(p.x0,p.y0,p.x1,p.y1,p.x3,p.y3,p.x2,p.y2);let q=i.Z.get(n.G);q.indexOffset=k,q.indexSize=j.length-k,q.attributeOffset=m,q.attributeSize=g.length/2-m,q.baseColor=a.style,q.alpha=a.alpha,q.texture=o,q.geometryData=c,b.push(q)}(e.data,d,c);else if("fill"===e.action||"stroke"===e.action){let a="stroke"===e.action,b=e.data.path.shapePath,f=e.data.style,g=e.data.hole;a&&g&&X(g.shapePath,f,!0,d,c),g&&(b.shapePrimitives[b.shapePrimitives.length-1].holes=g.shapePath.shapePrimitives),X(b,f,a,d,c)}}}(a,b);let c=a.batchMode;a.customShader||"no-batch"===c?b.isBatchable=!1:"auto"===c?b.isBatchable=b.geometryData.vertices.length<400:b.isBatchable=!0,a.dirty=!1}return b}getGpuContext(a){return this._gpuContextHash[a.uid]||this._initContext(a)}_initContextRenderData(a){let b=i.Z.get(Z,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:c,geometryData:d}=this._gpuContextHash[a.uid],f=d.vertices.length,g=d.indices.length;for(let a=0;a<c.length;a++)c[a].applyTransform=!1;let h=b.batcher;h.ensureAttributeBuffer(f),h.ensureIndexBuffer(g),h.begin();for(let a=0;a<c.length;a++){let b=c[a];h.add(b)}h.finish(b.instructions);let j=h.geometry;j.indexBuffer.setDataWithSize(h.indexBuffer,h.indexSize,!0),j.buffers[0].setDataWithSize(h.attributeBuffer.float32View,h.attributeSize,!0);let k=h.batches;for(let a=0;a<k.length;a++){let b=k[a];b.bindGroup=(0,e.w)(b.textures.textures,b.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[a.uid]=b,b}_initContext(a){let b=new Y;return b.context=a,this._gpuContextHash[a.uid]=b,a.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[a.uid]}onGraphicsContextDestroy(a){this._cleanGraphicsContextData(a),a.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[a.uid]=null}_cleanGraphicsContextData(a){let b=this._gpuContextHash[a.uid];!b.isBatchable&&this._graphicsDataContextHash[a.uid]&&(i.Z.return(this.getContextRenderData(a)),this._graphicsDataContextHash[a.uid]=null),b.batches&&b.batches.forEach(a=>{i.Z.return(a)})}destroy(){for(let a in this._gpuContextHash)this._gpuContextHash[a]&&this.onGraphicsContextDestroy(this._gpuContextHash[a].context);this._gpuContextHash={},this._graphicsDataContextHash={},this._renderer=null}};$.extension={type:[d.Ag.WebGLSystem,d.Ag.WebGPUSystem,d.Ag.CanvasSystem],name:"graphicsContext"},$.defaultOptions={bezierSmoothness:.5};let _=$},84434:(a,b,c)=>{"use strict";c.d(b,{N:()=>f});var d=c(48419);let e=new d.u;class f{constructor(a,b){this.mapCoord=new d.u,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,void 0===b?this.clampMargin=a.width<10?0:.5:this.clampMargin=b,this.isSimple=!1,this.texture=a}get texture(){return this._texture}set texture(a){this.texture!==a&&(this._texture?.removeListener("update",this.update,this),this._texture=a,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(a,b){void 0===b&&(b=a);let c=this.mapCoord;for(let d=0;d<a.length;d+=2){let e=a[d],f=a[d+1];b[d]=e*c.a+f*c.c+c.tx,b[d+1]=e*c.b+f*c.d+c.ty}return b}update(){let a=this._texture;this._updateID++;let b=a.uvs;this.mapCoord.set(b.x1-b.x0,b.y1-b.y0,b.x3-b.x0,b.y3-b.y0,b.x0,b.y0);let c=a.orig,d=a.trim;d&&(e.set(c.width/d.width,0,0,c.height/d.height,-d.x/d.width,-d.y/d.height),this.mapCoord.append(e));let f=a.source,g=this.uClampFrame,h=this.clampMargin/f._resolution,i=this.clampOffset/f._resolution;return g[0]=(a.frame.x+h+i)/f.width,g[1]=(a.frame.y+h+i)/f.height,g[2]=(a.frame.x+a.frame.width-h+i)/f.width,g[3]=(a.frame.y+a.frame.height-h+i)/f.height,this.uClampOffset[0]=this.clampOffset/f.pixelWidth,this.uClampOffset[1]=this.clampOffset/f.pixelHeight,this.isSimple=a.frame.width===f.width&&a.frame.height===f.height&&0===a.rotate,!0}}},84443:(a,b,c)=>{"use strict";c.d(b,{T:()=>e});var d,e=((d=e||{})[d.Low=0]="Low",d[d.Normal=1]="Normal",d[d.High=2]="High",d)},84623:(a,b,c)=>{"use strict";c.d(b,{AO:()=>i,km:()=>h,p_:()=>g,qs:()=>f});var d=c(92913),e=c(76518);function f(a){let b=(0,d.L)(),c=Math.min(Math.max(a.limit??50,1),200),e=Math.max(a.offset??0,0);return b.prepare(`SELECT
        a.*,
        ai.caption AS ai_caption,
        ai.tags_json AS ai_tags_json,
        ai.status AS ai_status,
        ai.model_version AS ai_model_version,
        ai.updated_at AS ai_updated_at
      FROM assets a
      LEFT JOIN asset_ai ai ON ai.asset_id = a.id
      WHERE a.project_id = ?
      ORDER BY a.created_at DESC
      LIMIT ? OFFSET ?`).all(a.projectId,c,e)}function g(a){return(0,d.L)().prepare(`SELECT
          a.*,
          ai.caption AS ai_caption,
          ai.tags_json AS ai_tags_json,
          ai.status AS ai_status,
          ai.model_version AS ai_model_version,
          ai.updated_at AS ai_updated_at
        FROM assets a
        LEFT JOIN asset_ai ai ON ai.asset_id = a.id
        WHERE a.id = ?`).get(a)??null}function h(a){let b=(0,d.L)().prepare("SELECT COUNT(1) AS c FROM canvas_objects WHERE asset_id = ?").get(a);return b?.c??0}function i(a){let b=(0,d.L)(),c=b.prepare("DELETE FROM assets WHERE id = ?");return b.transaction(()=>{(0,e.gy)(a);let b=c.run(a);return(b?.changes??0)>0})()}},86233:(a,b,c)=>{"use strict";c.d(b,{M:()=>k});var d=c(57680),e=c(42115),f=c(15104),g=c(19979),h=c(5086),i=c(11489),j=c(87796);class k extends d.A{constructor(a){super(),this.uid=(0,e.L)("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:b,glProgram:c,groups:d,resources:f,compatibleRenderers:h,groupMap:k}=a;this.gpuProgram=b,this.glProgram=c,void 0===h&&(h=0,b&&(h|=i.W.WEBGPU),c&&(h|=i.W.WEBGL)),this.compatibleRenderers=h;const l={};if(f||d||(f={}),f&&d)throw Error("[Shader] Cannot have both resources and groups");if(b||!d||k){if(!b&&d&&k)for(const a in k)for(const b in k[a]){const c=k[a][b];l[c]={group:a,binding:b,name:c}}else if(b&&d&&!k){const a=b.structsAndGroups.groups;k={},a.forEach(a=>{k[a.group]=k[a.group]||{},k[a.group][a.binding]=a.name,l[a.name]=a})}else if(f){d={},k={},b&&b.structsAndGroups.groups.forEach(a=>{k[a.group]=k[a.group]||{},k[a.group][a.binding]=a.name,l[a.name]=a});let a=0;for(const b in f)!l[b]&&(d[99]||(d[99]=new g.T,this._ownedBindGroups.push(d[99])),l[b]={group:99,binding:a,name:b},k[99]=k[99]||{},k[99][a]=b,a++);for(const a in f){let b=f[a];b.source||b._resourceType||(b=new j.k(b));const c=l[a];c&&(d[c.group]||(d[c.group]=new g.T,this._ownedBindGroups.push(d[c.group])),d[c.group].setResource(b,c.binding))}}}else throw Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");this.groups=d,this._uniformBindMap=k,this.resources=this._buildResourceAccessor(d,l)}addResource(a,b,c){var d,e;(d=this._uniformBindMap)[b]||(d[b]={}),(e=this._uniformBindMap[b])[c]||(e[c]=a),this.groups[b]||(this.groups[b]=new g.T,this._ownedBindGroups.push(this.groups[b]))}_buildResourceAccessor(a,b){let c={};for(let d in b){let e=b[d];Object.defineProperty(c,e.name,{get:()=>a[e.group].getResource(e.binding),set(b){a[e.group].setResource(b,e.binding)}})}return c}destroy(a=!1){this._destroyed||(this._destroyed=!0,this.emit("destroy",this),a&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(a=>{a.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(a){let b,c,{gpu:d,gl:e,...g}=a;return d&&(b=h.B.from(d)),e&&(c=f.M.from(e)),new k({gpuProgram:b,glProgram:c,...g})}}},86360:(a,b,c)=>{"use strict";c.d(b,{z:()=>d});let d=(a,b,c=!1)=>(Array.isArray(a)||(a=[a]),b)?a.map(a=>"string"==typeof a||c?b(a):a):a},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},87790:(a,b,c)=>{"use strict";c.d(b,{c:()=>g});var d=c(48419),e=c(91546);let f=new d.u;class g{constructor(a=1/0,b=1/0,c=-1/0,d=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=f,this.minX=a,this.minY=b,this.maxX=c,this.maxY=d}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new e.M);let a=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(a.x=0,a.y=0,a.width=0,a.height=0):a.copyFromBounds(this),a}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=f,this}set(a,b,c,d){this.minX=a,this.minY=b,this.maxX=c,this.maxY=d}addFrame(a,b,c,d,e){e||(e=this.matrix);let f=e.a,g=e.b,h=e.c,i=e.d,j=e.tx,k=e.ty,l=this.minX,m=this.minY,n=this.maxX,o=this.maxY,p=f*a+h*b+j,q=g*a+i*b+k;p<l&&(l=p),q<m&&(m=q),p>n&&(n=p),q>o&&(o=q),p=f*c+h*b+j,q=g*c+i*b+k,p<l&&(l=p),q<m&&(m=q),p>n&&(n=p),q>o&&(o=q),p=f*a+h*d+j,q=g*a+i*d+k,p<l&&(l=p),q<m&&(m=q),p>n&&(n=p),q>o&&(o=q),p=f*c+h*d+j,q=g*c+i*d+k,p<l&&(l=p),q<m&&(m=q),p>n&&(n=p),q>o&&(o=q),this.minX=l,this.minY=m,this.maxX=n,this.maxY=o}addRect(a,b){this.addFrame(a.x,a.y,a.x+a.width,a.y+a.height,b)}addBounds(a,b){this.addFrame(a.minX,a.minY,a.maxX,a.maxY,b)}addBoundsMask(a){this.minX=this.minX>a.minX?this.minX:a.minX,this.minY=this.minY>a.minY?this.minY:a.minY,this.maxX=this.maxX<a.maxX?this.maxX:a.maxX,this.maxY=this.maxY<a.maxY?this.maxY:a.maxY}applyMatrix(a){let b=this.minX,c=this.minY,d=this.maxX,e=this.maxY,{a:f,b:g,c:h,d:i,tx:j,ty:k}=a,l=f*b+h*c+j,m=g*b+i*c+k;this.minX=l,this.minY=m,this.maxX=l,this.maxY=m,l=f*d+h*c+j,m=g*d+i*c+k,this.minX=l<this.minX?l:this.minX,this.minY=m<this.minY?m:this.minY,this.maxX=l>this.maxX?l:this.maxX,this.maxY=m>this.maxY?m:this.maxY,l=f*b+h*e+j,m=g*b+i*e+k,this.minX=l<this.minX?l:this.minX,this.minY=m<this.minY?m:this.minY,this.maxX=l>this.maxX?l:this.maxX,this.maxY=m>this.maxY?m:this.maxY,l=f*d+h*e+j,m=g*d+i*e+k,this.minX=l<this.minX?l:this.minX,this.minY=m<this.minY?m:this.minY,this.maxX=l>this.maxX?l:this.maxX,this.maxY=m>this.maxY?m:this.maxY}fit(a){return this.minX<a.left&&(this.minX=a.left),this.maxX>a.right&&(this.maxX=a.right),this.minY<a.top&&(this.minY=a.top),this.maxY>a.bottom&&(this.maxY=a.bottom),this}fitBounds(a,b,c,d){return this.minX<a&&(this.minX=a),this.maxX>b&&(this.maxX=b),this.minY<c&&(this.minY=c),this.maxY>d&&(this.maxY=d),this}pad(a,b=a){return this.minX-=a,this.maxX+=a,this.minY-=b,this.maxY+=b,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new g(this.minX,this.minY,this.maxX,this.maxY)}scale(a,b=a){return this.minX*=a,this.minY*=b,this.maxX*=a,this.maxY*=b,this}get x(){return this.minX}set x(a){let b=this.maxX-this.minX;this.minX=a,this.maxX=a+b}get y(){return this.minY}set y(a){let b=this.maxY-this.minY;this.minY=a,this.maxY=a+b}get width(){return this.maxX-this.minX}set width(a){this.maxX=this.minX+a}get height(){return this.maxY-this.minY}set height(a){this.maxY=this.minY+a}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(a,b,c,d){let e=this.minX,f=this.minY,g=this.maxX,h=this.maxY;d||(d=this.matrix);let i=d.a,j=d.b,k=d.c,l=d.d,m=d.tx,n=d.ty;for(let d=b;d<c;d+=2){let b=a[d],c=a[d+1],o=i*b+k*c+m,p=j*b+l*c+n;e=o<e?o:e,f=p<f?p:f,g=o>g?o:g,h=p>h?p:h}this.minX=e,this.minY=f,this.maxX=g,this.maxY=h}containsPoint(a,b){return!!(this.minX<=a)&&!!(this.minY<=b)&&!!(this.maxX>=a)&&!!(this.maxY>=b)}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(a){return this.minX=a.minX,this.minY=a.minY,this.maxX=a.maxX,this.maxY=a.maxY,this}}},87796:(a,b,c)=>{"use strict";c.d(b,{k:()=>i});var d=c(42115),e=c(71254);let f=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],g=f.reduce((a,b)=>(a[b]=!0,a),{}),h=class a{constructor(b,c){this._touched=0,this.uid=(0,d.L)("uniform"),this._resourceType="uniformGroup",this._resourceId=(0,d.L)("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,c={...a.defaultOptions,...c},this.uniformStructures=b;const h={};for(const a in b){const c=b[a];if(c.name=a,c.size=c.size??1,!g[c.type]){const a=c.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(a){const[,b,d]=a;throw Error(`Uniform type ${c.type} is not supported. Use type: '${b}', size: ${d} instead.`)}throw Error(`Uniform type ${c.type} is not supported. Supported uniform types are: ${f.join(", ")}`)}c.value??(c.value=function(a,b){switch(a){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*b);case"vec3<f32>":return new Float32Array(3*b);case"vec4<f32>":return new Float32Array(4*b);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}(c.type,c.size)),h[a]=c.value}this.uniforms=h,this._dirtyId=1,this.ubo=c.ubo,this.isStatic=c.isStatic,this._signature=(0,e.X)(Object.keys(h).map(a=>`${a}-${b[a].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};h.defaultOptions={ubo:!1,isStatic:!1};let i=h},87818:(a,b,c)=>{"use strict";c.d(b,{R:()=>e});let d=0;function e(...a){500!==d&&(500==++d?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...a))}},88066:(a,b,c)=>{"use strict";c.d(b,{P:()=>i});var d=c(40207),e=c(43274),f=c(60056);let g={willReadFrequently:!0},h=class a{static get experimentalLetterSpacingSupported(){let b=a._experimentalLetterSpacingSupported;if(void 0===b){let c=e.e.get().getCanvasRenderingContext2D().prototype;b=a._experimentalLetterSpacingSupported="letterSpacing"in c||"textLetterSpacing"in c}return b}constructor(a,b,c,d,e,f,g,h,i){this.text=a,this.style=b,this.width=c,this.height=d,this.lines=e,this.lineWidths=f,this.lineHeight=g,this.maxLineWidth=h,this.fontProperties=i}static measureText(b=" ",c,d=a._canvas,e=c.wordWrap){let g=`${b}-${c.styleKey}-wordWrap-${e}`;if(a._measurementCache.has(g))return a._measurementCache.get(g);let h=(0,f.Z)(c),i=a.measureFont(h);0===i.fontSize&&(i.fontSize=c.fontSize,i.ascent=c.fontSize);let j=a.__context;j.font=h;let k=(e?a._wordWrap(b,c,d):b).split(/(?:\r\n|\r|\n)/),l=Array(k.length),m=0;for(let b=0;b<k.length;b++){let d=a._measureText(k[b],c.letterSpacing,j);l[b]=d,m=Math.max(m,d)}let n=c._stroke?.width||0,o=m+n;c.dropShadow&&(o+=c.dropShadow.distance);let p=c.lineHeight||i.fontSize,q=Math.max(p,i.fontSize+n)+(k.length-1)*(p+c.leading);c.dropShadow&&(q+=c.dropShadow.distance);let r=new a(b,c,o,q,k,l,p+c.leading,m,i);return a._measurementCache.set(g,r),r}static _measureText(b,c,d){let e=!1;a.experimentalLetterSpacingSupported&&(a.experimentalLetterSpacing?(d.letterSpacing=`${c}px`,d.textLetterSpacing=`${c}px`,e=!0):(d.letterSpacing="0px",d.textLetterSpacing="0px"));let f=d.measureText(b),g=f.width,h=-f.actualBoundingBoxLeft,i=f.actualBoundingBoxRight-h;if(g>0)if(e)g-=c,i-=c;else{let d=(a.graphemeSegmenter(b).length-1)*c;g+=d,i+=d}return Math.max(g,i)}static _wordWrap(b,c,d=a._canvas){let e=d.getContext("2d",g),f=0,h="",i="",j=Object.create(null),{letterSpacing:k,whiteSpace:l}=c,m=a._collapseSpaces(l),n=a._collapseNewlines(l),o=!m,p=c.wordWrapWidth+k,q=a._tokenize(b);for(let b=0;b<q.length;b++){let d=q[b];if(a._isNewline(d)){if(!n){i+=a._addLine(h),o=!m,h="",f=0;continue}d=" "}if(m){let b=a.isBreakingSpace(d),c=a.isBreakingSpace(h[h.length-1]);if(b&&c)continue}let g=a._getFromCache(d,k,j,e);if(g>p)if(""!==h&&(i+=a._addLine(h),h="",f=0),a.canBreakWords(d,c.breakWords)){let b=a.wordWrapSplit(d);for(let g=0;g<b.length;g++){let l=b[g],m=l,n=1;for(;b[g+n];){let e=b[g+n];if(a.canBreakChars(m,e,d,g,c.breakWords))break;l+=e,m=e,n++}g+=n-1;let q=a._getFromCache(l,k,j,e);q+f>p&&(i+=a._addLine(h),o=!1,h="",f=0),h+=l,f+=q}}else{h.length>0&&(i+=a._addLine(h),h="",f=0);let c=b===q.length-1;i+=a._addLine(d,!c),o=!1,h="",f=0}else g+f>p&&(o=!1,i+=a._addLine(h),h="",f=0),(h.length>0||!a.isBreakingSpace(d)||o)&&(h+=d,f+=g)}return i+a._addLine(h,!1)}static _addLine(b,c=!0){return b=a._trimRight(b),b=c?`${b}
`:b}static _getFromCache(b,c,d,e){let f=d[b];return"number"!=typeof f&&(f=a._measureText(b,c,e)+c,d[b]=f),f}static _collapseSpaces(a){return"normal"===a||"pre-line"===a}static _collapseNewlines(a){return"normal"===a}static _trimRight(b){if("string"!=typeof b)return"";for(let c=b.length-1;c>=0;c--){let d=b[c];if(!a.isBreakingSpace(d))break;b=b.slice(0,-1)}return b}static _isNewline(b){return"string"==typeof b&&a._newlines.includes(b.charCodeAt(0))}static isBreakingSpace(b,c){return"string"==typeof b&&a._breakingSpaces.includes(b.charCodeAt(0))}static _tokenize(b){let c=[],d="";if("string"!=typeof b)return c;for(let e=0;e<b.length;e++){let f=b[e],g=b[e+1];if(a.isBreakingSpace(f,g)||a._isNewline(f)){""!==d&&(c.push(d),d=""),"\r"===f&&"\n"===g?(c.push("\r\n"),e++):c.push(f);continue}d+=f}return""!==d&&c.push(d),c}static canBreakWords(a,b){return b}static canBreakChars(a,b,c,d,e){return!0}static wordWrapSplit(b){return a.graphemeSegmenter(b)}static measureFont(b){if(a._fonts[b])return a._fonts[b];let c=a._context;c.font=b;let d=c.measureText(a.METRICS_STRING+a.BASELINE_SYMBOL),e={ascent:d.actualBoundingBoxAscent,descent:d.actualBoundingBoxDescent,fontSize:d.actualBoundingBoxAscent+d.actualBoundingBoxDescent};return a._fonts[b]=e,e}static clearMetrics(b=""){b?delete a._fonts[b]:a._fonts={}}static get _canvas(){if(!a.__canvas){let b;try{let c=new OffscreenCanvas(0,0),d=c.getContext("2d",g);if(d?.measureText)return a.__canvas=c,c;b=e.e.get().createCanvas()}catch(a){b=e.e.get().createCanvas()}b.width=b.height=10,a.__canvas=b}return a.__canvas}static get _context(){return a.__context||(a.__context=a._canvas.getContext("2d",g)),a.__context}};h.METRICS_STRING="|\xc9q\xc5",h.BASELINE_SYMBOL="M",h.BASELINE_MULTIPLIER=1.4,h.HEIGHT_MULTIPLIER=2,h.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){let a=new Intl.Segmenter;return b=>{let c=a.segment(b),d=[],e=0;for(let a of c)d[e++]=a.segment;return d}}return a=>[...a]})(),h.experimentalLetterSpacing=!1,h._fonts={},h._newlines=[10,13],h._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],h._measurementCache=(0,d.g)(1e3);let i=h},88281:(a,b,c)=>{"use strict";function d(a,b,c,d){let e={width:0,height:0,offsetY:0,scale:b.fontSize/c.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};e.offsetY=c.baseLineOffset;let f=e.lines[0],g=null,h=!0,i={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},j=c.baseMeasurementFontSize/b.fontSize,k=b.letterSpacing*j,l=b.wordWrapWidth*j,m=b.lineHeight?b.lineHeight*j:c.lineHeight,n=b.wordWrap&&b.breakWords,o=a=>{let b=f.width;for(let c=0;c<i.index;c++){let d=a.positions[c];f.chars.push(a.chars[c]),f.charPositions.push(d+b)}f.width+=a.width,h=!1,i.width=0,i.index=0,i.chars.length=0},p=()=>{let a=f.chars.length-1;if(d){let b=f.chars[a];for(;" "===b;)f.width-=c.chars[b].xAdvance,b=f.chars[--a]}e.width=Math.max(e.width,f.width),f={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},h=!0,e.lines.push(f),e.height+=m},q=a=>a-k>l;for(let d=0;d<a.length+1;d++){let e,j=d===a.length;j||(e=a[d]);let l=c.chars[e]||c.chars[" "];if(/(?:\s)/.test(e)||"\r"===e||"\n"===e||j){if(!h&&b.wordWrap&&q(f.width+i.width)?p():i.start=f.width,o(i),j||f.charPositions.push(0),"\r"===e||"\n"===e)p();else if(!j){let a=l.xAdvance+(l.kerning[g]||0)+k;f.width+=a,f.spaceWidth=a,f.spacesIndex.push(f.charPositions.length),f.chars.push(e)}}else{let a=l.kerning[g]||0,b=l.xAdvance+a+k;n&&q(f.width+i.width+b)&&(o(i),p()),i.positions[i.index++]=i.width+a,i.chars.push(e),i.width+=b}g=e}return p(),"center"===b.align?function(a){for(let b=0;b<a.lines.length;b++){let c=a.lines[b],d=a.width/2-c.width/2;for(let a=0;a<c.charPositions.length;a++)c.charPositions[a]+=d}}(e):"right"===b.align?function(a){for(let b=0;b<a.lines.length;b++){let c=a.lines[b],d=a.width-c.width;for(let a=0;a<c.charPositions.length;a++)c.charPositions[a]+=d}}(e):"justify"===b.align&&function(a){let b=a.width;for(let c=0;c<a.lines.length;c++){let d=a.lines[c],e=0,f=d.spacesIndex[e++],g=0,h=d.spacesIndex.length,i=(b-d.width)/h;for(let a=0;a<d.charPositions.length;a++)a===f&&(f=d.spacesIndex[e++],g+=i),d.charPositions[a]+=g}}(e),e}c.d(b,{Z:()=>d})},89949:(a,b,c)=>{"use strict";c.d(b,{c:()=>w});var d=c(40207),e=c(1157),f=c(71568),g=c(87818),h=c(88066),i=c(54497),j=c(66242),k=c(91546),l=c(92714),m=c(16503),n=c(61487),o=c(80424),p=c(60056),q=c(57266),r=c(27331);let s=class a extends r.v{constructor(b){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const c={...a.defaultOptions,...b};this._textureSize=c.textureSize,this._mipmap=c.mipmap;const d=c.style.clone();c.overrideFill&&(d._fill.color=0xffffff,d._fill.alpha=1,d._fill.texture=n.g.WHITE,d._fill.fill=null),this.applyFillAsTint=c.overrideFill;const e=d.fontSize;d.fontSize=this.baseMeasurementFontSize;const f=(0,p.Z)(d);c.overrideSize?d._stroke&&(d._stroke.width*=this.baseRenderedFontSize/e):d.fontSize=this.baseRenderedFontSize=e,this._style=d,this._skipKerning=c.skipKerning??!1,this.resolution=c.resolution??1,this._padding=c.padding??4,c.textureStyle&&(this._textureStyle=c.textureStyle instanceof o.n?c.textureStyle:new o.n(c.textureStyle)),this.fontMetrics=h.P.measureFont(f),this.lineHeight=d.lineHeight||this.fontMetrics.fontSize||d.fontSize}ensureCharacters(a){let b,c=h.P.graphemeSegmenter(a).filter(a=>!this._currentChars.includes(a)).filter((a,b,c)=>c.indexOf(a)===b);if(!c.length)return;this._currentChars=[...this._currentChars,...c];let{canvas:d,context:e}=(b=-1===this._currentPageIndex?this._nextPage():this.pages[this._currentPageIndex]).canvasAndContext,f=b.texture.source,g=this._style,i=this._currentX,j=this._currentY,l=this._currentMaxCharHeight,m=this.baseRenderedFontSize/this.baseMeasurementFontSize,o=this._padding*m,p=!1,q=d.width/this.resolution,r=d.height/this.resolution;for(let a=0;a<c.length;a++){let b=c[a],s=h.P.measureText(b,g,d,!1);s.lineHeight=s.height;let t=s.width*m,u=Math.ceil(("italic"===g.fontStyle?2:1)*t),v=s.height*m,w=u+2*o,x=v+2*o;if(p=!1,"\n"!==b&&"\r"!==b&&"	"!==b&&" "!==b&&(p=!0,l=Math.ceil(Math.max(x,l))),i+w>q&&(i=0,(j+=l)+(l=x)>r)){f.update();let a=this._nextPage();d=a.canvasAndContext.canvas,e=a.canvasAndContext.context,f=a.texture.source,i=0,j=0,l=0}let y=t/m-(g.dropShadow?.distance??0)-(g._stroke?.width??0);if(this.chars[b]={id:b.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:y,kerning:{}},p){this._drawGlyph(e,s,i+o,j+o,m,g);let a=f.width*m,c=f.height*m,d=new k.M(i/a*f.width,j/c*f.height,w/a*f.width,x/c*f.height);this.chars[b].texture=new n.g({source:f,frame:d}),i+=Math.ceil(w)}}f.update(),this._currentX=i,this._currentY=j,this._currentMaxCharHeight=l,this._skipKerning&&this._applyKerning(c,e)}get pageTextures(){return(0,f.t6)(f.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(a,b){let c=this._measureCache;for(let d=0;d<a.length;d++){let e=a[d];for(let a=0;a<this._currentChars.length;a++){let d=this._currentChars[a],f=c[e];f||(f=c[e]=b.measureText(e).width);let g=c[d];g||(g=c[d]=b.measureText(d).width);let h=b.measureText(e+d).width,i=h-(f+g);i&&(this.chars[e].kerning[d]=i),(i=(h=b.measureText(e+d).width)-(f+g))&&(this.chars[d].kerning[e]=i)}}}_nextPage(){this._currentPageIndex++;let a=this.resolution,b=l.N.getOptimalCanvasAndContext(this._textureSize,this._textureSize,a);this._setupContext(b.context,this._style,a);let c=a*(this.baseRenderedFontSize/this.baseMeasurementFontSize),d=new n.g({source:new m.b({resource:b.canvas,resolution:c,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(d.source.style=this._textureStyle);let e={canvasAndContext:b,texture:d};return this.pages[this._currentPageIndex]=e,e}_setupContext(a,b,c){b.fontSize=this.baseRenderedFontSize,a.scale(c,c),a.font=(0,p.Z)(b),b.fontSize=this.baseMeasurementFontSize,a.textBaseline=b.textBaseline;let d=b._stroke,e=d?.width??0;if(d&&(a.lineWidth=e,a.lineJoin=d.join,a.miterLimit=d.miterLimit,a.strokeStyle=(0,q.r)(d,a)),b._fill&&(a.fillStyle=(0,q.r)(b._fill,a)),b.dropShadow){let d=b.dropShadow,e=j.Q.shared.setValue(d.color).toArray(),f=d.blur*c,g=d.distance*c;a.shadowColor=`rgba(${255*e[0]},${255*e[1]},${255*e[2]},${d.alpha})`,a.shadowBlur=f,a.shadowOffsetX=Math.cos(d.angle)*g,a.shadowOffsetY=Math.sin(d.angle)*g}else a.shadowColor="black",a.shadowBlur=0,a.shadowOffsetX=0,a.shadowOffsetY=0}_drawGlyph(a,b,c,d,e,f){let g=b.text,h=b.fontProperties,i=f._stroke,j=(i?.width??0)*e,k=c+j/2,l=d-j/2,m=h.descent*e,n=b.lineHeight*e,o=!1;f.stroke&&j&&(o=!0,a.strokeText(g,k,l+n-m));let{shadowBlur:p,shadowOffsetX:q,shadowOffsetY:r}=a;f._fill&&(o&&(a.shadowBlur=0,a.shadowOffsetX=0,a.shadowOffsetY=0),a.fillText(g,k,l+n-m)),o&&(a.shadowBlur=p,a.shadowOffsetX=q,a.shadowOffsetY=r)}destroy(){super.destroy();for(let a=0;a<this.pages.length;a++){let{canvasAndContext:b,texture:c}=this.pages[a];l.N.returnCanvasAndContext(b),c.destroy(!0)}this.pages=null}};s.defaultOptions={textureSize:512,style:new i.x,mipmap:!0};var t=c(88281);let u=0;class v{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=(0,d.g)(1e3)}getFont(a,b){let c=`${b.fontFamily}-bitmap`,d=!0;if(b._fill.fill&&!b._stroke?(c+=b._fill.fill.styleKey,d=!1):(b._stroke||b.dropShadow)&&(c=`${b.styleKey}-bitmap`,d=!1),!e.l.has(c)){let a=Object.create(b);a.lineHeight=0;let f=new s({style:a,overrideFill:d,overrideSize:!0,...this.defaultOptions});++u>50&&(0,g.R)("BitmapText",`You have dynamically created ${u} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),f.once("destroy",()=>{u--,e.l.remove(c)}),e.l.set(c,f)}let f=e.l.get(c);return f.ensureCharacters?.(a),f}getLayout(a,b,c=!0){let d=this.getFont(a,b),e=`${a}-${b.styleKey}-${c}`;if(this.measureCache.has(e))return this.measureCache.get(e);let f=h.P.graphemeSegmenter(a),g=(0,t.Z)(f,b,d,c);return this.measureCache.set(e,g),g}measureText(a,b,c=!0){return this.getLayout(a,b,c)}install(...a){let b=a[0];"string"==typeof b&&(b={name:b,style:a[1],chars:a[2]?.chars,resolution:a[2]?.resolution,padding:a[2]?.padding,skipKerning:a[2]?.skipKerning},(0,f.t6)(f.lj,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));let c=b?.name;if(!c)throw Error("[BitmapFontManager] Property `name` is required.");let d=(b={...this.defaultOptions,...b}).style,g=d instanceof i.x?d:new i.x(d),h=b.dynamicFill??this._canUseTintForStyle(g),j=new s({style:g,overrideFill:h,skipKerning:b.skipKerning,padding:b.padding,resolution:b.resolution,overrideSize:!1,textureStyle:b.textureStyle}),k=function(a){if(""===a)return[];"string"==typeof a&&(a=[a]);let b=[];for(let c=0,d=a.length;c<d;c++){let d=a[c];if(Array.isArray(d)){if(2!==d.length)throw Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${d.length}.`);if(0===d[0].length||0===d[1].length)throw Error("[BitmapFont]: Invalid character delimiter.");let a=d[0].charCodeAt(0),c=d[1].charCodeAt(0);if(c<a)throw Error("[BitmapFont]: Invalid character range.");for(let d=a;d<=c;d++)b.push(String.fromCharCode(d))}else b.push(...Array.from(d))}if(0===b.length)throw Error("[BitmapFont]: Empty set when resolving characters.");return b}(b.chars);return j.ensureCharacters(k.join("")),e.l.set(`${c}-bitmap`,j),j.once("destroy",()=>e.l.remove(`${c}-bitmap`)),j}uninstall(a){let b=`${a}-bitmap`,c=e.l.get(b);c&&c.destroy()}_canUseTintForStyle(a){return!a._stroke&&(!a.dropShadow||0===a.dropShadow.color)&&!a._fill.fill&&0xffffff===a._fill.color}}let w=new v},91546:(a,b,c)=>{"use strict";c.d(b,{M:()=>f});var d=c(21783);let e=[new d.b,new d.b,new d.b,new d.b];class f{constructor(a=0,b=0,c=0,d=0){this.type="rectangle",this.x=Number(a),this.y=Number(b),this.width=Number(c),this.height=Number(d)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new f(0,0,0,0)}clone(){return new f(this.x,this.y,this.width,this.height)}copyFromBounds(a){return this.x=a.minX,this.y=a.minY,this.width=a.maxX-a.minX,this.height=a.maxY-a.minY,this}copyFrom(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this}copyTo(a){return a.copyFrom(this),a}contains(a,b){return!(this.width<=0)&&!(this.height<=0)&&!!(a>=this.x)&&!!(a<this.x+this.width)&&!!(b>=this.y)&&!!(b<this.y+this.height)}strokeContains(a,b,c,d=.5){let{width:e,height:f}=this;if(e<=0||f<=0)return!1;let g=this.x,h=this.y,i=c*(1-d),j=c-i;return a>=g-i&&a<=g+e+i&&b>=h-i&&b<=h+f+i&&!(a>g+j&&a<g+e-j&&b>h+j&&b<h+f-j)}intersects(a,b){if(!b){let b=this.x<a.x?a.x:this.x;if((this.right>a.right?a.right:this.right)<=b)return!1;let c=this.y<a.y?a.y:this.y;return(this.bottom>a.bottom?a.bottom:this.bottom)>c}let c=this.left,d=this.right,f=this.top,g=this.bottom;if(d<=c||g<=f)return!1;let h=e[0].set(a.left,a.top),i=e[1].set(a.left,a.bottom),j=e[2].set(a.right,a.top),k=e[3].set(a.right,a.bottom);if(j.x<=h.x||i.y<=h.y)return!1;let l=Math.sign(b.a*b.d-b.b*b.c);if(0===l||(b.apply(h,h),b.apply(i,i),b.apply(j,j),b.apply(k,k),Math.max(h.x,i.x,j.x,k.x)<=c||Math.min(h.x,i.x,j.x,k.x)>=d||Math.max(h.y,i.y,j.y,k.y)<=f||Math.min(h.y,i.y,j.y,k.y)>=g))return!1;let m=l*(i.y-h.y),n=l*(h.x-i.x),o=m*c+n*f,p=m*d+n*f,q=m*c+n*g,r=m*d+n*g;if(Math.max(o,p,q,r)<=m*h.x+n*h.y||Math.min(o,p,q,r)>=m*k.x+n*k.y)return!1;let s=l*(h.y-j.y),t=l*(j.x-h.x),u=s*c+t*f,v=s*d+t*f,w=s*c+t*g,x=s*d+t*g;return!(Math.max(u,v,w,x)<=s*h.x+t*h.y||Math.min(u,v,w,x)>=s*k.x+t*k.y)}pad(a=0,b=a){return this.x-=a,this.y-=b,this.width+=2*a,this.height+=2*b,this}fit(a){let b=Math.max(this.x,a.x),c=Math.min(this.x+this.width,a.x+a.width),d=Math.max(this.y,a.y),e=Math.min(this.y+this.height,a.y+a.height);return this.x=b,this.width=Math.max(c-b,0),this.y=d,this.height=Math.max(e-d,0),this}ceil(a=1,b=.001){let c=Math.ceil((this.x+this.width-b)*a)/a,d=Math.ceil((this.y+this.height-b)*a)/a;return this.x=Math.floor((this.x+b)*a)/a,this.y=Math.floor((this.y+b)*a)/a,this.width=c-this.x,this.height=d-this.y,this}scale(a,b=a){return this.x*=a,this.y*=b,this.width*=a,this.height*=b,this}enlarge(a){let b=Math.min(this.x,a.x),c=Math.max(this.x+this.width,a.x+a.width),d=Math.min(this.y,a.y),e=Math.max(this.y+this.height,a.y+a.height);return this.x=b,this.width=c-b,this.y=d,this.height=e-d,this}getBounds(a){return a||(a=new f),a.copyFrom(this),a}containsRect(a){if(this.width<=0||this.height<=0)return!1;let b=a.x,c=a.y,d=a.x+a.width,e=a.y+a.height;return b>=this.x&&b<this.x+this.width&&c>=this.y&&c<this.y+this.height&&d>=this.x&&d<this.x+this.width&&e>=this.y&&e<this.y+this.height}set(a,b,c,d){return this.x=a,this.y=b,this.width=c,this.height=d,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}},92149:(a,b,c)=>{"use strict";function d(a){return a+=+(0===a),--a,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,(a|=a>>>16)+1}function e(a){return!(a&a-1)&&!!a}c.d(b,{U5:()=>d,f3:()=>e})},92175:(a,b,c)=>{"use strict";var d=c(45753),e=c(30006),f=c(87790),g=c(33349);let h=new f.c;function i(a,b,c){a.measurable=!0,(0,g.f)(a,c,h),b.addBoundsMask(h),a.measurable=!1}var j=c(50139),k=c(11630),l=c(87818);function m(a,b,c){let d=k.o.get();a.measurable=!0;let e=k.u.get().identity(),f=function a(b,c,d){return b?b!==c&&(a(b.parent,c,d),b.updateLocalTransform(),d.append(b.localTransform)):(0,l.R)("Mask bounds, renderable is not inside the root container"),d}(a,c,e);(0,j.n)(a,d,f),a.measurable=!1,b.addBoundsMask(d),k.u.return(e),k.o.return(d)}class n{constructor(a){this.priority=0,this.inverse=!1,this.pipe="alphaMask",a?.mask&&this.init(a.mask)}init(a){this.mask=a,this.renderMaskToTexture=!(a instanceof e.k),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){null!==this.mask&&(this.mask.measurable=!0,this.mask=null)}addBounds(a,b){this.inverse||i(this.mask,a,b)}addLocalBounds(a,b){m(this.mask,a,b)}containsPoint(a,b){return b(this.mask,a)}destroy(){this.reset()}static test(a){return a instanceof e.k}}n.extension=d.Ag.MaskEffect;class o{constructor(a){this.priority=0,this.pipe="colorMask",a?.mask&&this.init(a.mask)}init(a){this.mask=a}destroy(){}static test(a){return"number"==typeof a}}o.extension=d.Ag.MaskEffect;var p=c(64974);class q{constructor(a){this.priority=0,this.pipe="stencilMask",a?.mask&&this.init(a.mask)}init(a){this.mask=a,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){null!==this.mask&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(a,b){i(this.mask,a,b)}addLocalBounds(a,b){m(this.mask,a,b)}containsPoint(a,b){return b(this.mask,a)}destroy(){this.reset()}static test(a){return a instanceof p.mc}}q.extension=d.Ag.MaskEffect;var r=c(2233),s=c(1342),t=c(16503),u=c(25805);c(67891),d.XO.add(n,o,q,u.$,t.b,s.q,r.P)},92233:(a,b,c)=>{"use strict";c.d(b,{gA:()=>h,xx:()=>l,U1:()=>i,hF:()=>j,oB:()=>k});let d=require("node:crypto");var e=c.n(d),f=c(92913),g=c(76518);function h(a){let b=(0,f.L)(),c=e().randomUUID(),d=new Date().toISOString();return b.prepare(`INSERT INTO projects (id, name, created_at, updated_at)
     VALUES (?, ?, ?, ?)`).run(c,a,d,d),i(c)}function i(a){return(0,f.L)().prepare("SELECT * FROM projects WHERE id = ?").get(a)??null}function j(){return(0,f.L)().prepare("SELECT * FROM projects ORDER BY updated_at DESC, created_at DESC").all()}function k(a,b){let c=(0,f.L)(),d=new Date().toISOString();return 0===c.prepare("UPDATE projects SET name = ?, updated_at = ? WHERE id = ?").run(b,d,a).changes?null:i(a)}function l(a){let b=(0,f.L)();return b.transaction(()=>((0,g.J3)(a),b.prepare("DELETE FROM projects WHERE id = ?").run(a).changes>0))()}},92431:(a,b,c)=>{"use strict";let d;function e(){if("boolean"==typeof d)return d;try{let a=Function("param1","param2","param3","return param1[param2] === param3;");d=!0===a({a:"b"},"a","b")}catch(a){d=!1}return d}c.d(b,{f:()=>e})},92602:(a,b,c)=>{"use strict";c.d(b,{m:()=>g});var d=c(48419),e=c(20402),f=c(29695);class g{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new d.u,this.worldColorAlpha=0xffffffff,this.worldColor=0xffffff,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new e.L,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(a){this.root=a,a._onRender&&this.addOnRender(a),a.didChange=!0;let b=a.children;for(let a=0;a<b.length;a++){let c=b[a];c._updateFlags=15,this.addChild(c)}}enableCacheAsTexture(a={}){this.textureOptions=a,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(f.W.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;let a=this._parentCacheAsTextureRenderGroup;a&&!a.textureNeedsUpdate&&a.updateCacheTexture()}reset(){for(let a in this.renderGroupChildren.length=0,this.childrenToUpdate){let b=this.childrenToUpdate[a];b.list.fill(null),b.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(a){a.renderGroupParent&&a.renderGroupParent._removeRenderGroupChild(a),a.renderGroupParent=this,this.renderGroupChildren.push(a)}_removeRenderGroupChild(a){let b=this.renderGroupChildren.indexOf(a);b>-1&&this.renderGroupChildren.splice(b,1),a.renderGroupParent=null}addChild(a){if(this.structureDidChange=!0,a.parentRenderGroup=this,a.updateTick=-1,a.parent===this.root?a.relativeRenderGroupDepth=1:a.relativeRenderGroupDepth=a.parent.relativeRenderGroupDepth+1,a.didChange=!0,this.onChildUpdate(a),a.renderGroup)return void this.addRenderGroupChild(a.renderGroup);a._onRender&&this.addOnRender(a);let b=a.children;for(let a=0;a<b.length;a++)this.addChild(b[a])}removeChild(a){if(this.structureDidChange=!0,a._onRender&&!a.renderGroup&&this.removeOnRender(a),a.parentRenderGroup=null,a.renderGroup)return void this._removeRenderGroupChild(a.renderGroup);let b=a.children;for(let a=0;a<b.length;a++)this.removeChild(b[a])}removeChildren(a){for(let b=0;b<a.length;b++)this.removeChild(a[b])}onChildUpdate(a){let b=this.childrenToUpdate[a.relativeRenderGroupDepth];b||(b=this.childrenToUpdate[a.relativeRenderGroupDepth]={index:0,list:[]}),b.list[b.index++]=a}updateRenderable(a){a.globalDisplayStatus<7||(this.instructionSet.renderPipes[a.renderPipeId].updateRenderable(a),a.didViewUpdate=!1)}onChildViewUpdate(a){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=a}get isRenderable(){return 7===this.root.localDisplayStatus&&this.worldAlpha>0}addOnRender(a){this._onRenderContainers.push(a)}removeOnRender(a){this._onRenderContainers.splice(this._onRenderContainers.indexOf(a),1)}runOnRender(a){for(let b=0;b<this._onRenderContainers.length;b++)this._onRenderContainers[b]._onRender(a)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(a=[]){let b=this.root.children;for(let c=0;c<b.length;c++)this._getChildren(b[c],a);return a}_getChildren(a,b=[]){if(b.push(a),a.renderGroup)return b;let c=a.children;for(let a=0;a<c.length;a++)this._getChildren(c[a],b);return b}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(1&this._matrixDirty)==0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new d.u),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(2&this._matrixDirty)==0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new d.u),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((4&this._matrixDirty)==0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;let a=this._parentCacheAsTextureRenderGroup;return a?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new d.u),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(a.inverseWorldTransform).translate(-a._textureBounds.x,-a._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}},92714:(a,b,c)=>{"use strict";c.d(b,{N:()=>h});var d=c(43274),e=c(92149),f=c(83401);class g{constructor(a){this._canvasPool=Object.create(null),this.canvasOptions=a||{},this.enableFullScreen=!1}_createCanvasAndContext(a,b){let c=d.e.get().createCanvas();c.width=a,c.height=b;let e=c.getContext("2d");return{canvas:c,context:e}}getOptimalCanvasAndContext(a,b,c=1){a=Math.ceil(a*c-1e-6),b=Math.ceil(b*c-1e-6),a=(0,e.U5)(a),b=(0,e.U5)(b);let d=(a<<17)+(b<<1);this._canvasPool[d]||(this._canvasPool[d]=[]);let f=this._canvasPool[d].pop();return f||(f=this._createCanvasAndContext(a,b)),f}returnCanvasAndContext(a){let{width:b,height:c}=a.canvas,d=(b<<17)+(c<<1);a.context.resetTransform(),a.context.clearRect(0,0,b,c),this._canvasPool[d].push(a)}clear(){this._canvasPool={}}}let h=new g;f.L.register(h)},92767:(a,b,c)=>{Promise.resolve().then(c.bind(c,45373))},92913:(a,b,c)=>{"use strict";c.d(b,{L:()=>n});var d=c(73024),e=c.n(d),f=c(76760),g=c.n(f);let h=require("better-sqlite3");var i=c.n(h);let j=`PRAGMA foreign_keys = ON;

CREATE TABLE IF NOT EXISTS projects (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  created_at TEXT NOT NULL DEFAULT (datetime('now')),
  updated_at TEXT NOT NULL DEFAULT (datetime('now'))
);

CREATE TABLE IF NOT EXISTS assets (
  id TEXT PRIMARY KEY,
  project_id TEXT NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
  original_name TEXT NOT NULL,
  mime_type TEXT NOT NULL,
  byte_size INTEGER NOT NULL,
  sha256 TEXT NOT NULL,
  storage_path TEXT NOT NULL,
  storage_url TEXT NOT NULL,
  thumb_path TEXT,
  thumb_url TEXT,
  width INTEGER,
  height INTEGER,
  created_at TEXT NOT NULL DEFAULT (datetime('now'))
);

CREATE UNIQUE INDEX IF NOT EXISTS assets_project_sha256_uq ON assets(project_id, sha256);
CREATE INDEX IF NOT EXISTS assets_project_id_idx ON assets(project_id);

CREATE TABLE IF NOT EXISTS asset_ai (
  asset_id TEXT PRIMARY KEY REFERENCES assets(id) ON DELETE CASCADE,
  caption TEXT,
  tags_json TEXT,
  status TEXT NOT NULL DEFAULT 'pending',
  model_version TEXT,
  updated_at TEXT NOT NULL DEFAULT (datetime('now'))
);

CREATE TABLE IF NOT EXISTS canvas_objects (
  id TEXT PRIMARY KEY,
  project_id TEXT NOT NULL REFERENCES projects(id) ON DELETE CASCADE,
  type TEXT NOT NULL,
  asset_id TEXT REFERENCES assets(id) ON DELETE SET NULL,
  x REAL NOT NULL DEFAULT 0,
  y REAL NOT NULL DEFAULT 0,
  scale_x REAL NOT NULL DEFAULT 1,
  scale_y REAL NOT NULL DEFAULT 1,
  rotation REAL NOT NULL DEFAULT 0,
  width REAL,
  height REAL,
  z_index INTEGER NOT NULL DEFAULT 0,
  props_json TEXT,
  created_at TEXT NOT NULL DEFAULT (datetime('now')),
  updated_at TEXT NOT NULL DEFAULT (datetime('now'))
);

CREATE INDEX IF NOT EXISTS canvas_objects_project_id_idx ON canvas_objects(project_id);

-- Full-text search across filename + AI caption + tags
CREATE VIRTUAL TABLE IF NOT EXISTS asset_search USING fts5(
  asset_id UNINDEXED,
  project_id UNINDEXED,
  original_name,
  caption,
  tags
);
`,k=`PRAGMA foreign_keys = ON;

CREATE TABLE IF NOT EXISTS project_view (
  project_id TEXT PRIMARY KEY REFERENCES projects(id) ON DELETE CASCADE,
  world_x REAL NOT NULL DEFAULT 0,
  world_y REAL NOT NULL DEFAULT 0,
  zoom REAL NOT NULL DEFAULT 1,
  updated_at TEXT NOT NULL DEFAULT (datetime('now'))
);
`,l=`PRAGMA foreign_keys = ON;

-- Store caption embeddings for semantic/vector search.
-- We keep this schema portable so it can be migrated to Supabase/pgvector later.
CREATE TABLE IF NOT EXISTS asset_embeddings (
  asset_id TEXT PRIMARY KEY REFERENCES assets(id) ON DELETE CASCADE,
  model TEXT NOT NULL,
  dim INTEGER NOT NULL,
  embedding BLOB,
  updated_at TEXT NOT NULL DEFAULT (datetime('now'))
);

-- Store per-tag segmentation results so searches like "apple" can highlight on-image regions.
-- One row per (asset_id, tag).
CREATE TABLE IF NOT EXISTS asset_segments (
  asset_id TEXT NOT NULL REFERENCES assets(id) ON DELETE CASCADE,
  tag TEXT NOT NULL,
  svg TEXT,
  bbox_json TEXT,
  updated_at TEXT NOT NULL DEFAULT (datetime('now')),
  PRIMARY KEY (asset_id, tag)
);

CREATE INDEX IF NOT EXISTS asset_segments_tag_idx ON asset_segments(tag);
`,m=`PRAGMA foreign_keys = ON;

-- Small key/value store for local app state (desktop + local-first web).
-- Used for "reopen last project" on launch.
CREATE TABLE IF NOT EXISTS app_state (
  key TEXT PRIMARY KEY,
  value TEXT,
  updated_at TEXT NOT NULL DEFAULT (datetime('now'))
);
`;function n(){if(!globalThis.__moondreamDb){let a,b=process.env.MOONDREAM_DB_PATH||((a=(process.env.MOONDREAM_DATA_DIR||"").trim())?g().resolve(a,"moondream.sqlite3"):g().resolve(process.cwd(),"..","data","moondream.sqlite3"));e().mkdirSync(g().dirname(b),{recursive:!0});let c=new(i())(b);c.pragma("journal_mode = WAL"),c.pragma("busy_timeout = 5000"),globalThis.__moondreamDb=c}var a=globalThis.__moondreamDb;a.pragma("foreign_keys = ON");let b=a.prepare("PRAGMA user_version").get(),c=b?.user_version??0;if(c<1){a.exec("BEGIN");try{a.exec(j),a.exec("PRAGMA user_version = 1"),a.exec("COMMIT")}catch(b){throw a.exec("ROLLBACK"),b}c=1}if(c<2){a.exec("BEGIN");try{a.exec(k),a.exec("PRAGMA user_version = 2"),a.exec("COMMIT")}catch(b){throw a.exec("ROLLBACK"),b}c=2}if(c<3){a.exec("BEGIN");try{a.exec(l),a.exec("PRAGMA user_version = 3"),a.exec("COMMIT")}catch(b){throw a.exec("ROLLBACK"),b}c=3}if(c<4){a.exec("BEGIN");try{a.exec(m),a.exec("PRAGMA user_version = 4"),a.exec("COMMIT")}catch(b){throw a.exec("ROLLBACK"),b}}return globalThis.__moondreamDb}},93141:(a,b,c)=>{"use strict";c.d(b,{v:()=>j});var d=c(57680),e=c(92149),f=c(19748),g=c(42115),h=c(80424);let i=class a extends d.A{constructor(b={}){super(),this.options=b,this.uid=(0,g.L)("textureSource"),this._resourceType="textureSource",this._resourceId=(0,g.L)("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,b={...a.defaultOptions,...b},this.label=b.label??"",this.resource=b.resource,this.autoGarbageCollect=b.autoGarbageCollect,this._resolution=b.resolution,b.width?this.pixelWidth=b.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,b.height?this.pixelHeight=b.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=b.format,this.dimension=b.dimensions,this.mipLevelCount=b.mipLevelCount,this.autoGenerateMipmaps=b.autoGenerateMipmaps,this.sampleCount=b.sampleCount,this.antialias=b.antialias,this.alphaMode=b.alphaMode,this.style=new h.n((0,f.S)(b)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(a){this.style!==a&&(this._style?.off("change",this._onStyleChange,this),this._style=a,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(a){this._style.maxAnisotropy=a}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(a){this._style.addressMode=a}get repeatMode(){return this._style.addressMode}set repeatMode(a){this._style.addressMode=a}get magFilter(){return this._style.magFilter}set magFilter(a){this._style.magFilter=a}get minFilter(){return this._style.minFilter}set minFilter(a){this._style.minFilter=a}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(a){this._style.mipmapFilter=a}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(a){this._style.lodMinClamp=a}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(a){this._style.lodMaxClamp=a}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){let a=this._resolution;if(this.resize(this.resourceWidth/a,this.resourceHeight/a))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=(0,g.L)("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){let{resource:a}=this;return a.naturalWidth||a.videoWidth||a.displayWidth||a.width}get resourceHeight(){let{resource:a}=this;return a.naturalHeight||a.videoHeight||a.displayHeight||a.height}get resolution(){return this._resolution}set resolution(a){this._resolution!==a&&(this._resolution=a,this.width=this.pixelWidth/a,this.height=this.pixelHeight/a)}resize(a,b,c){c||(c=this._resolution),a||(a=this.width),b||(b=this.height);let d=Math.round(a*c),e=Math.round(b*c);return this.width=d/c,this.height=e/c,this._resolution=c,(this.pixelWidth!==d||this.pixelHeight!==e)&&(this._refreshPOT(),this.pixelWidth=d,this.pixelHeight=e,this.emit("resize",this),this._resourceId=(0,g.L)("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(a){this._style.wrapMode=a}get wrapMode(){return this._style.wrapMode}set scaleMode(a){this._style.scaleMode=a}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=(0,e.f3)(this.pixelWidth)&&(0,e.f3)(this.pixelHeight)}static test(a){throw Error("Unimplemented")}};i.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let j=i},94741:(a,b,c)=>{"use strict";c.d(b,{V:()=>j});var d=c(57680),e=c(87790),f=c(42115),g=c(16183),h=c(43362);function i(a,b){if(!(a instanceof g.h)){let c=b?h.S.INDEX:h.S.VERTEX;a instanceof Array&&(b?(a=new Uint32Array(a),c=h.S.INDEX|h.S.COPY_DST):(a=new Float32Array(a),c=h.S.VERTEX|h.S.COPY_DST)),a=new g.h({data:a,label:b?"index-mesh-buffer":"vertex-mesh-buffer",usage:c})}return a}class j extends d.A{constructor(a={}){super(),this.uid=(0,f.L)("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new e.c,this._boundsDirty=!0;const{attributes:b,indexBuffer:c,topology:d}=a;if(this.buffers=[],this.attributes={},b)for(const a in b)this.addAttribute(a,b[a]);this.instanceCount=a.instanceCount??1,c&&this.addIndex(c),this.topology=d||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(a){return this.attributes[a]}getIndex(){return this.indexBuffer}getBuffer(a){return this.getAttribute(a).buffer}getSize(){for(let a in this.attributes){let b=this.attributes[a];return b.buffer.data.length/(b.stride/4||b.size)}return 0}addAttribute(a,b){var c;let d=(((c=b)instanceof g.h||Array.isArray(c)||c.BYTES_PER_ELEMENT)&&(c={buffer:c}),c.buffer=i(c.buffer,!1),c);-1===this.buffers.indexOf(d.buffer)&&(this.buffers.push(d.buffer),d.buffer.on("update",this.onBufferUpdate,this),d.buffer.on("change",this.onBufferUpdate,this)),this.attributes[a]=d}addIndex(a){this.indexBuffer=i(a,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,function(a,b,c){let d=a.getAttribute(b);if(!d)return c.minX=0,c.minY=0,c.maxX=0,c.maxY=0,c;let e=d.buffer.data,f=1/0,g=1/0,h=-1/0,i=-1/0,j=e.BYTES_PER_ELEMENT,k=(d.offset||0)/j,l=(d.stride||8)/j;for(let a=k;a<e.length;a+=l){let b=e[a],c=e[a+1];b>h&&(h=b),c>i&&(i=c),b<f&&(f=b),c<g&&(g=c)}return c.minX=f,c.minY=g,c.maxX=h,c.maxY=i,c}(this,"aPosition",this._bounds)):this._bounds}destroy(a=!1){this.emit("destroy",this),this.removeAllListeners(),a&&this.buffers.forEach(a=>a.destroy()),this.indexBuffer?.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}},95420:(a,b,c)=>{"use strict";c.d(b,{I:()=>z,v:()=>y});var d=c(15104),e=c(5086),f=c(87818);function g(a,b,c){if(a)for(let d in a){let e=b[d.toLocaleLowerCase()];if(e){let b=a[d];"header"===d&&(b=b.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),c&&e.push(`//----${c}----//`),e.push(b)}else(0,f.R)(`${d} placement hook does not exist in shader`)}}let h=/\{\{(.*?)\}\}/g;function i(a){let b={};return(a.match(h)?.map(a=>a.replace(/[{()}]/g,""))??[]).forEach(a=>{b[a]=[]}),b}function j(a,b){let c,d=/@in\s+([^;]+);/g;for(;null!==(c=d.exec(a));)b.push(c[1])}function k(a,b,c=!1){let d=[];j(b,d),a.forEach(a=>{a.header&&j(a.header,d)}),c&&d.sort();let e=d.map((a,b)=>`       @location(${b}) ${a},`).join("\n"),f=b.replace(/@in\s+[^;]+;\s*/g,"");return f.replace("{{in}}",`
${e}
`)}function l(a,b){let c,d=/@out\s+([^;]+);/g;for(;null!==(c=d.exec(a));)b.push(c[1])}function m(a,b){let c=a;for(let a in b){let d=b[a];c=d.join("\n").length?c.replace(`{{${a}}}`,`//-----${a} START-----//
${d.join("\n")}
//----${a} FINISH----//`):c.replace(`{{${a}}}`,"")}return c}let n=Object.create(null),o=new Map,p=0;function q(a,b){return b.map(a=>(o.has(a)||o.set(a,p++),o.get(a))).sort((a,b)=>a-b).join("-")+a.vertex+a.fragment}function r(a,b,c){let d=i(a),e=i(b);return c.forEach(a=>{g(a.vertex,d,a.name),g(a.fragment,e,a.name)}),{vertex:m(a,d),fragment:m(b,e)}}let s=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,t=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,u=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,v=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,w={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},x={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function y({bits:a,name:b}){let c=function({template:a,bits:b}){let c=q(a,b);if(n[c])return n[c];let{vertex:d,fragment:e}=function(a,b){var c;let d,e,f,g,h,i=b.map(a=>a.vertex).filter(a=>!!a),j=b.map(a=>a.fragment).filter(a=>!!a),m=k(i,a.vertex,!0);return d=[],l(c=m,d),i.forEach(a=>{a.header&&l(a.header,d)}),e=0,f=d.sort().map(a=>a.indexOf("builtin")>-1?a:`@location(${e++}) ${a}`).join(",\n"),g=d.sort().map(a=>`       var ${a.replace(/@.*?\s+/g,"")};`).join("\n"),h=`return VSOutput(
            ${d.sort().map(a=>{let b;return` ${(b=/\b(\w+)\s*:/g.exec(a))?b[1]:""}`}).join(",\n")});`,{vertex:m=c.replace(/@out\s+[^;]+;\s*/g,"").replace("{{struct}}",`
${f}
`).replace("{{start}}",`
${g}
`).replace("{{return}}",`
${h}
`),fragment:k(j,a.fragment,!0)}}(a,b);return n[c]=r(d,e,b),n[c]}({template:{fragment:t,vertex:s},bits:[w,...a]});return e.B.from({name:b,vertex:{source:c.vertex,entryPoint:"main"},fragment:{source:c.fragment,entryPoint:"main"}})}function z({bits:a,name:b}){return new d.M({name:b,...function({template:a,bits:b}){let c=q(a,b);return n[c]||(n[c]=r(a.vertex,a.fragment,b)),n[c]}({template:{vertex:u,fragment:v},bits:[x,...a]})})}},96156:(a,b,c)=>{"use strict";c.d(b,{m:()=>e});let d={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function e(a){return d[a]??d.float32}},96487:()=>{},96609:(a,b,c)=>{"use strict";c.d(b,{Y:()=>f});var d=c(93141),e=c(61487);class f extends e.g{static create(a){return new f({source:new d.v(a)})}resize(a,b,c){return this.source.resize(a,b,c),this}}},98698:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>l,generateMetadata:()=>k,runtime:()=>j});var d=c(5735),e=c(92233),f=c(84623),g=c(33386),h=c(54894),i=c(71064);let j="nodejs";async function k(a){let{projectId:b}=await a.params,c=(0,e.U1)(b);return{title:c?.name?c.name:"Project"}}async function l(a){let{projectId:b}=await a.params;(0,h.gy)(b);let c=(0,e.U1)(b);if(!c)return(0,d.jsx)("div",{className:"min-h-screen bg-zinc-950 text-zinc-50 p-8",children:(0,d.jsx)("div",{className:"text-sm text-zinc-300",children:"Project not found."})});let j=(0,f.qs)({projectId:b,limit:200,offset:0}),k=(0,g.rR)(b),l=(0,g.Zg)(b);return(0,d.jsx)(i.ProjectWorkspace,{project:c,initialAssets:j,initialObjects:k,initialView:l})}}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[741,888],()=>b(b.s=46994));module.exports=c})();